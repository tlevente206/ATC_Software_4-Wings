========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/test/java/com/FourWings/atcSystem/AtcSystemApplicationTests.java
================================
package com.FourWings.atcSystem;

import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest
class AtcSystemApplicationTests {

    @Test
    void contextLoads() {
    }

}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/css/atc-theme.css
================================
/************************************************************
 * ATC – Globális, modern, világos téma
 ************************************************************/

/* Alap root beállítások */
.root {
    -fx-font-family: "Segoe UI", "Inter", "Roboto", "Helvetica Neue", Arial, sans-serif;
    -fx-font-size: 13px;
    -fx-background-color: #ffeecc; /* illeszkedik az AnchorPane-ekhez */
}

/* Általános label */
.label {
    -fx-text-fill: #1a1a1a;
    -fx-font-smoothing-type: lcd;
}

/************************************************************
 * GOMBOK – modern, lekerekített
 ************************************************************/

.button {
    -fx-background-color: linear-gradient(to bottom, #6b5cff, #5a4fe0);
    -fx-text-fill: white;
    -fx-font-weight: 600;
    -fx-background-radius: 8;
    -fx-padding: 7 14;
    -fx-border-color: transparent;
    -fx-cursor: hand;
}

.button:hover {
    -fx-background-color: linear-gradient(to bottom, #5a4fe0, #4a40d5);
}

.button:pressed {
    -fx-opacity: 0.92;
}

.button:focused {
    -fx-border-color: #6b5cff;
    -fx-border-width: 2;
    -fx-border-radius: 8;
}

/* Elsődleges akció (pl. controller oldal „Időjárás asszisztens” gomb) */
.primary-action {
    -fx-background-color: linear-gradient(to bottom, #6b5cff, #5a4fe0);
    -fx-text-fill: white;
    -fx-font-weight: 600;
    -fx-background-radius: 10;
}

/* Másodlagos akció – fehér kártyaszerű gomb */
.secondary-action {
    -fx-background-color: #ffffff;
    -fx-text-fill: #333333;
    -fx-font-weight: 500;
    -fx-background-radius: 10;
    -fx-border-color: rgba(0,0,0,0.12);
    -fx-border-radius: 10;
}

.secondary-action:hover {
    -fx-background-color: #f5f3ee;
}

/* Veszély / kilépés jellegű (piros) gomb */
.danger-action {
    -fx-background-color: linear-gradient(to bottom, #ff7a59, #e4613f);
    -fx-text-fill: white;
    -fx-font-weight: 600;
    -fx-background-radius: 10;
}

.danger-action:hover {
    -fx-background-color: linear-gradient(to bottom, #e4613f, #c84b30);
}

/************************************************************
 * TextField, PasswordField, ComboBox – űrlap elemek
 ************************************************************/

.text-field,
.password-field,
.combo-box {
    -fx-background-color: #ffffff;
    -fx-background-radius: 6;
    -fx-border-color: rgba(0,0,0,0.18);
    -fx-border-radius: 6;
    -fx-padding: 5 8;
}

.text-field:focused,
.password-field:focused,
.combo-box:focused {
    -fx-border-color: #6b5cff;
    -fx-border-width: 2;
}

/* ComboBox felugró lista */
.combo-box .list-view {
    -fx-background-color: #ffffff;
    -fx-background-radius: 6;
    -fx-border-color: rgba(0,0,0,0.18);
    -fx-border-radius: 6;
}

.combo-box .list-cell {
    -fx-padding: 6 8;
}

.combo-box .list-cell:hover {
    -fx-background-color: #f0ede7;
}

/************************************************************
 * TableView – általános táblázat stílus
 ************************************************************/

.table-view {
    -fx-background-color: transparent;
    -fx-border-color: rgba(0,0,0,0.15);
    -fx-border-radius: 10;
    -fx-background-radius: 10;
}

.table-view:focused {
    -fx-border-color: #6b5cff;
}

/* Fejléc háttér */
.table-view .column-header-background {
    -fx-background-color: linear-gradient(to bottom, #ffffff, #f4f0ea);
    -fx-background-radius: 10 10 0 0;
    -fx-border-color: rgba(0,0,0,0.15);
    -fx-border-width: 0 0 1 0;
}

/* Fejléc cellák */
.table-view .column-header,
.table-view .filler {
    -fx-size: 36px;
    -fx-background-color: transparent;
}

.table-view .column-header .label {
    -fx-text-fill: #333333;
    -fx-font-weight: 600;
    -fx-padding: 0 8 0 8;
}

/* Sorok */
.table-row-cell {
    -fx-cell-size: 30px;
    -fx-background-color: #ffffff;
}

.table-row-cell:odd {
    -fx-background-color: #fffaf2;
}

.table-row-cell:hover {
    -fx-background-color: #eee4d4;
}

.table-row-cell:selected {
    -fx-background-color: #d7d1ff;
}

/* Cellák */
.table-cell {
    -fx-padding: 4 8;
    -fx-text-fill: #222222;
}

/************************************************************
 * ScrollBar – diszkrét megjelenés
 ************************************************************/

.scroll-bar:horizontal,
.scroll-bar:vertical {
    -fx-background-color: transparent;
}

.scroll-bar .thumb {
    -fx-background-color: rgba(0,0,0,0.25);
    -fx-background-radius: 8;
}

.scroll-bar .thumb:hover {
    -fx-background-color: rgba(0,0,0,0.35);
}

.scroll-bar .track {
    -fx-background-color: rgba(0,0,0,0.06);
    -fx-background-radius: 8;
}

/************************************************************
 * ToolBar, Status bar, Admin oldalak
 ************************************************************/

.tool-bar {
    -fx-background-color: linear-gradient(to bottom, #ffffff, #f7f3ec);
    -fx-padding: 6 10 6 10;
    -fx-border-color: rgba(0,0,0,0.15);
    -fx-border-width: 0 0 1 0;
}

.tool-bar .label {
    -fx-text-fill: #333333;
}

.status-bar,
.controller-statusbar {
    -fx-background-color: rgba(0,0,0,0.03);
}

/* Admin „felhasználókezelés” cím */
.label {
    /* a fő címeket úgyis FXML-ben nagy mérettel állítod */
}

/************************************************************
 * CONTROLLER HOME PAGE – speciális styleclass-ek
 ************************************************************/

/* Felső hero rész – finom gradientes sáv */
.controller-hero {
    -fx-background-color: linear-gradient(to right,
    rgba(255,255,255,0.9),
    rgba(255,255,255,0.6)
    );
}

.controller-greeting {
    -fx-text-fill: #1a1a1a;
    -fx-font-weight: 700;
}

.controller-airport-title {
    -fx-text-fill: #444444;
    -fx-font-weight: 600;
}

.controller-subtitle {
    -fx-text-fill: #777777;
}

/* Üvegkártya jelleg az időjárás panelhez */
.glass-card {
    -fx-background-color: rgba(255,255,255,0.8);
    -fx-background-radius: 18;
    -fx-border-radius: 18;
    -fx-border-color: rgba(255,255,255,0.9);
    -fx-border-width: 1;
    -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 20, 0.25, 0, 6);
}

/* Időjárás speciális text-ek */
.weather-emoji {
    -fx-font-size: 52px;
}

.weather-temp-big {
    -fx-font-size: 36px;
    -fx-font-weight: 700;
    -fx-text-fill: #1a1a1a;
}

.weather-condition {
    -fx-text-fill: #555555;
    -fx-font-size: 14px;
}

.weather-label-strong {
    -fx-text-fill: #444444;
    -fx-font-weight: 600;
}

.weather-label {
    -fx-text-fill: #555555;
}

.weather-metar {
    -fx-text-fill: #333333;
    -fx-font-family: "Consolas", "JetBrains Mono", monospace;
    -fx-font-size: 11px;
}

/* Akció cím a jobb oldalon */
.actions-title {
    -fx-text-fill: #333333;
    -fx-font-weight: 600;
    -fx-font-size: 14px;
}

/* Alsó státuszsor a controller oldalon */
.controller-statusbar {
    -fx-background-color: rgba(0,0,0,0.03);
}

/************************************************************
 * DIALOG STÍLUS – induló / érkező járatok
 ************************************************************/

.dialog-subtitle {
    -fx-text-fill: #666666;
    -fx-font-size: 12px;
}

/************************************************************
 * Checkbox, RadioButton – apró finomítás
 ************************************************************/

.check-box,
.radio-button {
    -fx-text-fill: #222222;
}

.check-box .box,
.radio-button .radio {
    -fx-background-color: #ffffff;
    -fx-border-color: rgba(0,0,0,0.3);
}

.check-box:selected .box,
.radio-button:selected .radio {
    -fx-background-color: #6b5cff;
    -fx-border-color: #6b5cff;
}

/************************************************************
 * HBox / VBox alap spacingekhez nincs feltétlen stílus,
 * de ha kell, itt lehetne még tovább finomítani.
 ************************************************************/
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/css/airports.css
================================
/* ==============================
   Alap téma – világos, modern
   ============================== */

/* Alap változók (JavaFX-ben változókat közvetetten használunk, ezért itt “gyűjtők”) */
.root {
    /* Színek */
    -color-bg:              #ffeecc;   /* egységesítsük az AnchorPane háttérszínével */
    -color-surface:         #ffffff;
    -color-surface-2:       #faf7f2;
    -color-primary:         #6b5cff;   /* modern, de visszafogott lila-kék */
    -color-primary-pressed: #5a4fe0;
    -color-accent:          #ff7a59;   /* akcentus narancs */
    -color-text:            #1a1a1a;
    -color-text-muted:      #666;
    -color-border:          rgba(0,0,0,0.08);
    -color-border-strong:   rgba(0,0,0,0.16);
    -color-hover:           rgba(0,0,0,0.04);
    -color-focus:           #6b5cff33;

    /* Tipográfia */
    -fx-font-family: "Segoe UI", "Inter", "Roboto", "Helvetica Neue", Arial, sans-serif;
    -fx-font-size: 13px;

    /* Közös sarkok/árnyékok */
    -radius-sm: 6px;
    -radius-md: 10px;
    -shadow-1: dropshadow(gaussian, rgba(0,0,0,0.08), 10, 0.2, 0, 2);
    -shadow-2: dropshadow(gaussian, rgba(0,0,0,0.12), 18, 0.25, 0, 6);

    -fx-background-color: -color-bg; /* egységes háttér */
}

/* Címke – a nagy cím kicsit “hero” jelleggel */
.label {
    -fx-text-fill: -color-text;
}

.label > .text {
    -fx-font-smoothing-type: lcd;
}

/* A felső cím (layoutX=20, layoutY=20) legyen karakteresebb; mivel FXML-t nem módosítunk,
   globálisan kezeljük a nagyobb fontméretű labelt, de finoman. */
.label {
    /* semleges default, a konkrét cím amúgy is 24px-esre van állítva FXML-ben */
}

/* Gombok – modern, lekerekített, hover/focus állapotok */
.button {
    -fx-background-color: linear-gradient(to bottom, -color-primary, -color-primary-pressed);
    -fx-text-fill: white;
    -fx-font-weight: 600;
    -fx-background-radius: -radius-sm;
    -fx-padding: 8 14;
    -fx-effect: -shadow-1;
    -fx-cursor: hand;
    -fx-border-color: transparent;
}

.button:hover {
    -fx-background-color: linear-gradient(to bottom, -color-primary-pressed, -color-primary);
    -fx-translate-y: -0.5px;
}

.button:pressed {
    -fx-translate-y: 0;
    -fx-opacity: 0.95;
}

.button:focused {
    -fx-effect: -shadow-2;
    -fx-background-insets: 0;
    -fx-border-color: -color-focus;
    -fx-border-width: 2;
    -fx-border-radius: calc(-radius-sm + 2);
}

/* Másodlagos gomb (ha később felveszel styleclass-t: .button.secondary) */
.button.secondary {
    -fx-background-color: -color-surface;
    -fx-text-fill: -color-text;
    -fx-border-color: -color-border;
    -fx-background-radius: -radius-sm;
}
.button.secondary:hover {
    -fx-background-color: -color-surface-2;
}

/* ComboBox – kártyaszerű, árnyékkal, finom szegéllyel */
.combo-box {
    -fx-background-color: -color-surface;
    -fx-background-radius: -radius-sm;
    -fx-padding: 4 10;
    -fx-border-color: -color-border;
    -fx-border-radius: -radius-sm;
    -fx-effect: -shadow-1;
}

.combo-box:hover {
    -fx-background-color: -color-surface-2;
}

.combo-box:focused {
    -fx-border-color: -color-primary;
    -fx-effect: -shadow-2;
}

/* ComboBox felugró menü */
.combo-box .list-view {
    -fx-background-color: -color-surface;
    -fx-background-radius: -radius-sm;
    -fx-padding: 4;
    -fx-effect: -shadow-2;
    -fx-border-color: -color-border;
    -fx-border-radius: -radius-sm;
}
.combo-box .list-cell {
    -fx-padding: 8 10;
}
.combo-box .list-cell:hover {
    -fx-background-color: -color-hover;
}
.combo-box .list-cell:selected {
    -fx-background-color: derive(-color-primary, 80%);
    -fx-text-fill: -color-text;
}

/* TableView – modern fejléccel, váltakozó sorokkal, finom rácsokkal */
.table-view {
    -fx-background-color: transparent;           /* a konténerrel simuljon */
    -fx-background-radius: -radius-md;
    -fx-border-color: -color-border;
    -fx-border-radius: -radius-md;
    -fx-effect: -shadow-1;
}

.table-view:focused {
    -fx-effect: -shadow-2;
    -fx-border-color: -color-primary;
}

/* Táblázat fejléce */
.table-view .column-header-background {
    -fx-background-color: linear-gradient(to bottom, #ffffff, #f3f0ea);
    -fx-background-radius: -radius-md -radius-md 0 0;
    -fx-border-color: -color-border-strong;
    -fx-border-width: 0 0 1 0;
}

.table-view .column-header,
.table-view .filler {
    -fx-size: 38px;
    -fx-background-color: transparent;
}

.table-view .column-header .label {
    -fx-text-fill: -color-text;
    -fx-font-weight: 600;
    -fx-padding: 0 8;
}

/* Sorok */
.table-row-cell {
    -fx-background-color: white;
    -fx-cell-size: 36px;
    -fx-border-color: -color-border;
    -fx-border-width: 0 0 1 0;
}
.table-row-cell:odd {
    -fx-background-color: #fffdf9;
}
.table-row-cell:hover {
    -fx-background-color: -color-hover;
}
.table-row-cell:selected {
    -fx-background-color: derive(-color-primary, 75%);
}

/* Cellák */
.table-cell {
    -fx-text-fill: -color-text;
    -fx-padding: 6 10;
}

/* Görgetősáv – diszkrét, modern */
.scroll-bar:horizontal,
.scroll-bar:vertical {
    -fx-background-color: transparent;
}

.scroll-bar .thumb {
    -fx-background-color: rgba(0,0,0,0.25);
    -fx-background-radius: 8px;
}
.scroll-bar .thumb:hover {
    -fx-background-color: rgba(0,0,0,0.35);
}
.scroll-bar .track {
    -fx-background-color: rgba(0,0,0,0.05);
    -fx-background-radius: 8px;
}

/* “Kártya” jelleg az AnchorPane gyermekekre
   – mivel az AnchorPane maga kapott háttérszínt FXML-ből (#ffeecc),
     a fő komponenseket emeljük ki finom kártyává, ha szeretnéd
     (itt célzottan a ComboBox és TableView már kap árnyékot). */

/* Felirat (cím) hangsúly finom árnyékkal – csak ha szeretnéd */
.label[style*="-fx-font-size: 24px"] {
    -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.12), 12, 0.2, 0, 2);
}

/* Logout gombot akcentussal is ki lehet emelni, ha adsz neki styleclass-t: .button.danger */
.button.danger {
    -fx-background-color: linear-gradient(to bottom, -color-accent, derive(-color-accent, -10%));
}

/* Fókuszgyűrű egységesítés (billentyűzet-navigációhoz is) */
:focused {
    -fx-focus-color: -color-primary;
    -fx-faint-focus-color: -color-focus;
}

/* ==============================
   Opcionális: Dark mode
   ============================== */
/* Kapcsold be úgy, hogy a root nodenak adsz egy "dark" style class-t:
   root.getStyleClass().add("dark");
*/
.root.dark {
    -color-bg:            #141414;
    -color-surface:       #1b1b1b;
    -color-surface-2:     #202020;
    -color-primary:       #8a7dff;
    -color-primary-pressed:#786cef;
    -color-accent:        #ff906e;
    -color-text:          #f2f2f2;
    -color-text-muted:    #b7b7b7;
    -color-border:        rgba(255,255,255,0.08);
    -color-border-strong: rgba(255,255,255,0.16);
    -color-hover:         rgba(255,255,255,0.06);
    -color-focus:         #8a7dff33;
}

.root.dark .table-view .column-header-background {
    -fx-background-color: linear-gradient(to bottom, #202020, #181818);
}
.root.dark .table-row-cell {
    -fx-background-color: #1b1b1b;
}
.root.dark .table-row-cell:odd {
    -fx-background-color: #181818;
}
.root.dark .scroll-bar .thumb {
    -fx-background-color: rgba(255,255,255,0.35);
}
.root.dark .scroll-bar .track {
    -fx-background-color: rgba(255,255,255,0.08);
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/FlightWeatherAssistantDialog.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<AnchorPane xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.FlightWeatherAssistantDialogController"
            prefWidth="600" prefHeight="420">

    <children>

        <Label text="Időjárás asszisztens"
               layoutX="20" layoutY="20">
            <font>
                <Font size="22"/>
            </font>
        </Label>

        <Label text="Repülőtér:" layoutX="20" layoutY="70"/>

        <ComboBox fx:id="airportCombo"
                  layoutX="90" layoutY="65"
                  prefWidth="260"/>

        <Button text="Elemzés"
                layoutX="370" layoutY="65"
                onAction="#onAnalyzeWeather"/>

        <Label fx:id="statusLabel"
               layoutX="20" layoutY="110"
               text="Státusz: -"/>

        <TextArea fx:id="resultArea"
                  layoutX="20" layoutY="140"
                  prefWidth="560" prefHeight="220"
                  wrapText="true"/>

        <Label fx:id="errorLabel"
               layoutX="20" layoutY="370"
               textFill="red"/>

        <Button text="Bezárás"
                layoutX="500" layoutY="365"
                onAction="#onClose"/>
    </children>
</AnchorPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/AvatarPickerDialog.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.image.ImageView?>

<AnchorPane xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.AvatarPickerDialogController"
            prefWidth="800" prefHeight="520"
            style="-fx-background-color: linear-gradient(to bottom, #e6f0ff, #ffffff);">

    <VBox spacing="15" fillWidth="true"
          layoutX="20" layoutY="20"
          prefWidth="760" prefHeight="480">
        <children>

            <!-- Cím -->
            <Label text="Válassz profilképet">
                <font>
                    <Font size="24"/>
                </font>
            </Label>

            <!-- Kártya a rácshoz -->
            <VBox spacing="10"
                  style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 12, 0, 0, 3);">
                <children>

                    <!-- Rács az avatárokkal -->
                    <GridPane hgap="18" vgap="18">
                        <columnConstraints>
                            <ColumnConstraints prefWidth="150"/>
                            <ColumnConstraints prefWidth="150"/>
                            <ColumnConstraints prefWidth="150"/>
                            <ColumnConstraints prefWidth="150"/>
                        </columnConstraints>
                        <rowConstraints>
                            <RowConstraints prefHeight="140"/>
                            <RowConstraints prefHeight="140"/>
                            <RowConstraints prefHeight="140"/>
                        </rowConstraints>

                        <children>
                            <!-- 10 avatár: mind StackPane-ben, benne az ImageView -->
                            <StackPane fx:id="avatar1Pane"
                                       GridPane.rowIndex="0" GridPane.columnIndex="0"
                                       onMouseClicked="#onAvatar1Click"
                                       style="-fx-background-radius: 10; -fx-padding: 4;">
                                <children>
                                    <ImageView fx:id="avatar1View"
                                               fitWidth="110" fitHeight="110"
                                               preserveRatio="true"
                                               style="-fx-cursor: hand;"/>
                                </children>
                            </StackPane>

                            <StackPane fx:id="avatar2Pane"
                                       GridPane.rowIndex="0" GridPane.columnIndex="1"
                                       onMouseClicked="#onAvatar2Click"
                                       style="-fx-background-radius: 10; -fx-padding: 4;">
                                <children>
                                    <ImageView fx:id="avatar2View"
                                               fitWidth="110" fitHeight="110"
                                               preserveRatio="true"
                                               style="-fx-cursor: hand;"/>
                                </children>
                            </StackPane>

                            <StackPane fx:id="avatar3Pane"
                                       GridPane.rowIndex="0" GridPane.columnIndex="2"
                                       onMouseClicked="#onAvatar3Click"
                                       style="-fx-background-radius: 10; -fx-padding: 4;">
                                <children>
                                    <ImageView fx:id="avatar3View"
                                               fitWidth="110" fitHeight="110"
                                               preserveRatio="true"
                                               style="-fx-cursor: hand;"/>
                                </children>
                            </StackPane>

                            <StackPane fx:id="avatar4Pane"
                                       GridPane.rowIndex="0" GridPane.columnIndex="3"
                                       onMouseClicked="#onAvatar4Click"
                                       style="-fx-background-radius: 10; -fx-padding: 4;">
                                <children>
                                    <ImageView fx:id="avatar4View"
                                               fitWidth="110" fitHeight="110"
                                               preserveRatio="true"
                                               style="-fx-cursor: hand;"/>
                                </children>
                            </StackPane>

                            <StackPane fx:id="avatar5Pane"
                                       GridPane.rowIndex="1" GridPane.columnIndex="0"
                                       onMouseClicked="#onAvatar5Click"
                                       style="-fx-background-radius: 10; -fx-padding: 4;">
                                <children>
                                    <ImageView fx:id="avatar5View"
                                               fitWidth="110" fitHeight="110"
                                               preserveRatio="true"
                                               style="-fx-cursor: hand;"/>
                                </children>
                            </StackPane>

                            <StackPane fx:id="avatar6Pane"
                                       GridPane.rowIndex="1" GridPane.columnIndex="1"
                                       onMouseClicked="#onAvatar6Click"
                                       style="-fx-background-radius: 10; -fx-padding: 4;">
                                <children>
                                    <ImageView fx:id="avatar6View"
                                               fitWidth="110" fitHeight="110"
                                               preserveRatio="true"
                                               style="-fx-cursor: hand;"/>
                                </children>
                            </StackPane>

                            <StackPane fx:id="avatar7Pane"
                                       GridPane.rowIndex="1" GridPane.columnIndex="2"
                                       onMouseClicked="#onAvatar7Click"
                                       style="-fx-background-radius: 10; -fx-padding: 4;">
                                <children>
                                    <ImageView fx:id="avatar7View"
                                               fitWidth="110" fitHeight="110"
                                               preserveRatio="true"
                                               style="-fx-cursor: hand;"/>
                                </children>
                            </StackPane>

                            <StackPane fx:id="avatar8Pane"
                                       GridPane.rowIndex="1" GridPane.columnIndex="3"
                                       onMouseClicked="#onAvatar8Click"
                                       style="-fx-background-radius: 10; -fx-padding: 4;">
                                <children>
                                    <ImageView fx:id="avatar8View"
                                               fitWidth="110" fitHeight="110"
                                               preserveRatio="true"
                                               style="-fx-cursor: hand;"/>
                                </children>
                            </StackPane>

                            <StackPane fx:id="avatar9Pane"
                                       GridPane.rowIndex="2" GridPane.columnIndex="0"
                                       onMouseClicked="#onAvatar9Click"
                                       style="-fx-background-radius: 10; -fx-padding: 4;">
                                <children>
                                    <ImageView fx:id="avatar9View"
                                               fitWidth="110" fitHeight="110"
                                               preserveRatio="true"
                                               style="-fx-cursor: hand;"/>
                                </children>
                            </StackPane>

                            <StackPane fx:id="avatar10Pane"
                                       GridPane.rowIndex="2" GridPane.columnIndex="1"
                                       onMouseClicked="#onAvatar10Click"
                                       style="-fx-background-radius: 10; -fx-padding: 4;">
                                <children>
                                    <ImageView fx:id="avatar10View"
                                               fitWidth="110" fitHeight="110"
                                               preserveRatio="true"
                                               style="-fx-cursor: hand;"/>
                                </children>
                            </StackPane>

                            <!-- 11. "saját kép" csempe – mindig ugyanott, avatar7 alatt -->

                        </children>
                    </GridPane>
                </children>
            </VBox>

            <!-- Alsó sáv: bal oldalt név + hiba, jobb oldalt gombok -->
            <HBox spacing="20">
                <children>
                    <VBox spacing="4">
                        <children>
                            <Label fx:id="selectedNameLabel"
                                   text="Nincs kiválasztva kép"/>
                            <Label fx:id="errorLabel"
                                   textFill="red"/>
                        </children>
                    </VBox>

                    <Pane HBox.hgrow="ALWAYS"/> <!-- kitöltő -->

                    <HBox spacing="10">
                        <children>
                            <Button text="Mégse" onAction="#onCancel"/>
                            <Button text="OK" onAction="#onOk"
                                    style="-fx-background-color: #0078ff; -fx-text-fill: white; -fx-background-radius: 6;"/>
                        </children>
                    </HBox>
                </children>
            </HBox>
        </children>
    </VBox>
</AnchorPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/HomePage/TerminalPage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import java.util.*?>
<?import javafx.scene.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<?import javafx.collections.FXCollections?>
<AnchorPane xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.HomePage.TerminalPageController"
            prefHeight="400.0" prefWidth="600.0" style="-fx-background-color: #ccffee;">
    <children>
        <Label text="Terminál oldal" layoutX="20.0" layoutY="20.0" style="-fx-font-size: 24px;"/>

        <Button fx:id="logoutButton"
                text="Kijelentkezés"
                onAction="#onLogout"
                layoutX="500"
                layoutY="10"/>

        <ComboBox fx:id="menuComboBox" layoutX="26.0" layoutY="80.0" prefWidth="148.0">
            <items>
                <FXCollections fx:factory="observableArrayList">
                    <String fx:value="Főoldal"/>
                    <String fx:value="Kapuk(Ez inkább a repterekhez menne)"/>
                    <String fx:value="Repülők"/>
                    <String fx:value="Repterek"/>
                    <String fx:value="Repülőutak"/>
                    <String fx:value="Terminál(Ez is inkább reptér)"/>
                </FXCollections>
            </items>
        </ComboBox>
    </children>
</AnchorPane>

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/HomePage/GatesPage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.FlowPane?>
<?import javafx.scene.layout.HBox?>

<AnchorPane prefHeight="600.0" prefWidth="1200.0" style="-fx-background-color: #ffeecc;" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.FourWings.atcSystem.frontend.HomePage.GatesPageController">

    <children>
        <Label layoutX="20.0" layoutY="20.0" style="-fx-font-size: 24px; -fx-font-weight: bold;" text="Kapuk Kezelése (Gate Management)" />

        <Button layoutX="1080.0" layoutY="14.0" onAction="#onLogout" text="Kijelentkezés" />

        <ComboBox fx:id="menuComboBox" layoutX="25.0" layoutY="70.0" prefWidth="220.0">
            <items>
                <FXCollections fx:factory="observableArrayList">
                    <String fx:value="Főoldal" />
                    <String fx:value="Kapuk(Ez inkább a repterekhez menne)" />
                    <String fx:value="Repülők" />
                    <String fx:value="Repterek" />
                    <String fx:value="Repülőutak" />
                    <String fx:value="Terminál(Ez is inkább reptér)" />
                </FXCollections>
            </items>
        </ComboBox>

        <Label layoutX="300.0" layoutY="74.0" style="-fx-font-weight: bold;" text="Reptér kiválasztása:" />
        <ComboBox fx:id="airportSelector" layoutX="420.0" layoutY="70.0" prefWidth="300.0" promptText="-- Válassz egy repteret --" />

        <Button layoutX="730.0" layoutY="70.0" onAction="#onRefresh" text="Frissítés" />

        <HBox layoutX="900.0" layoutY="70.0" spacing="15.0">
            <Label style="-fx-background-color: #a5d6a7; -fx-padding: 5px; -fx-background-radius: 5px;" text="SZABAD" />
            <Label style="-fx-background-color: #ef9a9a; -fx-padding: 5px; -fx-background-radius: 5px;" text="FOGLALT" />
        </HBox>

        <ScrollPane fitToWidth="true" layoutX="25.0" layoutY="120.0" prefHeight="450.0" prefWidth="1150.0" style="-fx-background-color: transparent;">
            <content>
                <FlowPane fx:id="gatesContainer" hgap="20.0" prefWrapLength="1100.0" vgap="20.0" style="-fx-padding: 10px;" />
            </content>
        </ScrollPane>

        <Label fx:id="statusLabel" layoutX="25.0" layoutY="575.0" text="Válassz repteret..." />

    </children>
</AnchorPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/HomePage/RoutesPage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.AnchorPane?>

<AnchorPane prefHeight="600.0" prefWidth="1200.0" style="-fx-background-color: #ffeecc;" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.FourWings.atcSystem.frontend.HomePage.RoutesPageController">

    <children>

        <Label layoutX="20.0" layoutY="20.0" style="-fx-font-size: 24px; -fx-font-weight: bold;" text="Repülőutak (Routes)" />

        <Button layoutX="1080.0" layoutY="14.0" onAction="#onLogout" text="Kijelentkezés" />

        <ComboBox fx:id="menuComboBox" layoutX="25.0" layoutY="70.0" prefWidth="220.0">
            <items>
                <FXCollections fx:factory="observableArrayList">
                    <String fx:value="Főoldal" />
                    <String fx:value="Kapuk(Ez inkább a repterekhez menne)" />
                    <String fx:value="Repülők" />
                    <String fx:value="Repterek" />
                    <String fx:value="Repülőutak" />
                    <String fx:value="Terminál(Ez is inkább reptér)" />
                </FXCollections>
            </items>
        </ComboBox>

        <Label layoutX="300.0" layoutY="74.0" style="-fx-font-weight: bold;" text="Reptér kiválasztása:" />
        <ComboBox fx:id="airportSelector" layoutX="420.0" layoutY="70.0" prefWidth="300.0" promptText="-- Válassz egy repteret --" />

        <Button layoutX="730.0" layoutY="70.0" onAction="#onRefresh" text="Frissítés" />

        <Label fx:id="statusLabel" layoutX="25.0" layoutY="570.0" text="Válassz repteret az útvonalak megtekintéséhez..." />

        <SplitPane dividerPositions="0.5" layoutX="25.0" layoutY="120.0" prefHeight="440.0" prefWidth="1150.0">
            <items>
                <AnchorPane minHeight="0.0" minWidth="0.0">
                    <children>
                        <Label style="-fx-font-weight: bold; -fx-text-fill: #b30000;" text="INDULÓ JÁRATOK (Departures)" AnchorPane.leftAnchor="10.0" AnchorPane.topAnchor="5.0" />

                        <TableView fx:id="departuresTable" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="30.0">
                            <columns>
                                <TableColumn fx:id="depFlightNumCol" prefWidth="70" text="Járat" />
                                <TableColumn fx:id="depAirlineCol" prefWidth="100" text="Légitársaság" />
                                <TableColumn fx:id="depDestinationCol" prefWidth="80" text="Célállomás" />
                                <TableColumn fx:id="depTimeCol" prefWidth="120" text="Indulás" />
                                <TableColumn fx:id="depGateCol" prefWidth="60" text="Kapu" />
                                <TableColumn fx:id="depStatusCol" prefWidth="100" text="Státusz" />
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>
                        </TableView>
                    </children>
                </AnchorPane>

                <AnchorPane minHeight="0.0" minWidth="0.0">
                    <children>
                        <Label style="-fx-font-weight: bold; -fx-text-fill: #006600;" text="ÉRKEZŐ JÁRATOK (Arrivals)" AnchorPane.leftAnchor="10.0" AnchorPane.topAnchor="5.0" />

                        <TableView fx:id="arrivalsTable" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="30.0">
                            <columns>
                                <TableColumn fx:id="arrFlightNumCol" prefWidth="70" text="Járat" />
                                <TableColumn fx:id="arrAirlineCol" prefWidth="100" text="Légitársaság" />
                                <TableColumn fx:id="arrOriginCol" prefWidth="80" text="Indulási Hely" />
                                <TableColumn fx:id="arrTimeCol" prefWidth="120" text="Érkezés" />
                                <TableColumn fx:id="arrGateCol" prefWidth="60" text="Kapu" />
                                <TableColumn fx:id="arrStatusCol" prefWidth="100" text="Státusz" />
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>
                        </TableView>
                    </children>
                </AnchorPane>
            </items>
        </SplitPane>

    </children>
</AnchorPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/HomePage/AirportsPage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.AnchorPane?>

<AnchorPane prefHeight="600.0" prefWidth="1200.0"
            style="-fx-background-color: #ffeecc;"
            xmlns="http://javafx.com/javafx/25"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.HomePage.AirportsPageController">

    <children>

        <!-- Cím -->
        <Label layoutX="20.0" layoutY="20.0"
               style="-fx-font-size: 24px;"
               text="Repterek oldal"/>

        <!-- Kijelentkezés gomb -->
        <Button fx:id="logoutButton"
                layoutX="1080.0" layoutY="14.0"
                onAction="#onLogout"
                text="Kijelentkezés"/>

        <!-- Menü ComboBox -->
        <ComboBox fx:id="menuComboBox"
                  layoutX="25.0" layoutY="80.0"
                  prefWidth="220.0">
            <items>
                <FXCollections fx:factory="observableArrayList">
                    <String fx:value="Főoldal"/>
                    <String fx:value="Kapuk(Ez inkább a repterekhez menne)"/>
                    <String fx:value="Repülők"/>
                    <String fx:value="Repterek"/>
                    <String fx:value="Repülőutak"/>
                    <String fx:value="Terminál(Ez is inkább reptér)"/>
                </FXCollections>
            </items>
        </ComboBox>

        <!-- Keresőmező -->
        <Label layoutX="270.0" layoutY="84.0" text="Keresés:"/>
        <TextField fx:id="searchField"
                   layoutX="330.0" layoutY="80.0"
                   prefWidth="260.0"
                   promptText="Név / város / ICAO"/>

        <!-- Frissítés gomb -->
        <Button layoutX="610.0" layoutY="80.0"
                text="Frissítés"
                onAction="#onRefresh"/>

        <!-- Státusz szöveg -->
        <Label fx:id="statusLabel"
               layoutX="25.0" layoutY="560.0"
               text="Repülőterek betöltése..."/>

        <!-- Repterek táblázat -->
        <TableView fx:id="airportsTable"
                   layoutX="25.0" layoutY="130.0"
                   prefHeight="410.0" prefWidth="1150.0">

            <columns>

                <!-- kódok / alapadatok -->
                <TableColumn fx:id="icaoCodeColumn"
                             prefWidth="80.0"
                             text="ICAO"/>
                <TableColumn fx:id="iataCodeColumn"
                             prefWidth="70.0"
                             text="IATA"/>
                <TableColumn fx:id="nameColumn"
                             prefWidth="220.0"
                             text="Név"/>
                <TableColumn fx:id="cityColumn"
                             prefWidth="150.0"
                             text="Város"/>
                <TableColumn fx:id="countryColumn"
                             prefWidth="140.0"
                             text="Ország"/>

                <!-- időzóna + pozíció -->
                <TableColumn fx:id="timezoneColumn"
                             prefWidth="150.0"
                             text="Időzóna"/>
                <TableColumn fx:id="latitudeColumn"
                             prefWidth="90.0"
                             text="Szélesség"/>
                <TableColumn fx:id="longitudeColumn"
                             prefWidth="90.0"
                             text="Hosszúság"/>
                <TableColumn fx:id="elevationColumn"
                             prefWidth="90.0"
                             text="Magasság"/>

                <!-- elérhetőség -->
                <TableColumn fx:id="addressColumn"
                             prefWidth="220.0"
                             text="Cím"/>
                <TableColumn fx:id="postalCodeColumn"
                             prefWidth="90.0"
                             text="Irányítószám"/>
                <TableColumn fx:id="websiteUrlColumn"
                             prefWidth="180.0"
                             text="Weboldal"/>
                <TableColumn fx:id="phoneMainColumn"
                             prefWidth="130.0"
                             text="Telefon"/>
                <TableColumn fx:id="emailMainColumn"
                             prefWidth="180.0"
                             text="Email"/>

            </columns>
        </TableView>

    </children>
</AnchorPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/HomePage/PlanesPage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.AnchorPane?>

<AnchorPane prefHeight="600.0" prefWidth="1200.0"
            style="-fx-background-color: #ffeecc;"
            xmlns="http://javafx.com/javafx/25"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.HomePage.AircraftPageController">

    <children>
        <Label layoutX="20.0" layoutY="20.0" style="-fx-font-size: 24px;" text="Repülőgépek adatbázisa"/>

        <Button fx:id="logoutButton" layoutX="1080.0" layoutY="14.0" onAction="#onLogout" text="Kijelentkezés"/>

        <ComboBox fx:id="menuComboBox" layoutX="25.0" layoutY="80.0" prefWidth="220.0">
            <items>
                <FXCollections fx:factory="observableArrayList">
                    <String fx:value="Főoldal"/>
                    <String fx:value="Kapuk(Ez inkább a repterekhez menne)"/>
                    <String fx:value="Repülők"/>
                    <String fx:value="Repterek"/>
                    <String fx:value="Repülőutak"/>
                    <String fx:value="Terminál(Ez is inkább reptér)"/>
                </FXCollections>
            </items>
        </ComboBox>

        <Label layoutX="270.0" layoutY="84.0" text="Keresés:"/>
        <TextField fx:id="searchField" layoutX="330.0" layoutY="80.0" prefWidth="260.0" promptText="Lajstrom / Típus / MSN / Státusz"/>

        <Button layoutX="610.0" layoutY="80.0" text="Frissítés" onAction="#onRefresh"/>
        <Label fx:id="statusLabel" layoutX="25.0" layoutY="560.0" text="Adatok betöltése..."/>

        <TableView fx:id="aircraftTable" layoutX="25.0" layoutY="130.0" prefHeight="410.0" prefWidth="1150.0">
            <columns>
                <TableColumn fx:id="idColumn" prefWidth="50.0" text="ID" />

                <TableColumn fx:id="registrationColumn" prefWidth="100.0" text="Lajstrom" />

                <TableColumn fx:id="typeIcaoColumn" prefWidth="80.0" text="Típus" />

                <TableColumn fx:id="msnColumn" prefWidth="90.0" text="MSN" />

                <TableColumn fx:id="airlineIdColumn" prefWidth="100.0" text="Üzemeltető" />

                <TableColumn fx:id="statusColumn" prefWidth="100.0" text="Státusz" />

                <TableColumn fx:id="seatCapacityColumn" prefWidth="80.0" text="Max Utas" />

                <TableColumn fx:id="cargoCapacityColumn" prefWidth="90.0" text="Cargo (kg)" />

                <TableColumn fx:id="baseAirportIdColumn" prefWidth="80.0" text="Bázis ID" />

                <TableColumn fx:id="manufactureYearColumn" prefWidth="90.0" text="Gyártás" />
            </columns>
        </TableView>

    </children>
</AnchorPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/UserSelfEditDialog.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.UserSelfEditDialogController"
            prefWidth="500.0" prefHeight="350.0">

    <top>
        <Label text="Saját profil szerkesztése" BorderPane.alignment="CENTER">
            <font>
                <Font size="22.0"/>
            </font>
            <padding>
                <Insets top="10" bottom="10" left="10" right="10"/>
            </padding>
        </Label>
    </top>

    <center>
        <GridPane hgap="10" vgap="10" BorderPane.alignment="CENTER">
            <padding>
                <Insets top="15" left="20" right="20" bottom="15"/>
            </padding>

            <columnConstraints>
                <ColumnConstraints prefWidth="130"/>
                <ColumnConstraints hgrow="ALWAYS"/>
            </columnConstraints>

            <children>
                <Label text="Név:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                <TextField fx:id="nameField"
                           GridPane.rowIndex="0" GridPane.columnIndex="1"/>

                <Label text="Felhasználónév:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                <TextField fx:id="usernameField"
                           GridPane.rowIndex="1" GridPane.columnIndex="1"
                           editable="false"/>

                <Label text="E-mail:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                <TextField fx:id="emailField"
                           GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                <Label text="Telefon:" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
                <TextField fx:id="phoneField"
                           GridPane.rowIndex="3" GridPane.columnIndex="1"/>

                <Label fx:id="errorLabel"
                       textFill="red"
                       GridPane.rowIndex="4"
                       GridPane.columnIndex="0"
                       GridPane.columnSpan="2"/>
            </children>
        </GridPane>
    </center>

    <bottom>
        <HBox spacing="10" BorderPane.alignment="CENTER_RIGHT">
            <padding>
                <Insets top="10" right="15" bottom="10" left="15"/>
            </padding>
            <children>
                <!-- Bal oldalt: jelszómódosító gomb -->
                <Button text="Jelszó módosítása"
                        onAction="#onChangePassword" />

                <Pane HBox.hgrow="ALWAYS"/>

                <!-- Jobb oldalt: Mégse / Mentés -->
                <Button text="Mégse" onAction="#onCancel"/>
                <Button text="Mentés" onAction="#onSave"/>
            </children>
        </HBox>
    </bottom>

</BorderPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/ChangePasswordDialog.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.ChangePasswordDialogController"
            prefWidth="400.0" prefHeight="260.0">

    <top>
        <Label text="Jelszó módosítása" BorderPane.alignment="CENTER">
            <font>
                <Font size="18.0" />
            </font>
            <padding>
                <Insets top="10" bottom="10" left="10" right="10"/>
            </padding>
        </Label>
    </top>

    <center>
        <GridPane hgap="10" vgap="10" BorderPane.alignment="CENTER">
            <padding>
                <Insets top="15" left="20" right="20" bottom="15"/>
            </padding>

            <columnConstraints>
                <ColumnConstraints prefWidth="150"/>
                <ColumnConstraints hgrow="ALWAYS"/>
            </columnConstraints>

            <children>
                <Label text="Régi jelszó:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                <PasswordField fx:id="oldPasswordField"
                               GridPane.rowIndex="0" GridPane.columnIndex="1"/>

                <Label text="Új jelszó:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                <PasswordField fx:id="newPasswordField"
                               GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                <Label text="Új jelszó (még egyszer):" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                <PasswordField fx:id="newPasswordAgainField"
                               GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                <Label fx:id="errorLabel" textFill="red"
                       GridPane.rowIndex="3" GridPane.columnIndex="0" GridPane.columnSpan="2"/>
            </children>
        </GridPane>
    </center>

    <bottom>
        <HBox spacing="10" BorderPane.alignment="CENTER_RIGHT">
            <padding>
                <Insets top="10" right="15" bottom="10" left="15"/>
            </padding>
            <children>
                <Button text="Mégse" onAction="#onCancel"/>
                <Button text="Mentés" onAction="#onSave"/>
            </children>
        </HBox>
    </bottom>

</BorderPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/Controller/ArrivalsDialog.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.controller.ArrivalsDialogController">

    <top>
        <VBox spacing="8" BorderPane.alignment="CENTER_LEFT">
            <padding>
                <Insets top="10" left="16" right="16" bottom="8"/>
            </padding>
            <children>
                <Label fx:id="titleLabel" text="Érkező járatok">
                    <font>
                        <Font size="20"/>
                    </font>
                </Label>
                <Label fx:id="subtitleLabel"
                       text="A legközelebbi érkezések a kijelölt repülőtérre."/>
                <HBox spacing="8">
                    <children>
                        <Label text="Keresés:"/>
                        <TextField fx:id="searchField"
                                   promptText="Járatszám, légitársaság, repülőtér..."/>
                        <Label text="Státusz:"/>
                        <ComboBox fx:id="statusFilterBox" prefWidth="140"/>
                    </children>
                </HBox>
            </children>
        </VBox>
    </top>

    <center>
        <VBox spacing="8" BorderPane.alignment="CENTER">
            <padding>
                <Insets top="4" left="16" right="16" bottom="4"/>
            </padding>
            <children>
                <TableView fx:id="flightsTable">
                    <columns>
                        <TableColumn fx:id="flightNumberColumn" text="Járatszám" prefWidth="120"/>
                        <TableColumn fx:id="airlineColumn" text="Légitársaság" prefWidth="180"/>
                        <TableColumn fx:id="originColumn" text="Kiindulási repülőtér" prefWidth="250"/>
                        <TableColumn fx:id="schedArrColumn" text="Menetrend szerinti érkezés" prefWidth="180"/>
                        <TableColumn fx:id="estArrColumn" text="Várható érkezés" prefWidth="160"/>
                        <TableColumn fx:id="gateColumn" text="Kapú" prefWidth="80"/>
                        <TableColumn fx:id="statusColumn" text="Státusz" prefWidth="150"/>
                    </columns>
                </TableView>

                <Separator/>

                <!-- Kijelölt járat + repülőgép infók -->
                <GridPane hgap="10" vgap="4">
                    <columnConstraints>
                        <ColumnConstraints minWidth="80" />
                        <ColumnConstraints minWidth="180" />
                        <ColumnConstraints minWidth="100" />
                        <ColumnConstraints minWidth="150" />
                    </columnConstraints>
                    <rowConstraints>
                        <RowConstraints minHeight="24"/>
                        <RowConstraints minHeight="24"/>
                        <RowConstraints minHeight="24"/>
                        <RowConstraints minHeight="24"/>
                    </rowConstraints>

                    <children>
                        <!-- Kijelölt járat -->
                        <Label text="Kijelölt járat:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                        <Label fx:id="selectedFlightLabel" text="–"
                               GridPane.rowIndex="0" GridPane.columnIndex="1"
                               GridPane.columnSpan="3"/>

                        <!-- Lajstromjel + típus -->
                        <Label text="Lajstromjel:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                        <Label fx:id="aircraftRegLabel" text="–"
                               GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                        <Label text="Típus (ICAO):" GridPane.rowIndex="1" GridPane.columnIndex="2"/>
                        <Label fx:id="aircraftTypeLabel" text="–"
                               GridPane.rowIndex="1" GridPane.columnIndex="3"/>

                        <!-- Férőhely + gyártási év -->
                        <Label text="Férőhely:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                        <Label fx:id="aircraftSeatsLabel" text="–"
                               GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                        <Label text="Gyártási év:" GridPane.rowIndex="2" GridPane.columnIndex="2"/>
                        <Label fx:id="aircraftYearLabel" text="–"
                               GridPane.rowIndex="2" GridPane.columnIndex="3"/>

                        <!-- Gép státusza -->
                        <Label text="Gép státusza:" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
                        <Label fx:id="aircraftStatusLabel" text="–"
                               GridPane.rowIndex="3" GridPane.columnIndex="1"
                               GridPane.columnSpan="3"/>
                    </children>
                </GridPane>
            </children>
        </VBox>
    </center>

    <bottom>
        <HBox spacing="10" BorderPane.alignment="CENTER_RIGHT">
            <padding>
                <Insets top="8" left="16" right="16" bottom="10"/>
            </padding>
            <children>
                <Label fx:id="statusLabel" text="Járatok betöltve."/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="Bezárás" onAction="#onClose"/>
            </children>
        </HBox>
    </bottom>

</BorderPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/Controller/DeparturesDialog.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.controller.DeparturesDialogController">

    <top>
        <VBox spacing="8" BorderPane.alignment="CENTER_LEFT">
            <padding>
                <Insets top="10" left="16" right="16" bottom="8"/>
            </padding>
            <children>
                <Label fx:id="titleLabel" text="Induló járatok">
                    <font>
                        <Font size="20"/>
                    </font>
                </Label>
                <Label fx:id="subtitleLabel"
                       text="A legközelebbi indulások a kijelölt repülőtérről."/>
                <HBox spacing="8">
                    <children>
                        <Label text="Keresés:"/>
                        <TextField fx:id="searchField"
                                   promptText="Járatszám, légitársaság, repülőtér..."/>
                        <Label text="Státusz:"/>
                        <ComboBox fx:id="statusFilterBox" prefWidth="140"/>
                    </children>
                </HBox>
            </children>
        </VBox>
    </top>

    <center>
        <VBox spacing="8" BorderPane.alignment="CENTER">
            <padding>
                <Insets top="4" left="16" right="16" bottom="4"/>
            </padding>
            <children>
                <TableView fx:id="flightsTable">
                    <columns>
                        <TableColumn fx:id="flightNumberColumn" text="Járatszám" prefWidth="120"/>
                        <TableColumn fx:id="airlineColumn" text="Légitársaság" prefWidth="180"/>
                        <TableColumn fx:id="destinationColumn" text="Cél repülőtér" prefWidth="250"/>
                        <TableColumn fx:id="schedDepColumn" text="Menetrend szerinti indulás" prefWidth="180"/>
                        <TableColumn fx:id="estDepColumn" text="Várható indulás" prefWidth="160"/>
                        <TableColumn fx:id="gateColumn" text="Kapú" prefWidth="80"/>
                        <TableColumn fx:id="statusColumn" text="Státusz" prefWidth="150"/>
                    </columns>
                </TableView>

                <Separator/>

                <GridPane hgap="10" vgap="4">
                    <columnConstraints>
                        <ColumnConstraints minWidth="80" />
                        <ColumnConstraints minWidth="180" />
                        <ColumnConstraints minWidth="100" />
                        <ColumnConstraints minWidth="150" />
                    </columnConstraints>
                    <rowConstraints>
                        <RowConstraints minHeight="24"/>
                        <RowConstraints minHeight="24"/>
                        <RowConstraints minHeight="24"/>
                        <RowConstraints minHeight="24"/>
                    </rowConstraints>

                    <children>
                        <Label text="Kijelölt járat:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                        <Label fx:id="selectedFlightLabel" text="–"
                               GridPane.rowIndex="0" GridPane.columnIndex="1"
                               GridPane.columnSpan="3"/>

                        <Label text="Lajstromjel:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                        <Label fx:id="aircraftRegLabel" text="–"
                               GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                        <Label text="Típus (ICAO):" GridPane.rowIndex="1" GridPane.columnIndex="2"/>
                        <Label fx:id="aircraftTypeLabel" text="–"
                               GridPane.rowIndex="1" GridPane.columnIndex="3"/>

                        <Label text="Férőhely:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                        <Label fx:id="aircraftSeatsLabel" text="–"
                               GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                        <Label text="Gyártási év:" GridPane.rowIndex="2" GridPane.columnIndex="2"/>
                        <Label fx:id="aircraftYearLabel" text="–"
                               GridPane.rowIndex="2" GridPane.columnIndex="3"/>

                        <Label text="Gép státusza:" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
                        <Label fx:id="aircraftStatusLabel" text="–"
                               GridPane.rowIndex="3" GridPane.columnIndex="1"
                               GridPane.columnSpan="3"/>
                    </children>
                </GridPane>
            </children>
        </VBox>
    </center>

    <bottom>
        <HBox spacing="10" BorderPane.alignment="CENTER_RIGHT">
            <padding>
                <Insets top="8" left="16" right="16" bottom="10"/>
            </padding>
            <children>
                <Label fx:id="statusLabel" text="Járatok betöltve."/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="Bezárás" onAction="#onClose"/>
            </children>
        </HBox>
    </bottom>

</BorderPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/MainPage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.text.Font?>

<HBox fx:id="rootPane" prefHeight="400.0" prefWidth="800.0" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.FourWings.atcSystem.frontend.MainPageController">

    <!-- Bal oldal: Logo -->
    <AnchorPane prefWidth="350.0" style="-fx-background-color: #0055ff;">
        <children>
            <ImageView fx:id="logoImage" fitHeight="200.0" fitWidth="200.0" layoutX="75.0" layoutY="100.0" preserveRatio="true">
            <image>
               <Image url="@../images/1.png" />
            </image></ImageView>
         <Label fx:id="motivaion" layoutX="69.0" layoutY="307.0" prefHeight="85.0" prefWidth="213.0" text="Ide jön a motivációs üzenet" textFill="WHITE" />
        </children>
    </AnchorPane>

    <!-- Jobb oldal: Login form -->
    <AnchorPane prefHeight="400.0" prefWidth="458.0" style="-fx-background-color: #ADD8E6;">
        <children>
            <Label layoutX="132.0" layoutY="36.0" text="Bejelentkezés">
                <font>
                    <Font size="32.0" />
                </font>
            </Label>
            <Label layoutX="93.0" layoutY="113.0" text="Felhasználónév" />
            <TextField id="UsernameField" fx:id="usernameField" layoutX="213.0" layoutY="109.0" />
            <Label layoutX="118.0" layoutY="149.0" prefHeight="17.0" prefWidth="40.0" text="Jelszó" />
            <PasswordField id="PasswordField" fx:id="passwordField" layoutX="213.0" layoutY="145.0" />
            <Button id="Button" fx:id="loginButton" layoutX="183.0" layoutY="239.0" onAction="#onLogin" prefHeight="25.0" prefWidth="90.0" text="Bejelentkezés" />
        <!-- onLogin -->
            <Label layoutX="156.0" layoutY="321.0" text="Ha nincs fiókod, regisztrálj:" />
         <Button fx:id="registerButton" layoutX="188.0" layoutY="350.0" mnemonicParsing="false" onAction="#goToRegister" text="Regisztráció" />
            <Label fx:id="statusLabel" layoutX="166.0" layoutY="274.0" prefHeight="41.0" prefWidth="262.0" />
        </children>
    </AnchorPane>
</HBox>

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/UserDataPage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.text.Font?>

<AnchorPane prefHeight="400.0" prefWidth="600.0"
            style="-fx-background-color: #55aaff;"
            xmlns="http://javafx.com/javafx/25"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.UserDataPageController">

    <children>

        <!-- Címsor -->
        <Label layoutX="224.0" layoutY="34.0" text="Saját adatok">
            <font>
                <Font size="28.0" />
            </font>
        </Label>

        <!-- Profilkép bal oldalt -->
        <ImageView fx:id="profileImageView"
                   layoutX="40.0" layoutY="120.0"
                   fitWidth="120" fitHeight="120"
                   preserveRatio="true"
                   style="-fx-border-color: white; -fx-border-width: 2;" />

        <!-- Profilkép módosítása gomb -->
        <Button layoutX="40.0" layoutY="250.0"
                text="Profilkép módosítása"
                onAction="#onChangeProfilePicture" />

        <!-- Adatok táblázatosan -->
        <GridPane layoutX="200.0" layoutY="120.0">
            <columnConstraints>
                <ColumnConstraints prefWidth="100.0" />
                <ColumnConstraints prefWidth="200.0" />
            </columnConstraints>

            <rowConstraints>
                <RowConstraints prefHeight="30.0" />
                <RowConstraints prefHeight="30.0" />
                <RowConstraints prefHeight="30.0" />
            </rowConstraints>

            <children>
                <Label text="Név:" />
                <Label fx:id="nameLabel" GridPane.columnIndex="1" />

                <Label text="E-mail:" GridPane.rowIndex="1"/>
                <Label fx:id="emailLabel"
                       GridPane.rowIndex="1"
                       GridPane.columnIndex="1" />

                <Label text="Telefon:" GridPane.rowIndex="2"/>
                <Label fx:id="phoneLabel"
                       GridPane.rowIndex="2"
                       GridPane.columnIndex="1" />
            </children>
        </GridPane>

        <!-- Vissza -->
        <Button layoutX="250.0" layoutY="320.0"
                text="Vissza a főoldalra"
                onAction="#toHome"/>

        <!-- Profil szerkesztése -->
        <Button layoutX="410.0" layoutY="320.0"
                text="Profil szerkesztése"
                onAction="#openProfileEditor"/>
    </children>
</AnchorPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/ControllerHomePage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.controller.ControllerHomePageController"
            prefWidth="1300.0" prefHeight="800.0"
            stylesheets="@../css/atc-theme.css">

    <!-- Felső hero rész: üdvözlés + reptér basic info -->
    <top>
        <VBox spacing="6" BorderPane.alignment="CENTER_LEFT"
              styleClass="controller-hero">
            <padding>
                <Insets top="18" left="28" right="20" bottom="14"/>
            </padding>
            <children>
                <Label fx:id="greetingLabel"
                       text="Szia, Irányító!"
                       styleClass="controller-greeting">
                    <font>
                        <Font size="28"/>
                    </font>
                </Label>

                <Label fx:id="airportTitleLabel"
                       text="Otthoni repülőtér: ICAO – Név"
                       styleClass="controller-airport-title">
                    <font>
                        <Font size="18"/>
                    </font>
                </Label>

                <Label fx:id="subtitleLabel"
                       text="Valós idejű időjárás, induló és érkező járatok áttekintése."
                       styleClass="controller-subtitle"/>
            </children>
        </VBox>
    </top>

    <!-- Középső rész: bal oldalt „üveg” időjárás kártya, jobb oldalt akció gombok -->
    <center>
        <HBox spacing="18" BorderPane.alignment="CENTER">
            <padding>
                <Insets top="10" left="28" right="28" bottom="10"/>
            </padding>
            <children>

                <!-- Időjárás kártya -->
                <StackPane HBox.hgrow="ALWAYS"
                           styleClass="glass-card">
                    <padding>
                        <Insets top="18" left="20" right="20" bottom="18"/>
                    </padding>
                    <children>
                        <VBox spacing="14">
                            <children>

                                <!-- Felső sor: ikon + hőmérséklet + állapot -->
                                <HBox spacing="14">
                                    <children>
                                        <Label fx:id="weatherEmojiLabel"
                                               text="☀️"
                                               styleClass="weather-emoji"/>
                                        <VBox spacing="4">
                                            <children>
                                                <Label fx:id="temperatureLabel"
                                                       text="+21°C"
                                                       styleClass="weather-temp-big"/>
                                                <Label fx:id="conditionLabel"
                                                       text="Derült égbolt"
                                                       styleClass="weather-condition"/>
                                            </children>
                                        </VBox>
                                    </children>
                                </HBox>

                                <!-- Reptér basic: ICAO / Név / Város -->
                                <HBox spacing="10">
                                    <children>
                                        <Label text="Reptér:"
                                               styleClass="weather-label-strong"/>
                                        <Label fx:id="airportBasicLabel"
                                               text="LHBP – Budapest Ferenc Liszt (Budapest)"
                                               styleClass="weather-label"/>
                                    </children>
                                </HBox>

                                <!-- Gridben a részletek -->
                                <GridPane hgap="20" vgap="6">
                                    <columnConstraints>
                                        <ColumnConstraints percentWidth="50"/>
                                        <ColumnConstraints percentWidth="50"/>
                                    </columnConstraints>

                                    <children>
                                        <Label text="Szél:"
                                               GridPane.rowIndex="0" GridPane.columnIndex="0"
                                               styleClass="weather-label-strong"/>
                                        <Label fx:id="windLabel"
                                               text="230° / 14 kt"
                                               GridPane.rowIndex="0" GridPane.columnIndex="1"
                                               styleClass="weather-label"/>

                                        <Label text="Látástáv:"
                                               GridPane.rowIndex="1" GridPane.columnIndex="0"
                                               styleClass="weather-label-strong"/>
                                        <Label fx:id="visibilityLabel"
                                               text="9999 m"
                                               GridPane.rowIndex="1" GridPane.columnIndex="1"
                                               styleClass="weather-label"/>

                                        <Label text="QNH:"
                                               GridPane.rowIndex="2" GridPane.columnIndex="0"
                                               styleClass="weather-label-strong"/>
                                        <Label fx:id="pressureLabel"
                                               text="1015 hPa"
                                               GridPane.rowIndex="2" GridPane.columnIndex="1"
                                               styleClass="weather-label"/>

                                        <Label text="Hőérzet / harmatpont:"
                                               GridPane.rowIndex="3" GridPane.columnIndex="0"
                                               styleClass="weather-label-strong"/>
                                        <Label fx:id="feelsLikeLabel"
                                               text="+19°C / +13°C"
                                               GridPane.rowIndex="3" GridPane.columnIndex="1"
                                               styleClass="weather-label"/>

                                        <Label text="Frissítve:"
                                               GridPane.rowIndex="4" GridPane.columnIndex="0"
                                               styleClass="weather-label-strong"/>
                                        <Label fx:id="updatedAtLabel"
                                               text="2025-12-05 11:42 UTC"
                                               GridPane.rowIndex="4" GridPane.columnIndex="1"
                                               styleClass="weather-label"/>
                                    </children>
                                </GridPane>

                                <!-- METAR / megjegyzés -->
                                <Label fx:id="metarLabel"
                                       text="METAR LHBP 051120Z 23014KT CAVOK 21/13 Q1015 NOSIG"
                                       wrapText="true"
                                       styleClass="weather-metar"/>

                            </children>
                        </VBox>
                    </children>
                </StackPane>

                <!-- Jobb oldal: akciók „csempe” jelleggel -->
                <VBox spacing="14" prefWidth="260">
                    <children>

                        <Label text="Akciók"
                               styleClass="actions-title"/>

                        <Button fx:id="weatherAssistantButton"
                                text="Időjárás asszisztens megnyitása"
                                onAction="#onOpenWeatherAssistant"
                                maxWidth="Infinity"
                                styleClass="primary-action"/>

                        <Button fx:id="departuresButton"
                                text="Induló járatok"
                                onAction="#onShowDepartures"
                                maxWidth="Infinity"
                                styleClass="secondary-action"/>

                        <Button fx:id="arrivalsButton"
                                text="Érkező járatok"
                                onAction="#onShowArrivals"
                                maxWidth="Infinity"
                                styleClass="secondary-action"/>

                        <Separator/>

                        <Button fx:id="logoutButton"
                                text="Kijelentkezés"
                                onAction="#onLogout"
                                maxWidth="Infinity"
                                styleClass="danger-action"/>
                    </children>
                </VBox>

            </children>
        </HBox>
    </center>

    <!-- Alsó státuszsor -->
    <bottom>
        <HBox BorderPane.alignment="CENTER_LEFT"
              styleClass="controller-statusbar">
            <padding>
                <Insets top="6" bottom="8" left="20" right="20"/>
            </padding>
            <children>
                <Label fx:id="statusLabel"
                       text="Készen áll."/>
            </children>
        </HBox>
    </bottom>
</BorderPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/RegistrationPage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.text.Font?>

<AnchorPane prefHeight="400.0" prefWidth="600.0"
            xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.RegistrationPageController">

    <children>
        <!-- CÍM -->
        <Label layoutX="215.0" layoutY="28.0" text="Regisztráció">
            <font>
                <Font size="33.0" />
            </font>
        </Label>

        <!-- Felső instrukció -->
        <Label layoutX="119.0" layoutY="84.0" text="Add meg az adataidat" />

        <!-- Mezők -->
        <TextField fx:id="nevInput" layoutX="98.0" layoutY="109.0" />
        <TextField fx:id="userInput" layoutX="98.0" layoutY="144.0" />
        <TextField fx:id="emailInput" layoutX="98.0" layoutY="175.0" />
        <PasswordField fx:id="passInput" layoutX="98.0" layoutY="206.0" />
        <TextField fx:id="phoneInput" layoutX="98.0" layoutY="239.0" />

        <!-- Mezőcímkék -->
        <Label layoutX="38.0" layoutY="113.0" text="Nev" />
        <Label layoutX="25.0" layoutY="148.0" text="Felh. nev" />
        <Label layoutX="32.0" layoutY="179.0" text="E-mail" />
        <Label layoutX="32.0" layoutY="210.0" text="Jelszo" />
        <Label layoutX="29.0" layoutY="243.0" text="Telefon" />

        <!-- PROFILKÉP BLOKK JOBB OLDALT -->
        <HBox layoutX="340.0" layoutY="120.0" spacing="10">
            <children>
                <ImageView fx:id="profileImageView"
                           fitWidth="100" fitHeight="100"
                           preserveRatio="true"
                           style="-fx-border-color: gray; -fx-border-width: 1;" />
                <Button text="Profilkép választása"
                        onAction="#onSelectProfileImage" />
            </children>
        </HBox>

        <Label fx:id="imageErrorLabel"
               layoutX="340.0"
               layoutY="230.0"
               textFill="red"/>

        <!-- GOMBOK -->
        <Button fx:id="registerButton"
                layoutX="174.0" layoutY="286.0"
                mnemonicParsing="false"
                onAction="#register"
                text="Regisztracio" />

        <Button fx:id="backToMainPageButton"
                layoutX="273.0" layoutY="286.0"
                mnemonicParsing="false"
                onAction="#backToMainPage"
                text="Bejelentkezés" />

        <!-- Visszajelző label -->
        <Label fx:id="registerLabel" layoutX="104.0" layoutY="338.0" />
    </children>
</AnchorPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/AdminPage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.AnchorPane?>


<AnchorPane prefHeight="400.0" prefWidth="600.0" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.FourWings.atcSystem.frontend.AdminPageController">
   <children>
      <Label layoutX="243.0" layoutY="21.0" text="Admin bejelentkezve" />
      <Button fx:id="FelhasznalokButton" layoutX="255.0" layoutY="59.0" mnemonicParsing="false" onAction="#goToUserAdminPage" text="Felhasznalok" />
       <Button fx:id="logoutButton"
               text="Kijelentkezés"
               onAction="#onLogout"
               layoutX="500"
               layoutY="10"/>
       <Button text="Időjárás asszisztens"
               onAction="#onOpenWeatherAssistant"
               layoutX="20.0" layoutY="200.0" />
   </children>
</AnchorPane>

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/UserAdminPage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.layout.Region?>

<BorderPane xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.UserAdminPageController"
            prefWidth="1400.0" prefHeight="900.0">

    <top>
        <VBox spacing="8" BorderPane.alignment="CENTER">
            <children>

                <Label text="Felhasználókezelés – Admin felület">
                    <font>
                        <Font size="26"/>
                    </font>
                    <padding>
                        <Insets top="10" right="10" bottom="5" left="10"/>
                    </padding>
                </Label>

                <ToolBar>
                    <items>
                        <Button fx:id="refreshButton" text="Lista frissítése" onAction="#onRefresh"/>
                        <Button fx:id="addUserButton"
                                text="Új felhasználó"
                                onAction="#onAddNewUser"/>
                        <Button fx:id="editUserButton"
                                text="Kijelölt szerkesztése"
                                onAction="#onEditSelectedUser"/>
                        <Button fx:id="deleteUserButton"
                                text="Kijelölt törlése"
                                onAction="#onDeleteUser"/>

                        <Separator/>

                        <Label text="Keresés:"/>
                        <TextField fx:id="searchField"
                                   promptText="Név / felhasználónév / e-mail"
                                   prefWidth="250"/>

                        <Region HBox.hgrow="ALWAYS"/>

                        <Button fx:id="backToAdminButton"
                                text="Vissza az admin főoldalra"
                                onAction="#onBackToAdmin"/>
                    </items>
                </ToolBar>

            </children>
        </VBox>
    </top>

    <center>
        <TableView fx:id="usersTable" BorderPane.alignment="CENTER">
            <columns>
                <TableColumn fx:id="idColumn" text="ID" prefWidth="80"/>
                <TableColumn fx:id="nameColumn" text="Név" prefWidth="230"/>
                <TableColumn fx:id="usernameColumn" text="Felhasználónév" prefWidth="200"/>
                <TableColumn fx:id="emailColumn" text="E-mail" prefWidth="300"/>
                <TableColumn fx:id="phoneColumn" text="Telefon" prefWidth="180"/>
                <TableColumn fx:id="roleColumn" text="Szerepkör" prefWidth="120"/>
                <!-- ÚJ: hozzárendelt repülőtér -->
                <TableColumn fx:id="airportColumn" text="Irányító reptere" prefWidth="260"/>
            </columns>
        </TableView>
    </center>

    <bottom>
        <HBox BorderPane.alignment="CENTER_LEFT">
            <children>
                <Label fx:id="statusLabel" text="Készen áll.">
                    <padding>
                        <Insets top="5" right="10" bottom="8" left="10"/>
                    </padding>
                </Label>
            </children>
        </HBox>
    </bottom>

</BorderPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/HomePage.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.paint.Color?>
<?import javafx.scene.text.Font?>

<HBox prefHeight="800.0" prefWidth="1200.0" style="-fx-background-color: #ffffff;" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.FourWings.atcSystem.frontend.HomePageController">
    <children>
        <AnchorPane fx:id="mainAnchorPane" prefHeight="800.0" prefWidth="1200.0" style="-fx-background-color: #0055ff;" HBox.hgrow="ALWAYS">
            <children>

                <Label alignment="CENTER" layoutX="26.0" layoutY="8.0" prefHeight="63.0" prefWidth="148.0" text="Főoldal" textFill="WHITE">
                    <font>
                        <Font size="36.0" />
                    </font>
                    <effect>
                        <DropShadow>
                            <color>
                                <Color blue="0.86" green="0.6613" red="0.0258" />
                            </color>
                        </DropShadow>
                    </effect>
                </Label>

                <Button fx:id="logoutButton" layoutX="1080.0" layoutY="20.0" onAction="#onLogout" style="-fx-background-color: #ff5252; -fx-text-fill: white; -fx-font-weight: bold;" text="Kijelentkezés" />

                <Button fx:id="dataButton" layoutX="960.0" layoutY="20.0" onAction="#onGoToPersonalData" style="-fx-background-color: white; -fx-text-fill: #0055ff; -fx-font-weight: bold;" text="Saját adatok" />

                <HBox alignment="CENTER_LEFT" layoutX="26.0" layoutY="80.0" spacing="15.0">
                    <ComboBox fx:id="menuComboBox" prefWidth="180.0" style="-fx-background-color: white;">
                        <items>
                            <FXCollections fx:factory="observableArrayList">
                                <String fx:value="Főoldal" />
                                <String fx:value="Kapuk(Ez inkább a repterekhez menne)" />
                                <String fx:value="Repülők" />
                                <String fx:value="Repterek" />
                                <String fx:value="Repülőutak" />
                                <String fx:value="Terminál(Ez is inkább reptér)" />
                            </FXCollections>
                        </items>
                    </ComboBox>

                    <Label style="-fx-font-weight: bold;" text="Reptér választása:" textFill="WHITE" />

                    <ComboBox fx:id="airportSelector" prefWidth="250.0" promptText="-- Válassz repteret --" style="-fx-background-color: white;" />

                    <Button onAction="#onRefresh" style="-fx-background-color: #4caf50; -fx-text-fill: white; -fx-font-weight: bold;" text="Frissítés" />
                </HBox>

                <HBox layoutX="26.0" layoutY="140.0" prefWidth="1150.0" spacing="20.0" AnchorPane.leftAnchor="26.0" AnchorPane.rightAnchor="26.0">
                    <VBox alignment="CENTER" prefHeight="100.0" style="-fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.4), 5, 0, 0, 1);" HBox.hgrow="ALWAYS">
                        <Label text="MAI JÁRATOK" textFill="#0d47a1">
                            <font><Font name="System Bold" size="14.0" /></font>
                        </Label>
                        <Label fx:id="totalFlightsLabel" text="0" textFill="#0d47a1">
                            <font><Font name="System Bold" size="36.0" /></font>
                        </Label>
                    </VBox>

                    <VBox alignment="CENTER" prefHeight="100.0" style="-fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.4), 5, 0, 0, 1);" HBox.hgrow="ALWAYS">
                        <Label text="KÉSÉSEK (Delayed)" textFill="#b71c1c">
                            <font><Font name="System Bold" size="14.0" /></font>
                        </Label>
                        <Label fx:id="delayedFlightsLabel" text="0" textFill="#b71c1c">
                            <font><Font name="System Bold" size="36.0" /></font>
                        </Label>
                    </VBox>

                    <VBox alignment="CENTER" prefHeight="100.0" style="-fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.4), 5, 0, 0, 1);" HBox.hgrow="ALWAYS">
                        <Label text="SZABAD KAPUK" textFill="#1b5e20">
                            <font><Font name="System Bold" size="14.0" /></font>
                        </Label>
                        <Label fx:id="freeGatesLabel" text="0" textFill="#1b5e20">
                            <font><Font name="System Bold" size="36.0" /></font>
                        </Label>
                    </VBox>
                </HBox>

                <HBox layoutX="26.0" layoutY="270.0" prefHeight="450.0" prefWidth="1150.0" spacing="20.0" AnchorPane.bottomAnchor="30.0" AnchorPane.leftAnchor="26.0" AnchorPane.rightAnchor="26.0" AnchorPane.topAnchor="270.0">

                    <VBox style="-fx-background-color: white; -fx-background-radius: 10;" HBox.hgrow="ALWAYS">
                        <padding><Insets bottom="10" left="10" right="10" top="10" /></padding>
                        <Label style="-fx-font-weight: bold; -fx-font-size: 16px;" text="Járatstátuszok Eloszlása" />
                        <PieChart fx:id="statusPieChart" />
                    </VBox>

                    <VBox style="-fx-background-color: white; -fx-background-radius: 10;" HBox.hgrow="ALWAYS">
                        <padding><Insets bottom="10" left="10" right="10" top="10" /></padding>
                        <Label style="-fx-font-weight: bold; -fx-font-size: 16px;" text="Forgalom (Induló / Érkező)" />
                        <BarChart fx:id="trafficBarChart">
                            <xAxis>
                                <CategoryAxis label="Irány" />
                            </xAxis>
                            <yAxis>
                                <NumberAxis label="Járatok száma" />
                            </yAxis>
                        </BarChart>
                    </VBox>
                </HBox>

            </children>
        </AnchorPane>
    </children>
</HBox>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/fxml/UserEditDialog.fxml
================================
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.FourWings.atcSystem.frontend.UserEditDialogController"
            prefWidth="500.0" prefHeight="450.0">

    <top>
        <Label text="Felhasználó szerkesztése" BorderPane.alignment="CENTER">
            <font>
                <Font size="22.0" />
            </font>
            <padding>
                <Insets top="10" bottom="10" left="10" right="10"/>
            </padding>
        </Label>
    </top>

    <center>
        <GridPane hgap="10" vgap="10" BorderPane.alignment="CENTER">
            <padding>
                <Insets top="15" left="20" right="20" bottom="15"/>
            </padding>

            <columnConstraints>
                <ColumnConstraints prefWidth="150"/>
                <ColumnConstraints hgrow="ALWAYS"/>
            </columnConstraints>

            <children>
                <!-- ID (csak olvasható) -->
                <Label text="ID:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                <TextField fx:id="idField"
                           GridPane.rowIndex="0" GridPane.columnIndex="1"
                           editable="false"/>

                <!-- Név -->
                <Label text="Név:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                <TextField fx:id="nameField"
                           GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                <!-- Felhasználónév -->
                <Label text="Felhasználónév:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                <TextField fx:id="usernameField"
                           GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                <!-- Jelszó -->
                <Label text="Jelszó (üres = nem változik / új usernél ideiglenes generálódik)"
                       wrapText="true"
                       GridPane.rowIndex="3" GridPane.columnIndex="0"/>
                <PasswordField fx:id="passwordField"
                               promptText="Jelszó (opcionális)"
                               GridPane.rowIndex="3" GridPane.columnIndex="1"/>

                <!-- E-mail -->
                <Label text="E-mail:" GridPane.rowIndex="4" GridPane.columnIndex="0"/>
                <TextField fx:id="emailField"
                           GridPane.rowIndex="4" GridPane.columnIndex="1"/>

                <!-- Telefon -->
                <Label text="Telefon:" GridPane.rowIndex="5" GridPane.columnIndex="0"/>
                <TextField fx:id="phoneField"
                           GridPane.rowIndex="5" GridPane.columnIndex="1"/>

                <!-- Szerepkör (USER / CONTROLLER / ADMIN) -->
                <Label text="Szerepkör:"
                       GridPane.rowIndex="6" GridPane.columnIndex="0"/>
                <ComboBox fx:id="roleComboBox"
                          prefWidth="200"
                          GridPane.rowIndex="6" GridPane.columnIndex="1"/>

                <!-- Hozzárendelt repülőtér (csak CONTROLLER szerepkörnél látszik) -->
                <Label fx:id="airportLabel"
                       text="Hozzárendelt repülőtér:"
                       GridPane.rowIndex="7" GridPane.columnIndex="0"/>
                <ComboBox fx:id="airportComboBox"
                          prefWidth="250"
                          GridPane.rowIndex="7" GridPane.columnIndex="1"/>

                <!-- Hibaüzenet -->
                <Label fx:id="errorLabel"
                       textFill="red"
                       GridPane.rowIndex="8"
                       GridPane.columnIndex="0"
                       GridPane.columnSpan="2"/>
            </children>
        </GridPane>
    </center>

    <bottom>
        <HBox spacing="10" BorderPane.alignment="CENTER_RIGHT">
            <padding>
                <Insets top="10" right="15" bottom="10" left="15"/>
            </padding>
            <children>
                <Button text="Mégse" fx:id="cancelButton" onAction="#onCancel"/>
                <Button text="Mentés" fx:id="saveButton" onAction="#onSave"/>
            </children>
        </HBox>
    </bottom>

</BorderPane>
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/resources/application.properties
================================
spring.application.name=ATC_system

spring.datasource.url = jdbc:mysql://mohacsek.hu:3306/atc_system
spring.datasource.username=levente
spring.datasource.password=levente
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

openweather.api.key=d9ccbeecf70d8252de45308831c623ce
openweather.api.baseurl=https://api.openweathermap.org/data/2.5
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/AdminPageController.java
================================
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.config.SpringContext;
import com.FourWings.atcSystem.model.user.User;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.stage.Modality;
import javafx.stage.Stage;
import org.springframework.stereotype.Component;


@Component
public class AdminPageController {

    @FXML
    private Button FelhasznalokButton;

    @FXML
    private Label adminWelcomeLabel;

    private User loggedUser;

    public void initWithUser(User user) {
        this.loggedUser = user;
    }

    @FXML
    public void goToUserAdminPage(ActionEvent event) throws Exception{
        SceneManager.switchTo("UserAdminPage.fxml", "Bejelentkezés", 1280, 720);
    }

    @FXML
    private void onLogout(ActionEvent event) {
        SceneManager.switchTo("MainPage.fxml", "ATC – Bejelentkezés", 800, 400);
    }

    @FXML
    private void onOpenWeatherAssistant(ActionEvent event) {
        try {
            FXMLLoader loader = new FXMLLoader(
                    getClass().getResource("/fxml/FlightWeatherAssistantDialog.fxml"));
            loader.setControllerFactory(SpringContext::getBean);
            Parent root = loader.load();

            Stage dialogStage = new Stage();
            dialogStage.initModality(Modality.WINDOW_MODAL);
            // ha van admin ablakod, beállíthatod ownernek:
            // dialogStage.initOwner(someNode.getScene().getWindow());
            dialogStage.setTitle("Időjárás asszisztens");
            dialogStage.setScene(new Scene(root, 600, 420));
            dialogStage.showAndWait();

        } catch (Exception ex) {
            ex.printStackTrace();
            // ide tehetsz Alert-et is, ha szeretnél
        }
    }


}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/UserEditDialogController.java
================================
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.airport.AirportsService;
import com.FourWings.atcSystem.model.user.User;
import com.FourWings.atcSystem.model.user.UserRole;
import com.FourWings.atcSystem.model.user.UserService;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.scene.control.*;
import javafx.stage.Stage;
import lombok.Getter;
import org.springframework.stereotype.Component;

@Component
public class UserEditDialogController {

    private final UserService userService;
    private final AirportsService airportsService;

    public UserEditDialogController(UserService userService,
                                    AirportsService airportsService) {
        this.userService = userService;
        this.airportsService = airportsService;
    }

    @FXML private TextField idField;
    @FXML private TextField nameField;
    @FXML private TextField usernameField;
    @FXML private TextField emailField;
    @FXML private TextField phoneField;
    @FXML private PasswordField passwordField;
    @FXML private Label errorLabel;

    @FXML private ComboBox<UserRole> roleComboBox;
    @FXML private ComboBox<Airports> airportComboBox;
    @FXML private Label airportLabel;

    private User user;
    private String originalUsername;

    @Getter
    private boolean edited = false;

    private final ObservableList<Airports> airportOptions = FXCollections.observableArrayList();

    @FXML
    private void initialize() {
        // Szerepkör lista
        if (roleComboBox != null) {
            roleComboBox.setItems(FXCollections.observableArrayList(UserRole.values()));
            roleComboBox.valueProperty().addListener((obs, oldVal, newVal) -> {
                updateAirportVisibility(newVal);
            });
        }

        // Repterek betöltése
        if (airportComboBox != null) {
            airportOptions.setAll(airportsService.getAllAirports());
            airportComboBox.setItems(airportOptions);

            // Szebb megjelenítés
            airportComboBox.setCellFactory(cb -> new ListCell<>() {
                @Override
                protected void updateItem(Airports item, boolean empty) {
                    super.updateItem(item, empty);
                    if (empty || item == null) {
                        setText(null);
                    } else {
                        String icao = item.getIcaoCode() != null ? item.getIcaoCode() : "";
                        String name = item.getName() != null ? item.getName() : "";
                        setText(icao + " – " + name);
                    }
                }
            });
            airportComboBox.setButtonCell(new ListCell<>() {
                @Override
                protected void updateItem(Airports item, boolean empty) {
                    super.updateItem(item, empty);
                    if (empty || item == null) {
                        setText(null);
                    } else {
                        String icao = item.getIcaoCode() != null ? item.getIcaoCode() : "";
                        String name = item.getName() != null ? item.getName() : "";
                        setText(icao + " – " + name);
                    }
                }
            });
        }

        updateAirportVisibility(roleComboBox != null ? roleComboBox.getValue() : null);
    }

    private void updateAirportVisibility(UserRole role) {
        boolean controller = (role == UserRole.CONTROLLER);

        if (airportLabel != null) {
            airportLabel.setVisible(controller);
            airportLabel.setManaged(controller);
        }
        if (airportComboBox != null) {
            airportComboBox.setVisible(controller);
            airportComboBox.setManaged(controller);
        }
    }

    public void setUser(User user) {
        this.user = user;

        if (user.getId() != 0) {
            idField.setText(String.valueOf(user.getId()));
            nameField.setText(user.getName());
            usernameField.setText(user.getUsername());
            emailField.setText(user.getEmail());
            phoneField.setText(user.getPhone());

            UserRole role = user.getRole() != null ? user.getRole() : UserRole.USER;
            if (roleComboBox != null) {
                roleComboBox.setValue(role);
            }

            // assignedAirport beállítása: ID alapján megkeressük a listában
            if (airportComboBox != null && user.getAssignedAirport() != null) {
                long assignedId = user.getAssignedAirport().getId();
                Airports match = airportOptions.stream()
                        .filter(a -> a.getId() == assignedId)
                        .findFirst()
                        .orElse(null);
                airportComboBox.setValue(match);
            }

            passwordField.clear();
            originalUsername = user.getUsername();

        } else {
            idField.clear();
            nameField.clear();
            usernameField.clear();
            emailField.clear();
            phoneField.clear();
            passwordField.clear();

            if (roleComboBox != null) {
                roleComboBox.setValue(UserRole.USER);
            }
            if (airportComboBox != null) {
                airportComboBox.setValue(null);
            }

            originalUsername = null;
        }

        if (roleComboBox != null) {
            updateAirportVisibility(roleComboBox.getValue());
        }
    }

    @FXML
    private void onSave(ActionEvent event) {
        if (user == null) {
            errorLabel.setText("Nincs kiválasztott felhasználó.");
            return;
        }

        String name = nameField.getText().trim();
        String username = usernameField.getText().trim();

        if (name.isEmpty() || username.isEmpty()) {
            errorLabel.setText("Név és felhasználónév kötelező.");
            return;
        }

        boolean isNewUser = (user.getId() == 0);
        boolean usernameChanged =
                isNewUser ||
                        (originalUsername != null && !originalUsername.equalsIgnoreCase(username));

        if (usernameChanged && !userService.isUsernameAvailable(username)) {
            String msg = "Már létezik ilyen felhasználónév: " + username;
            errorLabel.setText(msg);

            Alert alert = new Alert(Alert.AlertType.ERROR);
            alert.setTitle("Felhasználónév foglalt");
            alert.setHeaderText("A megadott felhasználónév már létezik.");
            alert.setContentText(msg);
            alert.showAndWait();

            return;
        }

        user.setName(name);
        user.setUsername(username);
        user.setEmail(emailField.getText().trim());
        user.setPhone(phoneField.getText().trim());

        UserRole selectedRole =
                (roleComboBox != null && roleComboBox.getValue() != null)
                        ? roleComboBox.getValue()
                        : UserRole.USER;
        user.setRole(selectedRole);

        if (selectedRole == UserRole.CONTROLLER) {
            Airports selectedAirport =
                    (airportComboBox != null ? airportComboBox.getValue() : null);

            if (selectedAirport == null) {
                errorLabel.setText("Controller szerepkörhöz ki kell választani egy repülőteret.");
                return;
            }
            user.setAssignedAirport(selectedAirport);
        } else {
            user.setAssignedAirport(null);
        }

        String rawPassword = passwordField.getText();
        String tempPasswordForInfo = null;

        if (user.getId() == 0) {
            if (rawPassword == null || rawPassword.isBlank()) {
                tempPasswordForInfo = userService.generateTempPassword();
                rawPassword = tempPasswordForInfo;
            }
        } else {
            if (rawPassword == null || rawPassword.isBlank()) {
                rawPassword = null;
            }
        }

        try {
            userService.saveFromAdmin(user, rawPassword);
        } catch (Exception ex) {
            errorLabel.setText("Mentési hiba: " + ex.getMessage());

            Alert alert = new Alert(Alert.AlertType.ERROR);
            alert.setTitle("Mentési hiba");
            alert.setHeaderText("Nem sikerült menteni a felhasználót.");
            alert.setContentText(ex.getMessage());
            alert.showAndWait();
            return;
        }

        if (tempPasswordForInfo != null) {
            Alert alert = new Alert(Alert.AlertType.INFORMATION);
            alert.setTitle("Ideiglenes jelszó");
            alert.setHeaderText("Új felhasználó ideiglenes jelszava");
            alert.setContentText(
                    "Felhasználónév: " + user.getUsername() + "\n" +
                            "Ideiglenes jelszó: " + tempPasswordForInfo + "\n\n" +
                            "Add át a felhasználónak, és kérd meg, hogy az első belépés után változtassa meg."
            );
            alert.showAndWait();
        }

        edited = true;
        closeWindow();
    }

    @FXML
    private void onCancel(ActionEvent event) {
        edited = false;
        closeWindow();
    }

    private void closeWindow() {
        Stage stage = (Stage) idField.getScene().getWindow();
        stage.close();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/HomePage/TerminalPageController.java
================================
package com.FourWings.atcSystem.frontend.HomePage;

import com.FourWings.atcSystem.config.SceneManager;
import javafx.fxml.FXML;
import javafx.scene.control.ComboBox;
import org.springframework.stereotype.Component;

@Component
public class TerminalPageController {

    public static final int WIDTH = 1200; //Window szélesség
    public static final int HEIGHT = 600; //Window magasság
    @FXML
    private ComboBox<String> menuComboBox;

    @FXML
    public void initialize() {
        if (menuComboBox != null) {
            menuComboBox.getSelectionModel().selectedItemProperty().addListener((obs, oldVal, newVal) -> {
                if (newVal != null) {
                    switch (newVal) {
                        case "Főoldal":
                            SceneManager.switchTo("HomePage.fxml", "ATC – Főoldal", WIDTH, HEIGHT);
                            break;
                        case "Repülők":
                            SceneManager.switchTo("HomePage/PlanesPage.fxml", "ATC – Repülők", WIDTH, HEIGHT);
                            break;
                        case "Repterek":
                            SceneManager.switchTo("HomePage/AirportsPage.fxml", "ATC – Repterek", WIDTH, HEIGHT);
                            break;
                        case "Repülőutak":
                            SceneManager.switchTo("HomePage/RoutesPage.fxml", "ATC – Repülőutak", WIDTH, HEIGHT);
                            break;
                        case "Kapuk(Ez inkább a repterekhez menne)":
                            SceneManager.switchTo("HomePage/GatesPage.fxml", "ATC – Kapuk", WIDTH, HEIGHT);
                            break;
                        case "Terminál(Ez is inkább reptér)":
                            break;
                    }
                }
            });
            menuComboBox.getSelectionModel().select("Terminál(Ez is inkább reptér)");
        }
    }

    @FXML
    private void onLogout() {
        SceneManager.switchTo("MainPage.fxml", "ATC – Bejelentkezés", 800, 400);
    }

}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/HomePage/PlanesPageController.java
================================
package com.FourWings.atcSystem.frontend.HomePage;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.model.aircraft.Aircraft;
import com.FourWings.atcSystem.model.aircraft.AircraftService;
import com.FourWings.atcSystem.model.airline.Airline;
import com.FourWings.atcSystem.model.airline.AirlineRepository;
import javafx.beans.property.SimpleStringProperty;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.collections.transformation.FilteredList;
import javafx.fxml.FXML;
import javafx.scene.control.*;
import javafx.scene.control.cell.PropertyValueFactory;
import org.springframework.stereotype.Component;

import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

@Component
class AircraftPageController {

    public static final int WIDTH = 1200;
    public static final int HEIGHT = 800; // Frissítettem 800-ra a dashboardhoz igazítva

    private final AircraftService aircraftService;
    private final AirlineRepository airlineRepository;

    // --- FXML Elemek ---
    @FXML private ComboBox<String> menuComboBox;
    @FXML private TextField searchField;
    @FXML private Label statusLabel;
    @FXML private Button logoutButton;

    // --- TÁBLÁZAT ---
    @FXML private TableView<Aircraft> aircraftTable;

    // Oszlopok
    @FXML private TableColumn<Aircraft, Long> idColumn;
    @FXML private TableColumn<Aircraft, String> registrationColumn;
    @FXML private TableColumn<Aircraft, String> typeIcaoColumn;
    @FXML private TableColumn<Aircraft, String> airlineIdColumn; // String típusú a név miatt!
    @FXML private TableColumn<Aircraft, String> statusColumn;
    @FXML private TableColumn<Aircraft, String> msnColumn;
    @FXML private TableColumn<Aircraft, Short> seatCapacityColumn;
    @FXML private TableColumn<Aircraft, Integer> cargoCapacityColumn;
    @FXML private TableColumn<Aircraft, Long> baseAirportIdColumn;
    @FXML private TableColumn<Aircraft, Short> manufactureYearColumn;

    // Adatkezelés
    private final ObservableList<Aircraft> aircraftList = FXCollections.observableArrayList();
    private FilteredList<Aircraft> filteredAircraft;

    // Szótár: ID -> Név párosítás
    private Map<Long, String> airlineNameMap;

    // Konstruktor
    public AircraftPageController(AircraftService aircraftService, AirlineRepository airlineRepository) {
        this.aircraftService = aircraftService;
        this.airlineRepository = airlineRepository;
    }

    @FXML
    public void initialize() {
        // 1. Nevek betöltése a memóriába (gyorsítótár)
        preloadAirlineNames();

        // 2. Felület beállítása
        setupMenuNavigation();
        setupTable();

        // 3. Adatok betöltése
        loadData();

        // 4. Kereső beállítása
        setupSearch();
    }

    // --- SEGÉDMETÓDUSOK ---

    private void preloadAirlineNames() {
        List<Airline> allAirlines = airlineRepository.findAll();
        // Átalakítjuk Map-re: { 1 -> "WizzAir", 2 -> "Ryanair" }
        // Feltételezzük, hogy az Airline osztályban getId() a metódus neve
        airlineNameMap = allAirlines.stream()
                .collect(Collectors.toMap(Airline::getId, Airline::getName));
    }

    private void setupTable() {
        if (aircraftTable == null) return;

        idColumn.setCellValueFactory(new PropertyValueFactory<>("id"));
        registrationColumn.setCellValueFactory(new PropertyValueFactory<>("registration"));
        typeIcaoColumn.setCellValueFactory(new PropertyValueFactory<>("typeIcao"));

        // LÉGITÁRSASÁG NÉV LOGIKA (Map-ből keresés)
        airlineIdColumn.setCellValueFactory(cellData -> {
            Long airlineId = cellData.getValue().getAirlineId();

            // Ha még nincs betöltve a map, vagy nincs ilyen ID
            if (airlineNameMap == null) return new SimpleStringProperty("-");

            String name = airlineNameMap.getOrDefault(airlineId, "Ismeretlen (" + airlineId + ")");
            return new SimpleStringProperty(name);
        });

        statusColumn.setCellValueFactory(cellData -> {
            var statusEnum = cellData.getValue().getStatus();
            return new SimpleStringProperty(statusEnum != null ? statusEnum.name() : "");
        });

        msnColumn.setCellValueFactory(new PropertyValueFactory<>("msn"));
        seatCapacityColumn.setCellValueFactory(new PropertyValueFactory<>("maxSeatCapacity"));
        cargoCapacityColumn.setCellValueFactory(new PropertyValueFactory<>("cargoCapacityBase"));
        baseAirportIdColumn.setCellValueFactory(new PropertyValueFactory<>("baseAirportId"));
        manufactureYearColumn.setCellValueFactory(new PropertyValueFactory<>("manufactureYear"));
    }

    private void loadData() {
        if (aircraftTable == null) return;
        try {
            List<Aircraft> data = aircraftService.getAllAircraft();
            aircraftList.setAll(data);

            filteredAircraft = new FilteredList<>(aircraftList, p -> true);
            aircraftTable.setItems(filteredAircraft);

            if (statusLabel != null) statusLabel.setText("Repülők betöltve: " + data.size());
        } catch (Exception e) {
            e.printStackTrace();
            if (statusLabel != null) statusLabel.setText("Hiba az adatok lekérésekor!");
        }
    }

    private void setupSearch() {
        if (searchField != null) {
            searchField.textProperty().addListener((obs, oldVal, newVal) -> {
                if (filteredAircraft == null) return;
                String filter = (newVal == null) ? "" : newVal.trim().toLowerCase();

                filteredAircraft.setPredicate(aircraft -> {
                    if (filter.isEmpty()) return true;

                    // Adatok előkészítése a kereséshez
                    String reg = aircraft.getRegistration() != null ? aircraft.getRegistration().toLowerCase() : "";
                    String type = aircraft.getTypeIcao() != null ? aircraft.getTypeIcao().toLowerCase() : "";
                    String msn = aircraft.getMsn() != null ? aircraft.getMsn().toLowerCase() : "";
                    String status = aircraft.getStatus() != null ? aircraft.getStatus().name().toLowerCase() : "";

                    // Légitársaság nevében is keresünk
                    String airlineName = "";
                    if (airlineNameMap != null) {
                        airlineName = airlineNameMap.getOrDefault(aircraft.getAirlineId(), "").toLowerCase();
                    }

                    // Ha bármelyikben benne van a keresett szó
                    return reg.contains(filter) ||
                            type.contains(filter) ||
                            status.contains(filter) ||
                            msn.contains(filter) ||
                            airlineName.contains(filter);
                });

                if (statusLabel != null) statusLabel.setText("Találatok: " + filteredAircraft.size());
            });
        }
    }

    private void setupMenuNavigation() {
        if (menuComboBox != null) {
            menuComboBox.getSelectionModel().select("Repülők");
            menuComboBox.getSelectionModel().selectedItemProperty().addListener((obs, oldVal, newVal) -> {
                if (newVal == null) return;
                switch (newVal) {
                    case "Főoldal" -> SceneManager.switchTo("HomePage.fxml", "ATC – Főoldal", WIDTH, HEIGHT);
                    case "Repülők" -> {} // Már itt vagyunk
                    case "Repterek" -> SceneManager.switchTo("HomePage/AirportsPage.fxml", "ATC – Repterek", WIDTH, HEIGHT);
                    case "Repülőutak" -> SceneManager.switchTo("HomePage/RoutesPage.fxml", "ATC – Repülőutak", WIDTH, HEIGHT);
                    case "Kapuk(Ez inkább a repterekhez menne)" -> SceneManager.switchTo("HomePage/GatesPage.fxml", "ATC – Kapuk", WIDTH, HEIGHT);
                    case "Terminál(Ez is inkább reptér)" -> SceneManager.switchTo("HomePage/TerminalPage.fxml", "ATC – Terminál", WIDTH, HEIGHT);
                }
            });
        }
    }

    @FXML private void onRefresh() {
        preloadAirlineNames(); // Frissítéskor újratöltjük a neveket is, hátha változtak
        loadData();
    }

    @FXML private void onLogout() {
        SceneManager.switchTo("MainPage.fxml", "ATC – Bejelentkezés", 800, 400);
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/HomePage/GatesPageController.java
================================
package com.FourWings.atcSystem.frontend.HomePage;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.airport.AirportsService;
import com.FourWings.atcSystem.model.flight.Flight;
import com.FourWings.atcSystem.model.flight.FlightService;
import com.FourWings.atcSystem.model.gate.Gate;
import com.FourWings.atcSystem.model.gate.GateService;
import com.FourWings.atcSystem.model.gate.GateStatus; // Importálni kell az Enumot!
import javafx.collections.FXCollections;
import javafx.fxml.FXML;
import javafx.geometry.Insets;
import javafx.geometry.Pos;
import javafx.scene.control.Button;
import javafx.scene.control.ComboBox;
import javafx.scene.control.Label;
import javafx.scene.layout.FlowPane;
import javafx.scene.layout.VBox;
import javafx.scene.text.Font;
import javafx.scene.text.FontWeight;
import javafx.util.StringConverter;
import org.springframework.stereotype.Component;

import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

@Component
public class GatesPageController {

    public static final int WIDTH = 1200; //Window szélesség
    public static final int HEIGHT = 600; //Window magasság
    private final AirportsService airportService;
    private final GateService gateService;
    private final FlightService flightService;

    @FXML private ComboBox<String> menuComboBox;
    @FXML private ComboBox<Airports> airportSelector;
    @FXML private FlowPane gatesContainer;
    @FXML private Label statusLabel;

    public GatesPageController(AirportsService airportService, GateService gateService, FlightService flightService) {
        this.airportService = airportService;
        this.gateService = gateService;
        this.flightService = flightService;
    }

    @FXML
    public void initialize() {
        setupMenuNavigation();
        setupAirportSelector();
        loadAirports();
    }

    private void loadGatesForAirport(Airports airport) {
        gatesContainer.getChildren().clear();
        statusLabel.setText("Kapuk betöltése...");

        if (airport == null) return;

        List<Gate> gates = gateService.getGatesForAirport(airport);

        // Fontos: Itt a 'findDeparturesByAirportWithDetails' hívódik meg a háttérben a Service-en keresztül
        List<Flight> departures = flightService.getDeparturesForAirport(airport);

        // Map készítése: Gate ID -> Flight
        Map<Long, Flight> gateFlightMap = departures.stream()
                .filter(f -> f.getGate() != null)
                .collect(Collectors.toMap(
                        f -> f.getGate().getId(), // JAVÍTVA: getId() a Gate entitásból
                        f -> f,
                        (existing, replacement) -> existing
                ));

        for (Gate gate : gates) {
            VBox gateBox = createGateBox(gate, gateFlightMap.get(gate.getId())); // JAVÍTVA: getId()
            gatesContainer.getChildren().add(gateBox);
        }

        statusLabel.setText(airport.getName() + ": " + gates.size() + " kapu megjelenítve.");
    }

    private VBox createGateBox(Gate gate, Flight flight) {
        VBox box = new VBox();
        box.setPrefSize(180, 130);
        box.setPadding(new Insets(10));
        box.setAlignment(Pos.TOP_CENTER);
        box.setSpacing(5);

        // Alap stílus
        String baseStyle = "-fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.2), 5, 0, 0, 2);";

        // Kapu kódja (A1, B2...)
        Label codeLabel = new Label(gate.getCode());
        codeLabel.setFont(Font.font("System", FontWeight.BOLD, 24));

        Label infoLabel = new Label();
        Label detailLabel = new Label();
        detailLabel.setStyle("-fx-text-alignment: center; -fx-font-size: 11px;");

        // 1. ESET: A kapu státusza NEM aktív (pl. Closed, Maintenance)
        // Feltételezve, hogy van GateStatus enum és OPEN az aktív
        if (gate.getStatus() != null && !gate.getStatus().name().equals("OPEN") && !gate.getStatus().name().equals("ACTIVE")) {
            box.setStyle(baseStyle + "-fx-background-color: #cfd8dc;"); // Szürke
            infoLabel.setText(gate.getStatus().name()); // Pl. CLOSED
            infoLabel.setStyle("-fx-text-fill: #546e7a; -fx-font-weight: bold;");
            detailLabel.setText(gate.getNote() != null ? gate.getNote() : "Lezárva");
        }
        // 2. ESET: Van hozzárendelve járat (FOGLALT)
        else if (flight != null) {
            box.setStyle(baseStyle + "-fx-background-color: #ef9a9a;"); // Pirosas
            infoLabel.setText("FOGLALT");
            infoLabel.setStyle("-fx-text-fill: #b71c1c; -fx-font-weight: bold;");

            detailLabel.setText(
                    flight.getFlightNumber() + "\n" +
                            flight.getAirlineName() + "\n" +
                            "Indul: " + flight.getScheduledDepartureText().substring(11) // Csak az óra:perc
            );
        }
        // 3. ESET: Nincs járat, státusz OK (SZABAD)
        else {
            box.setStyle(baseStyle + "-fx-background-color: #a5d6a7;"); // Zöldes
            infoLabel.setText("SZABAD");
            infoLabel.setStyle("-fx-text-fill: #1b5e20; -fx-font-weight: bold;");

            // Ha van a kapunak megjegyzése, kiírjuk (pl. "Csak A320")
            detailLabel.setText(gate.getNote() != null ? gate.getNote() : "-");
        }

        box.getChildren().addAll(codeLabel, infoLabel, detailLabel);
        return box;
    }

    // --- SETUP RÉSZEK (Változatlan) ---
    private void setupAirportSelector() {
        airportSelector.setConverter(new StringConverter<Airports>() {
            @Override
            public String toString(Airports airport) {
                return (airport == null) ? "" : airport.getIcaoCode() + " - " + airport.getName();
            }
            @Override
            public Airports fromString(String string) { return null; }
        });

        airportSelector.getSelectionModel().selectedItemProperty().addListener((obs, oldVal, newVal) -> {
            loadGatesForAirport(newVal);
        });
    }

    private void loadAirports() {
        try {
            airportSelector.setItems(FXCollections.observableArrayList(airportService.getAllAirports()));
        } catch (Exception e) {
            statusLabel.setText("Hiba a repterek betöltésekor!");
        }
    }

    @FXML
    private void onRefresh() {
        loadGatesForAirport(airportSelector.getSelectionModel().getSelectedItem());
    }

    @FXML
    private void onLogout() {
        SceneManager.switchTo("MainPage.fxml", "ATC – Bejelentkezés", 800, 400);
    }

    private void setupMenuNavigation() {
        if (menuComboBox == null) return;
        menuComboBox.setValue("Kapuk(Ez inkább a repterekhez menne)");
        menuComboBox.getSelectionModel().selectedItemProperty().addListener((obs, oldVal, newVal) -> {
            if (newVal == null) return;
            switch (newVal) {
                case "Főoldal" -> SceneManager.switchTo("HomePage.fxml", "ATC – Főoldal", WIDTH, HEIGHT);
                case "Repülők" -> SceneManager.switchTo("HomePage/PlanesPage.fxml", "ATC – Repülők", WIDTH, HEIGHT);
                case "Repterek" -> SceneManager.switchTo("HomePage/AirportsPage.fxml", "ATC – Repterek", WIDTH, HEIGHT);
                case "Repülőutak" -> SceneManager.switchTo("HomePage/RoutesPage.fxml", "ATC – Útvonalak", WIDTH, HEIGHT);
                case "Terminál(Ez is inkább reptér)" -> SceneManager.switchTo("HomePage/TerminalPage.fxml", "ATC – Terminál", WIDTH, HEIGHT);
            }
        });
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/HomePage/AirportsPageController.java
================================
package com.FourWings.atcSystem.frontend.HomePage;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.airport.AirportsService;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.collections.transformation.FilteredList;
import javafx.fxml.FXML;
import javafx.scene.control.*;
import javafx.scene.control.cell.PropertyValueFactory;
import org.springframework.stereotype.Component;

import java.util.List;

@Component
public class AirportsPageController {

    private final AirportsService airportService;
    public static final int WIDTH = 1200; //Window szélesség
    public static final int HEIGHT = 600; //Window magasság
    // Menü
    @FXML
    private ComboBox<String> menuComboBox;

    // Tábla + oszlopok
    @FXML
    private TableView<Airports> airportsTable;

    @FXML
    private TableColumn<Airports, String> icaoCodeColumn;
    @FXML
    private TableColumn<Airports, String> iataCodeColumn;
    @FXML
    private TableColumn<Airports, String> nameColumn;
    @FXML
    private TableColumn<Airports, String> cityColumn;
    @FXML
    private TableColumn<Airports, String> countryColumn;
    @FXML
    private TableColumn<Airports, String> timezoneColumn;

    @FXML
    private TableColumn<Airports, Number> latitudeColumn;
    @FXML
    private TableColumn<Airports, Number> longitudeColumn;
    @FXML
    private TableColumn<Airports, Integer> elevationColumn;

    @FXML
    private TableColumn<Airports, String> addressColumn;
    @FXML
    private TableColumn<Airports, String> postalCodeColumn;
    @FXML
    private TableColumn<Airports, String> websiteUrlColumn;
    @FXML
    private TableColumn<Airports, String> phoneMainColumn;
    @FXML
    private TableColumn<Airports, String> emailMainColumn;

    // Keresés + státusz
    @FXML
    private TextField searchField;

    @FXML
    private Label statusLabel;

    private final ObservableList<Airports> airports = FXCollections.observableArrayList();
    private FilteredList<Airports> filteredAirports;

    public AirportsPageController(AirportsService airportService) {
        this.airportService = airportService;
    }

    @FXML
    public void initialize() {
        setupAirportTable();
        loadAirportData();
        setupSearchFunctionality();
        setupMenuNavigation();
    }

    // ----------------- Menü navigáció -----------------

    private void setupMenuNavigation() {
        if (menuComboBox == null) return;

        // Ha nem FXML-ből töltenéd, itt is lehetne:
        // menuComboBox.getItems().setAll("Főoldal", "Repülők", ... );

        // aktuális oldal kijelölése
        menuComboBox.getSelectionModel().select("Repterek");

        menuComboBox.getSelectionModel().selectedItemProperty().addListener((obs, oldVal, newVal) -> {
            if (newVal == null) return;

            switch (newVal) {
                case "Főoldal" ->
                        SceneManager.switchTo("HomePage.fxml", "ATC – Főoldal", WIDTH, HEIGHT);
                case "Repülők" ->
                            SceneManager.switchTo("HomePage/PlanesPage.fxml", "ATC – Repülők", WIDTH, HEIGHT);
                case "Repterek" ->
                { /* már ezen az oldalon vagyunk */ }
                case "Repülőutak" ->
                        SceneManager.switchTo("HomePage/RoutesPage.fxml", "ATC – Repülőutak", WIDTH, HEIGHT);
                case "Kapuk(Ez inkább a repterekhez menne)" ->
                        SceneManager.switchTo("HomePage/GatesPage.fxml", "ATC – Kapuk", WIDTH, HEIGHT);
                case "Terminál(Ez is inkább reptér)" ->
                        SceneManager.switchTo("HomePage/TerminalPage.fxml", "ATC – Terminál", WIDTH, HEIGHT);
            }
        });
    }

    // ----------------- Táblázat beállítása -----------------

    private void setupAirportTable() {
        if (airportsTable == null) return;

        // Itt a property neveknek a Airports entity mezőneveihez kell passzolniuk:
        // private String icaoCode; private String iataCode; stb.
        icaoCodeColumn.setCellValueFactory(new PropertyValueFactory<>("icaoCode"));
        iataCodeColumn.setCellValueFactory(new PropertyValueFactory<>("iataCode"));
        nameColumn.setCellValueFactory(new PropertyValueFactory<>("name"));
        cityColumn.setCellValueFactory(new PropertyValueFactory<>("city"));
        countryColumn.setCellValueFactory(new PropertyValueFactory<>("country"));
        timezoneColumn.setCellValueFactory(new PropertyValueFactory<>("timezone"));

        latitudeColumn.setCellValueFactory(new PropertyValueFactory<>("latitude"));
        longitudeColumn.setCellValueFactory(new PropertyValueFactory<>("longitude"));
        elevationColumn.setCellValueFactory(new PropertyValueFactory<>("elevation"));

        addressColumn.setCellValueFactory(new PropertyValueFactory<>("address"));
        postalCodeColumn.setCellValueFactory(new PropertyValueFactory<>("postalCode"));
        websiteUrlColumn.setCellValueFactory(new PropertyValueFactory<>("websiteUrl"));
        phoneMainColumn.setCellValueFactory(new PropertyValueFactory<>("phoneMain"));
        emailMainColumn.setCellValueFactory(new PropertyValueFactory<>("emailMain"));
    }

    // ----------------- Adatok betöltése -----------------

    private void loadAirportData() {
        if (airportsTable == null) return;

        try {
            List<Airports> airportList = airportService.getAllAirports();
            airports.setAll(airportList);

            filteredAirports = new FilteredList<>(airports, a -> true);
            airportsTable.setItems(filteredAirports);

            if (statusLabel != null) {
                statusLabel.setText("Repülőterek betöltve: " + airports.size());
            }

        } catch (Exception e) {
            System.err.println("Hiba a repülőtér adatok betöltésekor: " + e.getMessage());
            e.printStackTrace();
            if (statusLabel != null) {
                statusLabel.setText("Hiba a repülőterek betöltésekor.");
            }
        }
    }

    // ----------------- Keresés -----------------

    private void setupSearchFunctionality() {
        if (searchField == null) return;

        searchField.textProperty().addListener((obs, oldVal, newVal) -> {
            if (filteredAirports == null) return;

            String filter = (newVal == null) ? "" : newVal.trim().toLowerCase();

            filteredAirports.setPredicate(airport -> {
                if (filter.isEmpty()) return true;

                String icao = airport.getIcaoCode() != null ? airport.getIcaoCode().toLowerCase() : "";
                String name = airport.getName() != null ? airport.getName().toLowerCase() : "";
                String city = airport.getCity() != null ? airport.getCity().toLowerCase() : "";

                return icao.contains(filter)
                        || name.contains(filter)
                        || city.contains(filter);
            });

            if (statusLabel != null) {
                statusLabel.setText("Találatok: "
                        + filteredAirports.size()
                        + " / Összes: "
                        + airports.size());
            }
        });
    }

    // ----------------- Gombok -----------------

    @FXML
    private void onRefresh() {
        loadAirportData();
    }

    @FXML
    private void onLogout() {
        SceneManager.switchTo("MainPage.fxml", "ATC – Bejelentkezés", 800, 400);
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/HomePage/RoutesPageController.java
================================
package com.FourWings.atcSystem.frontend.HomePage;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.airport.AirportsService;
import com.FourWings.atcSystem.model.flight.Flight;
import com.FourWings.atcSystem.model.flight.FlightService;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.fxml.FXML;
import javafx.scene.control.*;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.util.StringConverter;
import org.springframework.stereotype.Component;

import java.util.List;

@Component
public class RoutesPageController {

    public static final int WIDTH = 1200; //Window szélesség
    public static final int HEIGHT = 600; //Window magasság
    private final AirportsService airportService;
    private final FlightService flightService;

    // --- FXML Elemek ---

    @FXML
    private ComboBox<String> menuComboBox;

    @FXML
    private ComboBox<Airports> airportSelector;

    @FXML
    private Label statusLabel;

    // -- Induló járatok --
    @FXML
    private TableView<Flight> departuresTable;
    @FXML
    private TableColumn<Flight, String> depFlightNumCol;
    @FXML
    private TableColumn<Flight, String> depAirlineCol;
    @FXML
    private TableColumn<Flight, String> depDestinationCol;
    @FXML
    private TableColumn<Flight, String> depTimeCol;
    @FXML
    private TableColumn<Flight, String> depStatusCol;
    @FXML
    private TableColumn<Flight, String> depGateCol;

    // -- Érkező járatok --
    @FXML
    private TableView<Flight> arrivalsTable;
    @FXML
    private TableColumn<Flight, String> arrFlightNumCol;
    @FXML
    private TableColumn<Flight, String> arrAirlineCol;
    @FXML
    private TableColumn<Flight, String> arrOriginCol;
    @FXML
    private TableColumn<Flight, String> arrTimeCol;
    @FXML
    private TableColumn<Flight, String> arrStatusCol;
    @FXML
    private TableColumn<Flight, String> arrGateCol;

    // --- Adatlisták ---
    private final ObservableList<Airports> airportList = FXCollections.observableArrayList();
    private final ObservableList<Flight> departureList = FXCollections.observableArrayList();
    private final ObservableList<Flight> arrivalList = FXCollections.observableArrayList();

    public RoutesPageController(AirportsService airportService, FlightService flightService) {
        this.airportService = airportService;
        this.flightService = flightService;
    }

    @FXML
    public void initialize() {
        setupMenuNavigation();
        setupTables();
        setupAirportSelector();
        loadAirports();
    }

    // ----------------- Táblák beállítása & SZÍNEZÉS -----------------
    private void setupTables() {
        // --- 1. INDULÓK OSZLOPOK ---
        depFlightNumCol.setCellValueFactory(new PropertyValueFactory<>("flightNumber"));
        depAirlineCol.setCellValueFactory(new PropertyValueFactory<>("airlineName"));
        depDestinationCol.setCellValueFactory(new PropertyValueFactory<>("destinationName"));
        depTimeCol.setCellValueFactory(new PropertyValueFactory<>("scheduledDepartureText"));
        depStatusCol.setCellValueFactory(new PropertyValueFactory<>("statusText"));
        depGateCol.setCellValueFactory(new PropertyValueFactory<>("gateCode"));

        departuresTable.setItems(departureList);
        departuresTable.setPlaceholder(new Label("Válassz repteret az induló járatokhoz!"));

        // *** SZÍNEZÉS LOGIKA (Departures) ***
        departuresTable.setRowFactory(tv -> new TableRow<Flight>() {
            @Override
            protected void updateItem(Flight item, boolean empty) {
                super.updateItem(item, empty);
                applyRowColor(this, item, empty);
            }
        });

        // --- 2. ÉRKEZŐK OSZLOPOK ---
        arrFlightNumCol.setCellValueFactory(new PropertyValueFactory<>("flightNumber"));
        arrAirlineCol.setCellValueFactory(new PropertyValueFactory<>("airlineName"));
        arrOriginCol.setCellValueFactory(new PropertyValueFactory<>("originName"));
        arrTimeCol.setCellValueFactory(new PropertyValueFactory<>("scheduledArrivalText"));
        arrStatusCol.setCellValueFactory(new PropertyValueFactory<>("statusText"));
        arrGateCol.setCellValueFactory(new PropertyValueFactory<>("gateCode"));

        arrivalsTable.setItems(arrivalList);
        arrivalsTable.setPlaceholder(new Label("Válassz repteret az érkező járatokhoz!"));

        // *** SZÍNEZÉS LOGIKA (Arrivals) ***
        arrivalsTable.setRowFactory(tv -> new TableRow<Flight>() {
            @Override
            protected void updateItem(Flight item, boolean empty) {
                super.updateItem(item, empty);
                applyRowColor(this, item, empty);
            }
        });
    }

    private void applyRowColor(TableRow<Flight> row, Flight item, boolean empty) {
        if (item == null || empty) {
            row.setStyle("");
        } else {
            String status = "";
            try {
                // Ha van getStatusText metódusod, használd azt közvetlenül!
                // status = item.getStatusText();

                // Reflexió (biztonsági tartalék, ha nem tudom a metódusnevet):
                java.lang.reflect.Method method = item.getClass().getMethod("getStatusText");
                status = (String) method.invoke(item);

            } catch (Exception e) {
                status = "Unknown";
            }

            if (status == null) status = "";

            // Kisbetűssé alakítjuk a könnyebb vizsgálathoz és contains-t használunk,
            // hogy pl. a "Taxiing" és "Taxi" is működjön.
            String s = status.toLowerCase();

            // --- 1. ZÖLD: Landolt / Érkezett ---
            if (s.contains("landed") || s.contains("arrived")) {
                row.setStyle("-fx-background-color: #c8e6c9;");
            }
            // --- 2. KÉK: Levegőben (Airborne) ---
            else if (s.contains("airborne") || s.contains("flying")) {
                row.setStyle("-fx-background-color: #b3e5fc;");
            }
            // --- 3. NARANCS: Gurul (Taxi) ---
            else if (s.contains("taxi")) {
                row.setStyle("-fx-background-color: #ffe0b2;");
            }
            // --- 4. TÜRKIZ: Beszállás (Boarding) ---
            else if (s.contains("boarding") || s.contains("go to gate")) {
                row.setStyle("-fx-background-color: #b2dfdb;");
            }
            // --- 5. SÁRGA: Késik (Delayed) ---
            else if (s.contains("delayed") || s.contains("late")) {
                row.setStyle("-fx-background-color: #fff9c4;");
            }
            // --- 6. PIROS: Törölve (Cancelled) ---
            else if (s.contains("cancelled")) {
                row.setStyle("-fx-background-color: #b00b1e;");
            }
            // --- 7. SZÜRKE: Tervezett (Scheduled) ---
            else if (s.contains("sched")) {
                row.setStyle("-fx-background-color: #1eeafc;");
            }
            // --- EGYÉB (Alapértelmezett) ---
            else {
                row.setStyle("");
            }
        }
    }

    // ----------------- Útvonalak betöltése -----------------
    private void loadRoutesForAirport(Airports airport) {
        if (airport == null) return;

        statusLabel.setText("Útvonalak betöltése: " + airport.getName());

        try {
            List<Flight> deps = flightService.getDeparturesForAirport(airport);
            List<Flight> arrs = flightService.getArrivalsForAirport(airport);

            departureList.setAll(deps);
            arrivalList.setAll(arrs);

            statusLabel.setText(String.format("%s (%s) betöltve: %d induló, %d érkező.",
                    airport.getName(), airport.getIcaoCode(), deps.size(), arrs.size()));

        } catch (Exception e) {
            e.printStackTrace();
            statusLabel.setText("Hiba az útvonalak lekérdezésekor.");
        }
    }

    // ----------------- Reptér választó -----------------
    private void setupAirportSelector() {
        airportSelector.setConverter(new StringConverter<Airports>() {
            @Override
            public String toString(Airports airport) {
                return (airport == null) ? "" : airport.getIcaoCode() + " - " + airport.getName();
            }

            @Override
            public Airports fromString(String string) { return null; }
        });

        airportSelector.getSelectionModel().selectedItemProperty().addListener((obs, oldVal, newVal) -> {
            if (newVal != null) {
                loadRoutesForAirport(newVal);
            }
        });
    }

    private void loadAirports() {
        try {
            List<Airports> allAirports = airportService.getAllAirports();
            airportList.setAll(allAirports);
            airportSelector.setItems(airportList);
        } catch (Exception e) {
            e.printStackTrace();
            statusLabel.setText("Hiba a repterek betöltésekor!");
        }
    }

    // ----------------- Menü navigáció -----------------
    private void setupMenuNavigation() {
        if (menuComboBox == null) return;
        menuComboBox.setValue("Repülőutak");
        menuComboBox.getSelectionModel().selectedItemProperty().addListener((obs, oldVal, newVal) -> {
            if (newVal == null) return;
            switch (newVal) {
                case "Főoldal" -> SceneManager.switchTo("HomePage.fxml", "ATC – Főoldal", WIDTH, HEIGHT);
                case "Repülők" -> SceneManager.switchTo("HomePage/PlanesPage.fxml", "ATC – Repülők", WIDTH, HEIGHT);
                case "Repterek" -> SceneManager.switchTo("HomePage/AirportsPage.fxml", "ATC – Repterek", WIDTH, HEIGHT);
                case "Kapuk(Ez inkább a repterekhez menne)" -> SceneManager.switchTo("HomePage/GatesPage.fxml", "ATC – Kapuk", WIDTH, HEIGHT);
                case "Terminál(Ez is inkább reptér)" -> SceneManager.switchTo("HomePage/TerminalPage.fxml", "ATC – Terminál", WIDTH, HEIGHT);
            }
        });
    }

    @FXML
    private void onRefresh() {
        Airports selected = airportSelector.getSelectionModel().getSelectedItem();
        if (selected != null) loadRoutesForAirport(selected);
        else loadAirports();
    }

    @FXML
    private void onLogout() {
        SceneManager.switchTo("MainPage.fxml", "ATC – Bejelentkezés", 800, 400);
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/FlightWeatherAssistantDialogController.java
================================
// src/main/java/com/FourWings/atcSystem/frontend/FlightWeatherAssistantDialogController.java
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.service.weather.FlightWeatherAdvice;
import com.FourWings.atcSystem.service.weather.FlightWeatherAdvisorService;
import com.FourWings.atcSystem.model.airport.AirportsService;
import javafx.collections.FXCollections;
import javafx.concurrent.Task;
import javafx.fxml.FXML;
import javafx.scene.control.*;
import javafx.stage.Stage;
import org.springframework.stereotype.Component;

import java.util.List;

@Component
public class FlightWeatherAssistantDialogController {

    private final AirportsService airportsService;
    private final FlightWeatherAdvisorService advisorService;

    public FlightWeatherAssistantDialogController(AirportsService airportsService,
                                                  FlightWeatherAdvisorService advisorService) {
        this.airportsService = airportsService;
        this.advisorService = advisorService;
    }

    @FXML private ComboBox<Airports> airportCombo;
    @FXML private Label statusLabel;
    @FXML private TextArea resultArea;
    @FXML private Label errorLabel;

    @FXML
    public void initialize() {
        // Repterek betöltése DB-ből
        List<Airports> airports = airportsService.getAllAirports(); // ha más a metódus neve, írd át
        airportCombo.setItems(FXCollections.observableArrayList(airports));

        // hogyan jelenjen meg a ComboBox-ban
        airportCombo.setCellFactory(listView -> new ListCell<>() {
            @Override
            protected void updateItem(Airports item, boolean empty) {
                super.updateItem(item, empty);
                if (empty || item == null) {
                    setText(null);
                } else {
                    // pl. "LHBP – Budapest" jelleggel
                    setText(item.getCode() + " – " + item.getCity());
                }
            }
        });

        airportCombo.setButtonCell(new ListCell<>() {
            @Override
            protected void updateItem(Airports item, boolean empty) {
                super.updateItem(item, empty);
                if (empty || item == null) {
                    setText(null);
                } else {
                    setText(item.getCode() + " – " + item.getCity());
                }
            }
        });
    }

    @FXML
    private void onAnalyzeWeather() {
        errorLabel.setText("");
        statusLabel.setText("Státusz: ...");
        resultArea.clear();

        Airports selected = airportCombo.getValue();
        if (selected == null) {
            errorLabel.setText("Válassz egy repülőteret.");
            return;
        }

        Task<FlightWeatherAdvice> task = new Task<>() {
            @Override
            protected FlightWeatherAdvice call() throws Exception {
                return advisorService.analyzeForAirport(selected);
            }
        };

        task.setOnSucceeded(e -> {
            FlightWeatherAdvice advice = task.getValue();
            statusLabel.setText("Státusz: " + advice.status());
            resultArea.setText(advice.explanation());

            // opcionális színezés
            switch (advice.status()) {
                case "GO"      -> statusLabel.setStyle("-fx-text-fill: green; -fx-font-weight: bold;");
                case "CAUTION" -> statusLabel.setStyle("-fx-text-fill: orange; -fx-font-weight: bold;");
                case "DELAY"   -> statusLabel.setStyle("-fx-text-fill: red; -fx-font-weight: bold;");
                default        -> statusLabel.setStyle("");
            }
        });

        task.setOnFailed(e -> {
            Throwable ex = task.getException();
            errorLabel.setText("Hiba az elemzés közben: " +
                    (ex != null ? ex.getMessage() : "ismeretlen"));
            ex.printStackTrace();
            statusLabel.setText("Státusz: HIBA");
        });

        new Thread(task, "weather-analyze").start();
    }

    @FXML
    private void onClose() {
        Stage stage = (Stage) statusLabel.getScene().getWindow();
        stage.close();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/HomePageController.java
================================
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.airport.AirportsService;
import com.FourWings.atcSystem.model.flight.Flight;
import com.FourWings.atcSystem.model.flight.FlightService;
import com.FourWings.atcSystem.model.gate.Gate;
import com.FourWings.atcSystem.model.gate.GateService;
import com.FourWings.atcSystem.model.user.User;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.scene.chart.BarChart;
import javafx.scene.chart.PieChart;
import javafx.scene.chart.XYChart;
import javafx.scene.control.Button;
import javafx.scene.control.ComboBox;
import javafx.scene.control.Label;
import javafx.util.StringConverter;
import org.springframework.stereotype.Component;

import java.util.List;
import java.util.Set;
import java.util.stream.Collectors;

@Component
public class HomePageController {

    public static final int WIDTH = 1200; //Window szélesség
    public static final int HEIGHT = 600; //Window magasság
    // --- SERVICE-EK (Adatbázis kapcsolat) ---
    private final AirportsService airportService;
    private final FlightService flightService;
    private final GateService gateService;

    // --- FXML ELEMEK ---
    @FXML private ComboBox<String> menuComboBox;
    @FXML private Button dataButton;
    @FXML private Button logoutButton;

    // --- ÚJ DASHBOARD ELEMEK ---
    @FXML private ComboBox<Airports> airportSelector;
    @FXML private Label totalFlightsLabel;
    @FXML private Label delayedFlightsLabel;
    @FXML private Label freeGatesLabel;
    @FXML private PieChart statusPieChart;
    @FXML private BarChart<String, Number> trafficBarChart;

    // --- FELHASZNÁLÓ ---
    private User loggedUser;

    // Konstruktor a Spring Injection-höz
    public HomePageController(AirportsService airportService, FlightService flightService, GateService gateService) {
        this.airportService = airportService;
        this.flightService = flightService;
        this.gateService = gateService;
    }

    public void initWithUser(User user) {
        this.loggedUser = user;
    }

    @FXML
    public void initialize() {
        setupMenuNavigation();

        setupAirportSelector();
        loadAirports();
    }

    // -----------------------------------------------------------
    // 1. NAVIGÁCIÓ
    // -----------------------------------------------------------
    private void setupMenuNavigation() {
        if (menuComboBox != null) {
            menuComboBox.setValue("Főoldal"); // Alapértelmezett

            menuComboBox.getSelectionModel().selectedItemProperty().addListener((obs, oldVal, newVal) -> {
                if (newVal == null) return;
                System.out.println("Kiválasztott menü: " + newVal);

                switch (newVal) {
                    case "Főoldal":
                        break; // Már itt vagyunk
                    case "Repülők":
                        SceneManager.switchTo("HomePage/PlanesPage.fxml", "ATC – Repülők", WIDTH, HEIGHT);
                        break;
                    case "Repterek":
                        SceneManager.switchTo("HomePage/AirportsPage.fxml", "ATC – Repterek", WIDTH, HEIGHT);
                        break;
                    case "Repülőutak":
                        SceneManager.switchTo("HomePage/RoutesPage.fxml", "ATC – Repülőutak", WIDTH, HEIGHT);
                        break;
                    case "Kapuk(Ez inkább a repterekhez menne)":
                        SceneManager.switchTo("HomePage/GatesPage.fxml", "ATC – Kapuk", WIDTH, HEIGHT);
                        break;
                    case "Terminál(Ez is inkább reptér)":
                        SceneManager.switchTo("HomePage/TerminalPage.fxml", "ATC – Terminál", WIDTH, HEIGHT);
                        break;
                    default:
                        System.out.println("Nincs oldal ehhez: " + newVal);
                }
            });
        }
    }

    @FXML
    private void onLogout() {
        SceneManager.switchTo("MainPage.fxml", "ATC – Bejelentkezés", 800, 400);
    }

    @FXML
    public void onGoToPersonalData(ActionEvent event) {
        UserDataPageController ctrl = SceneManager.switchTo("UserDataPage.fxml", "ATC – Saját adatok", WIDTH, HEIGHT);
        if (ctrl != null) {
            ctrl.initWithUser(loggedUser);
        }
    }

    // -----------------------------------------------------------
    // 2. DASHBOARD LOGIKA (ÚJ)
    // -----------------------------------------------------------
    private void updateDashboard(Airports airport) {
        if (airport == null) return;

        // Adatok lekérése
        List<Flight> departures = flightService.getDeparturesForAirport(airport);
        List<Flight> arrivals = flightService.getArrivalsForAirport(airport);
        List<Gate> gates = gateService.getGatesForAirport(airport);

        List<Flight> allFlights = new java.util.ArrayList<>();
        allFlights.addAll(departures);
        allFlights.addAll(arrivals);

        // --- KPI KÁRTYÁK ---
        totalFlightsLabel.setText(String.valueOf(allFlights.size()));

        long delayedCount = allFlights.stream()
                .filter(f -> isStatus(f, "DELAYED"))
                .count();
        delayedFlightsLabel.setText(String.valueOf(delayedCount));

        Set<Long> occupiedGateIds = allFlights.stream()
                // Szűrjük azokat a járatokat, amelyekhez van rendelve kapu
                .filter(f -> f.getGate() != null)
                // Map-eljük a járatokat a hozzájuk rendelt kapu ID-ra
                .map(f -> f.getGate().getId())
                .collect(Collectors.toSet());

        long freeGates = gates.stream()
                // a) Státusz szerint csak az operációs kapukat hagyjuk bent (OPEN, FREE, ACTIVE)
                .filter(g -> g.getStatus() != null &&
                        (g.getStatus().name().equals("OPEN") ||
                                g.getStatus().name().equals("FREE") ||
                                g.getStatus().name().equals("ACTIVE")))
                // b) Kizárjuk azokat a kapukat, amelyek ID-je szerepel a foglalt ID-k listájában
                .filter(g -> !occupiedGateIds.contains(g.getId()))
                .count();

        freeGatesLabel.setText(String.valueOf(freeGates));
        freeGatesLabel.setText(String.valueOf(freeGates));

        // --- KÖRDIAGRAM ---
        long landed = allFlights.stream().filter(f -> isStatus(f, "LANDED", "ARRIVED")).count();
        long active = allFlights.stream().filter(f -> isStatus(f, "AIRBORNE", "TAXING", "BOARDING", "DEPARTED")).count();
        long cancelled = allFlights.stream().filter(f -> isStatus(f, "CANCELLED")).count();

        ObservableList<PieChart.Data> pieData = FXCollections.observableArrayList(
                new PieChart.Data("Landolt (" + landed + ")", landed),
                new PieChart.Data("Aktív (" + active + ")", active),
                new PieChart.Data("Késik (" + delayedCount + ")", delayedCount),
                new PieChart.Data("Törölve (" + cancelled + ")", cancelled)
        );
        statusPieChart.setData(pieData);
        statusPieChart.setTitle("Mai státuszok");

        // --- OSZLOPDIAGRAM ---
        trafficBarChart.getData().clear();
        XYChart.Series<String, Number> series = new XYChart.Series<>();
        series.setName("Járatszám");
        series.getData().add(new XYChart.Data<>("Induló", departures.size()));
        series.getData().add(new XYChart.Data<>("Érkező", arrivals.size()));
        trafficBarChart.getData().add(series);
    }

    private boolean isStatus(Flight f, String... searchStrings) {
        if (f.getStatus() == null) return false;
        String s = f.getStatus().name().toUpperCase();
        for (String search : searchStrings) {
            if (s.contains(search)) return true;
        }
        return false;
    }

    private void setupAirportSelector() {
        airportSelector.setConverter(new StringConverter<Airports>() {
            @Override
            public String toString(Airports airport) {
                return (airport == null) ? "" : airport.getIcaoCode() + " - " + airport.getName();
            }
            @Override
            public Airports fromString(String string) { return null; }
        });

        airportSelector.getSelectionModel().selectedItemProperty().addListener((obs, oldVal, newVal) -> {
            updateDashboard(newVal);
        });
    }

    private void loadAirports() {
        try {
            airportSelector.setItems(FXCollections.observableArrayList(airportService.getAllAirports()));
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @FXML
    private void onRefresh() {
        updateDashboard(airportSelector.getSelectionModel().getSelectedItem());
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/controller/DeparturesDialogController.java
================================
package com.FourWings.atcSystem.frontend.controller;

import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.flight.Flight;
import com.FourWings.atcSystem.model.flight.FlightService;
import javafx.animation.Animation;
import javafx.animation.KeyFrame;
import javafx.animation.Timeline;
import javafx.application.Platform;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.collections.transformation.FilteredList;
import javafx.fxml.FXML;
import javafx.scene.control.*;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.layout.Region;
import javafx.stage.Stage;
import javafx.util.Duration;
import org.springframework.stereotype.Component;

import java.util.List;

@Component
public class DeparturesDialogController {

    private final FlightService flightService;

    private Airports currentAirport;
    private ObservableList<Flight> masterData;
    private FilteredList<Flight> filteredData;
    private Timeline refreshTimeline;

    @FXML private Label titleLabel;
    @FXML private Label subtitleLabel;
    @FXML private Label statusLabel;

    @FXML private TableView<Flight> flightsTable;
    @FXML private TableColumn<Flight, String> flightNumberColumn;
    @FXML private TableColumn<Flight, String> airlineColumn;
    @FXML private TableColumn<Flight, String> destinationColumn;
    @FXML private TableColumn<Flight, String> schedDepColumn;
    @FXML private TableColumn<Flight, String> estDepColumn;
    @FXML private TableColumn<Flight, String> gateColumn;
    @FXML private TableColumn<Flight, String> statusColumn;

    @FXML private TextField searchField;
    @FXML private ComboBox<String> statusFilterBox;

    @FXML private Label selectedFlightLabel;

    // Repülőgép adatok
    @FXML private Label aircraftRegLabel;
    @FXML private Label aircraftTypeLabel;
    @FXML private Label aircraftSeatsLabel;
    @FXML private Label aircraftYearLabel;
    @FXML private Label aircraftStatusLabel;

    public DeparturesDialogController(FlightService flightService) {
        this.flightService = flightService;
    }

    @FXML
    private void initialize() {
        if (flightsTable != null) {
            flightNumberColumn.setCellValueFactory(new PropertyValueFactory<>("flightNumber"));
            airlineColumn.setCellValueFactory(new PropertyValueFactory<>("airlineName"));
            destinationColumn.setCellValueFactory(new PropertyValueFactory<>("destinationName"));
            schedDepColumn.setCellValueFactory(new PropertyValueFactory<>("scheduledDepartureText"));
            estDepColumn.setCellValueFactory(new PropertyValueFactory<>("estimatedDepartureText"));
            gateColumn.setCellValueFactory(new PropertyValueFactory<>("gateCode"));
            statusColumn.setCellValueFactory(new PropertyValueFactory<>("statusText"));

            masterData = FXCollections.observableArrayList();
            filteredData = new FilteredList<>(masterData, f -> true);
            flightsTable.setItems(filteredData);

            flightsTable.setRowFactory(tv -> {
                TableRow<Flight> row = new TableRow<>() {
                    @Override
                    protected void updateItem(Flight item, boolean empty) {
                        super.updateItem(item, empty);
                        if (empty || item == null) {
                            setStyle("");
                        } else {
                            String st = item.getStatusText() != null
                                    ? item.getStatusText().toLowerCase()
                                    : "";
                            if (st.contains("kés") || st.contains("delay")) {
                                setStyle("-fx-background-color: rgba(255,215,0,0.3);");
                            } else if (st.contains("töröl") || st.contains("cancel")) {
                                setStyle("-fx-background-color: rgba(255,0,0,0.2);");
                            } else {
                                setStyle("");
                            }
                        }
                    }
                };

                row.setOnMouseClicked(event -> {
                    if (event.getClickCount() == 2 && !row.isEmpty()) {
                        openFlightDetails(row.getItem());
                    }
                });

                return row;
            });

            flightsTable.getSelectionModel().selectedItemProperty().addListener(
                    (obs, oldSel, newSel) -> updateSelectedFlightDetails(newSel)
            );
        }

        if (statusFilterBox != null) {
            statusFilterBox.setItems(FXCollections.observableArrayList(
                    "Mind", "Időben", "Késik", "Törölve"
            ));
            statusFilterBox.getSelectionModel().selectFirst();
            statusFilterBox.valueProperty().addListener((obs, o, n) -> applyFilters());
        }

        if (searchField != null) {
            searchField.textProperty().addListener((obs, o, n) -> applyFilters());
        }

        updateSelectedFlightDetails(null);
    }

    public void init(Airports airport, List<Flight> departures) {
        this.currentAirport = airport;

        String icao = airport.getIcaoCode() != null ? airport.getIcaoCode() : "";
        String name = airport.getName() != null ? airport.getName() : "";

        titleLabel.setText("Induló járatok – " + icao);
        subtitleLabel.setText("Reptér: " + icao + " – " + name);

        masterData.setAll(departures);
        statusLabel.setText("Találatok: " + departures.size());

        if (refreshTimeline != null) {
            refreshTimeline.stop();
        }
        refreshTimeline = new Timeline(
                new KeyFrame(Duration.seconds(30), e -> refreshData())
        );
        refreshTimeline.setCycleCount(Animation.INDEFINITE);
        refreshTimeline.play();
    }

    private void refreshData() {
        if (currentAirport == null) return;

        Platform.runLater(() -> {
            List<Flight> fresh = flightService.getDeparturesForAirport(currentAirport);
            masterData.setAll(fresh);
            statusLabel.setText("Találatok: " + fresh.size());
            applyFilters();
        });
    }

    private void applyFilters() {
        if (filteredData == null) return;

        String text = searchField != null && searchField.getText() != null
                ? searchField.getText().trim().toLowerCase()
                : "";

        String statusFilter = statusFilterBox != null && statusFilterBox.getValue() != null
                ? statusFilterBox.getValue()
                : "Mind";

        filteredData.setPredicate(f -> {
            boolean matchText;
            if (text.isEmpty()) {
                matchText = true;
            } else {
                String flightNum = f.getFlightNumber() != null ? f.getFlightNumber().toLowerCase() : "";
                String airline = f.getAirlineName() != null ? f.getAirlineName().toLowerCase() : "";
                String origin = f.getOriginName() != null ? f.getOriginName().toLowerCase() : "";
                String dest = f.getDestinationName() != null ? f.getDestinationName().toLowerCase() : "";

                matchText = flightNum.contains(text)
                        || airline.contains(text)
                        || origin.contains(text)
                        || dest.contains(text);
            }

            boolean matchStatus;
            String st = f.getStatusText() != null ? f.getStatusText() : "";
            if ("Mind".equalsIgnoreCase(statusFilter)) {
                matchStatus = true;
            } else if ("Időben".equalsIgnoreCase(statusFilter)) {
                matchStatus = st.equalsIgnoreCase("ON_TIME") || st.equalsIgnoreCase("SCHEDULED");
            } else if ("Késik".equalsIgnoreCase(statusFilter)) {
                matchStatus = st.toLowerCase().contains("delay");
            } else if ("Törölve".equalsIgnoreCase(statusFilter)) {
                matchStatus = st.toLowerCase().contains("cancel");
            } else {
                matchStatus = true;
            }

            return matchText && matchStatus;
        });
    }

    private void updateSelectedFlightDetails(Flight f) {
        if (f == null) {
            selectedFlightLabel.setText("–");
            aircraftRegLabel.setText("–");
            aircraftTypeLabel.setText("–");
            aircraftSeatsLabel.setText("–");
            aircraftYearLabel.setText("–");
            aircraftStatusLabel.setText("–");
            return;
        }

        String origin = f.getOriginName() != null ? f.getOriginName() : "";
        String dest = f.getDestinationName() != null ? f.getDestinationName() : "";
        String airline = f.getAirlineName() != null ? f.getAirlineName() : "";
        String status = f.getStatusText() != null ? f.getStatusText() : "";

        selectedFlightLabel.setText(
                String.format("%s | %s → %s | %s | %s",
                        f.getFlightNumber() != null ? f.getFlightNumber() : "",
                        origin,
                        dest,
                        airline,
                        status
                )
        );

        aircraftRegLabel.setText(
                f.getAircraftRegistration() != null && !f.getAircraftRegistration().isBlank()
                        ? f.getAircraftRegistration()
                        : "–"
        );
        aircraftTypeLabel.setText(
                f.getAircraftTypeIcao() != null && !f.getAircraftTypeIcao().isBlank()
                        ? f.getAircraftTypeIcao()
                        : "–"
        );
        aircraftSeatsLabel.setText(
                f.getAircraftMaxSeatCapacity() != null
                        ? f.getAircraftMaxSeatCapacity().toString()
                        : "–"
        );
        aircraftYearLabel.setText(
                f.getAircraftManufactureYear() != null
                        ? f.getAircraftManufactureYear().toString()
                        : "–"
        );
        aircraftStatusLabel.setText(
                f.getAircraftStatusText() != null && !f.getAircraftStatusText().isBlank()
                        ? f.getAircraftStatusText()
                        : "–"
        );
    }

    private void openFlightDetails(Flight flight) {
        updateSelectedFlightDetails(flight);
    }

    @FXML
    private void onClose() {
        if (refreshTimeline != null) {
            refreshTimeline.stop();
        }
        Stage stage = (Stage) flightsTable.getScene().getWindow();
        stage.close();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/controller/ControllerHomePageController.java
================================
package com.FourWings.atcSystem.frontend.controller;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.config.SpringContext;
import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.flight.Flight;
import com.FourWings.atcSystem.model.flight.FlightService;
import com.FourWings.atcSystem.model.user.User;
import com.FourWings.atcSystem.model.user.UserRole;
import com.FourWings.atcSystem.service.dto.AirportWeatherInfo;
import com.FourWings.atcSystem.service.WeatherService;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.control.Alert;
import javafx.scene.control.Label;
import javafx.stage.Modality;
import javafx.stage.Stage;
import org.springframework.stereotype.Component;

import java.util.List;

@Component
public class ControllerHomePageController {

    private final WeatherService weatherService;
    private final FlightService flightService;

    private User loggedUser;
    private Airports assignedAirport;

    public ControllerHomePageController(WeatherService weatherService,
                                        FlightService flightService) {
        this.weatherService = weatherService;
        this.flightService = flightService;
    }

    // --- FXML elemek ---

    @FXML private Label greetingLabel;
    @FXML private Label airportTitleLabel;
    @FXML private Label subtitleLabel;

    @FXML private Label airportBasicLabel;

    @FXML private Label weatherEmojiLabel;
    @FXML private Label temperatureLabel;
    @FXML private Label conditionLabel;
    @FXML private Label windLabel;
    @FXML private Label visibilityLabel;
    @FXML private Label pressureLabel;
    @FXML private Label feelsLikeLabel;
    @FXML private Label updatedAtLabel;
    @FXML private Label metarLabel;

    @FXML private Label statusLabel;

    @FXML
    public void initialize() {
        if (statusLabel != null) {
            statusLabel.setText("Várakozás a felhasználói adatokra…");
        }
    }

    /**
     * Ezt hívja a login után a router:
     *
     * Controller felhasználó:
     * SceneManager.switchTo("Controller/ControllerHomePage.fxml", ...)
     *  → ctrl.initWithUser(loggedUser);
     */
    public void initWithUser(User user) {
        this.loggedUser = user;

        if (user == null) {
            showError("Nincs betöltött felhasználó.",
                    "A vezérlő oldal megnyitásához be kell jelentkezni.");
            return;
        }

        if (user.getRole() != UserRole.CONTROLLER) {
            showError("Jogosultsági hiba",
                    "Ez az oldal csak 'CONTROLLER' felhasználók számára érhető el.");
            return;
        }

        this.assignedAirport = user.getAssignedAirport();
        if (assignedAirport == null) {
            showError("Nincs hozzárendelt repülőtér",
                    "A controller felhasználóhoz nincs repülőtér rendelve.");
            return;
        }

        // Üdvözlés
        String name = user.getName() != null ? user.getName() : user.getUsername();
        greetingLabel.setText("Szia, " + name + "!");
        airportTitleLabel.setText("Otthoni repülőtér: " +
                safe(assignedAirport.getIcaoCode()) + " – " +
                safe(assignedAirport.getName()));
        subtitleLabel.setText("Az aktuális időjárás és a járatok áttekintése a " +
                safe(assignedAirport.getName()) + " repülőtérre.");

        String city = safe(assignedAirport.getCity());
        airportBasicLabel.setText(
                safe(assignedAirport.getIcaoCode()) + " – " +
                        safe(assignedAirport.getName()) +
                        (city.isBlank() ? "" : " (" + city + ")")
        );

        refreshWeather();
    }

    private String safe(String s) {
        return s != null ? s : "";
    }

    // ---------------- IDŐJÁRÁS BETÖLTÉSE ----------------

    private void refreshWeather() {
        if (assignedAirport == null) return;

        try {
            AirportWeatherInfo info = weatherService.getCurrentWeatherForAirport(assignedAirport);

            if (info == null) {
                statusLabel.setText("Nem sikerült időjárási adatokat lekérni.");
                return;
            }

            weatherEmojiLabel.setText(info.emoji());
            temperatureLabel.setText(String.format("%.0f°C", info.temperatureC()));
            conditionLabel.setText(info.conditionText());

            windLabel.setText(info.windText());            // pl. "230° / 14 kt"
            visibilityLabel.setText(info.visibilityText()); // pl. "9999 m"
            pressureLabel.setText(info.pressureText());     // pl. "1015 hPa"
            feelsLikeLabel.setText(info.feelsLikeText());   // pl. "+19°C / +13°C"
            updatedAtLabel.setText(info.updatedAtText());   // "2025-12-05 11:42 UTC"
            metarLabel.setText(info.metarRaw());

            statusLabel.setText("Időjárás frissítve.");

        } catch (Exception ex) {
            ex.printStackTrace();
            statusLabel.setText("Hiba az időjárás lekérésekor: " + ex.getMessage());
        }
    }

    // ---------------- GOMBOK ----------------

    /**
     * ✈️ Időjárás asszisztens megnyitása – modális dialógusban
     */
    @FXML
    private void onOpenWeatherAssistant() {
        try {
            FXMLLoader loader = new FXMLLoader(
                    getClass().getResource("/fxml/FlightWeatherAssistantDialog.fxml")
            );
            loader.setControllerFactory(SpringContext::getBean);
            Parent root = loader.load();

            Stage dialog = new Stage();
            dialog.initOwner(statusLabel.getScene().getWindow());
            dialog.initModality(Modality.WINDOW_MODAL);
            dialog.setTitle("ATC – Időjárás asszisztens");
            dialog.setScene(new Scene(root, 600, 420));
            dialog.centerOnScreen();
            dialog.showAndWait();

        } catch (Exception ex) {
            ex.printStackTrace();
            showError("Hiba",
                    "Nem sikerült megnyitni az időjárás asszisztenst: " + ex.getMessage());
        }
    }

    @FXML
    private void onShowDepartures() {
        if (!checkReady()) return;

        try {
            List<Flight> departures = flightService.getDeparturesForAirport(assignedAirport);

            FXMLLoader loader = new FXMLLoader(
                    getClass().getResource("/fxml/Controller/DeparturesDialog.fxml"));
            loader.setControllerFactory(SpringContext::getBean);
            Parent root = loader.load();

            DeparturesDialogController ctrl = loader.getController();
            ctrl.init(assignedAirport, departures);

            Stage dialog = new Stage();
            dialog.initOwner(statusLabel.getScene().getWindow());
            dialog.initModality(Modality.WINDOW_MODAL);
            dialog.setTitle("Induló járatok – " + safe(assignedAirport.getIcaoCode()));
            dialog.setScene(new Scene(root, 900, 500));
            dialog.centerOnScreen();
            dialog.showAndWait();

        } catch (Exception ex) {
            ex.printStackTrace();
            showError("Hiba", "Nem sikerült megnyitni az induló járatok ablakot: " + ex.getMessage());
        }
    }

    @FXML
    private void onShowArrivals() {
        if (!checkReady()) return;

        try {
            List<Flight> arrivals = flightService.getArrivalsForAirport(assignedAirport);

            FXMLLoader loader = new FXMLLoader(
                    getClass().getResource("/fxml/Controller/ArrivalsDialog.fxml"));
            loader.setControllerFactory(SpringContext::getBean);
            Parent root = loader.load();

            ArrivalsDialogController ctrl = loader.getController();
            ctrl.init(assignedAirport, arrivals);

            Stage dialog = new Stage();
            dialog.initOwner(statusLabel.getScene().getWindow());
            dialog.initModality(Modality.WINDOW_MODAL);
            dialog.setTitle("Érkező járatok – " + safe(assignedAirport.getIcaoCode()));
            dialog.setScene(new Scene(root, 900, 500));
            dialog.centerOnScreen();
            dialog.showAndWait();

        } catch (Exception ex) {
            ex.printStackTrace();
            showError("Hiba", "Nem sikerült megnyitni az érkező járatok ablakot: " + ex.getMessage());
        }
    }

    @FXML
    private void onLogout() {
        SceneManager.switchTo("MainPage.fxml", "ATC – Bejelentkezés", 800, 400);
    }

    private boolean checkReady() {
        if (loggedUser == null || assignedAirport == null) {
            showError("Nem elérhető", "Nincs bejelentkezett controller vagy hozzárendelt repülőtér.");
            return false;
        }
        return true;
    }

    private void showError(String header, String content) {
        Alert a = new Alert(Alert.AlertType.ERROR);
        a.setTitle("Hiba");
        a.setHeaderText(header);
        a.setContentText(content);
        a.showAndWait();
        if (statusLabel != null) {
            statusLabel.setText(header + " – " + content);
        }
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/controller/ArrivalsDialogController.java
================================
package com.FourWings.atcSystem.frontend.controller;

import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.flight.Flight;
import com.FourWings.atcSystem.model.flight.FlightService;
import javafx.animation.Animation;
import javafx.animation.KeyFrame;
import javafx.animation.Timeline;
import javafx.application.Platform;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.collections.transformation.FilteredList;
import javafx.fxml.FXML;
import javafx.scene.control.*;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.layout.Region;
import javafx.stage.Stage;
import javafx.util.Duration;
import org.springframework.stereotype.Component;

import java.util.List;

@Component
public class ArrivalsDialogController {

    // --- Spring service ---
    private final FlightService flightService;

    // --- Állapot ---
    private Airports currentAirport;
    private ObservableList<Flight> masterData;
    private FilteredList<Flight> filteredData;
    private Timeline refreshTimeline;

    // --- FXML mezők ---

    @FXML private Label titleLabel;
    @FXML private Label subtitleLabel;
    @FXML private Label statusLabel;

    @FXML private TableView<Flight> flightsTable;
    @FXML private TableColumn<Flight, String> flightNumberColumn;
    @FXML private TableColumn<Flight, String> airlineColumn;
    @FXML private TableColumn<Flight, String> originColumn;
    @FXML private TableColumn<Flight, String> schedArrColumn;
    @FXML private TableColumn<Flight, String> estArrColumn;
    @FXML private TableColumn<Flight, String> gateColumn;
    @FXML private TableColumn<Flight, String> statusColumn;

    @FXML private TextField searchField;
    @FXML private ComboBox<String> statusFilterBox;

    @FXML private Label selectedFlightLabel;

    // Repülőgép adatok
    @FXML private Label aircraftRegLabel;
    @FXML private Label aircraftTypeLabel;
    @FXML private Label aircraftSeatsLabel;
    @FXML private Label aircraftYearLabel;
    @FXML private Label aircraftStatusLabel;

    public ArrivalsDialogController(FlightService flightService) {
        this.flightService = flightService;
    }

    // ---------------------------------------------------
    // INITIALIZE
    // ---------------------------------------------------
    @FXML
    private void initialize() {
        // Táblázat oszlopainak bindolása a transiens mezőkhöz
        if (flightsTable != null) {
            flightNumberColumn.setCellValueFactory(new PropertyValueFactory<>("flightNumber"));
            airlineColumn.setCellValueFactory(new PropertyValueFactory<>("airlineName"));
            originColumn.setCellValueFactory(new PropertyValueFactory<>("originName"));
            schedArrColumn.setCellValueFactory(new PropertyValueFactory<>("scheduledArrivalText"));
            estArrColumn.setCellValueFactory(new PropertyValueFactory<>("estimatedArrivalText"));
            gateColumn.setCellValueFactory(new PropertyValueFactory<>("gateCode"));
            statusColumn.setCellValueFactory(new PropertyValueFactory<>("statusText"));

            masterData = FXCollections.observableArrayList();
            filteredData = new FilteredList<>(masterData, f -> true);
            flightsTable.setItems(filteredData);

            // Sor-színezés + dupla kattintás
            flightsTable.setRowFactory(tv -> {
                TableRow<Flight> row = new TableRow<>() {
                    @Override
                    protected void updateItem(Flight item, boolean empty) {
                        super.updateItem(item, empty);
                        if (empty || item == null) {
                            setStyle("");
                        } else {
                            String st = item.getStatusText() != null
                                    ? item.getStatusText().toLowerCase()
                                    : "";
                            if (st.contains("kés") || st.contains("DELAY")) {
                                setStyle("-fx-background-color: rgba(255,215,0,0.3);");
                            } else if (st.contains("töröl") || st.contains("CANCEL")) {
                                setStyle("-fx-background-color: rgba(255,0,0,0.2);");
                            } else {
                                setStyle("");
                            }
                        }
                    }
                };

                row.setOnMouseClicked(event -> {
                    if (event.getClickCount() == 2 && !row.isEmpty()) {
                        Flight selected = row.getItem();
                        openFlightDetails(selected);
                    }
                });

                return row;
            });

            // Kijelölt sor infósáv + repülőgép adatok
            flightsTable.getSelectionModel().selectedItemProperty().addListener(
                    (obs, oldSel, newSel) -> updateSelectedFlightDetails(newSel)
            );
        }

        // Státusz filter combobox feltöltése
        if (statusFilterBox != null) {
            statusFilterBox.setItems(FXCollections.observableArrayList(
                    "Mind", "Időben", "Késik", "Törölve"
            ));
            statusFilterBox.getSelectionModel().selectFirst();
            statusFilterBox.valueProperty().addListener((obs, o, n) -> applyFilters());
        }

        // Kereső mező
        if (searchField != null) {
            searchField.textProperty().addListener((obs, o, n) -> applyFilters());
        }

        // Kezdeti kijelölt sor info kiürítése
        updateSelectedFlightDetails(null);
    }

    // ---------------------------------------------------
    // INIT – kívülről hívva (HomePage controllerből)
    // ---------------------------------------------------
    public void init(Airports airport, List<Flight> arrivals) {
        this.currentAirport = airport;

        String icao = airport.getIcaoCode() != null ? airport.getIcaoCode() : "";
        String name = airport.getName() != null ? airport.getName() : "";

        titleLabel.setText("Érkező járatok – " + icao);
        subtitleLabel.setText("Reptér: " + icao + " – " + name);

        masterData.setAll(arrivals);
        statusLabel.setText("Találatok: " + arrivals.size());

        // Auto-refresh elindítása (30 mp-enként)
        if (refreshTimeline != null) {
            refreshTimeline.stop();
        }
        refreshTimeline = new Timeline(
                new KeyFrame(Duration.seconds(30), e -> refreshData())
        );
        refreshTimeline.setCycleCount(Animation.INDEFINITE);
        refreshTimeline.play();
    }

    // ---------------------------------------------------
    // Auto-refresh
    // ---------------------------------------------------
    private void refreshData() {
        if (currentAirport == null) {
            return;
        }

        // Biztosan JavaFX thread-en történjen az UI frissítés
        Platform.runLater(() -> {
            List<Flight> fresh = flightService.getArrivalsForAirport(currentAirport);
            masterData.setAll(fresh);
            statusLabel.setText("Találatok: " + fresh.size());
            applyFilters();
        });
    }

    // ---------------------------------------------------
    // Szűrés – kereső + státusz
    // ---------------------------------------------------
    private void applyFilters() {
        if (filteredData == null) return;

        String text = searchField != null && searchField.getText() != null
                ? searchField.getText().trim().toLowerCase()
                : "";

        String statusFilter = statusFilterBox != null && statusFilterBox.getValue() != null
                ? statusFilterBox.getValue()
                : "Mind";

        filteredData.setPredicate(f -> {
            // Szövegszűrés
            boolean matchText;
            if (text.isEmpty()) {
                matchText = true;
            } else {
                String flightNum = f.getFlightNumber() != null ? f.getFlightNumber().toLowerCase() : "";
                String airline = f.getAirlineName() != null ? f.getAirlineName().toLowerCase() : "";
                String origin = f.getOriginName() != null ? f.getOriginName().toLowerCase() : "";
                String dest = f.getDestinationName() != null ? f.getDestinationName().toLowerCase() : "";

                matchText = flightNum.contains(text)
                        || airline.contains(text)
                        || origin.contains(text)
                        || dest.contains(text);
            }

            // Státusz szűrés
            boolean matchStatus;
            String st = f.getStatusText() != null ? f.getStatusText() : "";
            if ("Mind".equalsIgnoreCase(statusFilter)) {
                matchStatus = true;
            } else if ("Időben".equalsIgnoreCase(statusFilter)) {
                // egyszerű példa – testreszabhatod
                matchStatus = st.equalsIgnoreCase("ON_TIME") || st.equalsIgnoreCase("SCHEDULED");
            } else if ("Késik".equalsIgnoreCase(statusFilter)) {
                matchStatus = st.toLowerCase().contains("delay");
            } else if ("Törölve".equalsIgnoreCase(statusFilter)) {
                matchStatus = st.toLowerCase().contains("cancel");
            } else {
                matchStatus = true;
            }

            return matchText && matchStatus;
        });
    }

    // ---------------------------------------------------
    // Kijelölt járat részletei + repülőgép adatok
    // ---------------------------------------------------
    private void updateSelectedFlightDetails(Flight f) {
        if (f == null) {
            selectedFlightLabel.setText("–");
            aircraftRegLabel.setText("–");
            aircraftTypeLabel.setText("–");
            aircraftSeatsLabel.setText("–");
            aircraftYearLabel.setText("–");
            aircraftStatusLabel.setText("–");
            return;
        }

        String origin = f.getOriginName() != null ? f.getOriginName() : "";
        String dest = f.getDestinationName() != null ? f.getDestinationName() : "";
        String airline = f.getAirlineName() != null ? f.getAirlineName() : "";
        String status = f.getStatusText() != null ? f.getStatusText() : "";

        selectedFlightLabel.setText(
                String.format("%s | %s → %s | %s | %s",
                        f.getFlightNumber() != null ? f.getFlightNumber() : "",
                        origin,
                        dest,
                        airline,
                        status
                )
        );

        aircraftRegLabel.setText(
                f.getAircraftRegistration() != null && !f.getAircraftRegistration().isBlank()
                        ? f.getAircraftRegistration()
                        : "–"
        );
        aircraftTypeLabel.setText(
                f.getAircraftTypeIcao() != null && !f.getAircraftTypeIcao().isBlank()
                        ? f.getAircraftTypeIcao()
                        : "–"
        );
        aircraftSeatsLabel.setText(
                f.getAircraftMaxSeatCapacity() != null
                        ? f.getAircraftMaxSeatCapacity().toString()
                        : "–"
        );
        aircraftYearLabel.setText(
                f.getAircraftManufactureYear() != null
                        ? f.getAircraftManufactureYear().toString()
                        : "–"
        );
        aircraftStatusLabel.setText(
                f.getAircraftStatusText() != null && !f.getAircraftStatusText().isBlank()
                        ? f.getAircraftStatusText()
                        : "–"
        );
    }

    private void openFlightDetails(Flight flight) {
        // Most csak a kijelölt infósávot frissítjük – később ide tehetsz külön dialogot is.
        updateSelectedFlightDetails(flight);
    }

    // ---------------------------------------------------
    // Bezárás
    // ---------------------------------------------------
    @FXML
    private void onClose() {
        if (refreshTimeline != null) {
            refreshTimeline.stop();
        }
        Stage stage = (Stage) flightsTable.getScene().getWindow();
        stage.close();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/UserSelfEditDialogController.java
================================
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.model.user.User;
import com.FourWings.atcSystem.model.user.UserService;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.control.Label;
import javafx.scene.control.TextField;
import javafx.stage.Modality;
import javafx.stage.Stage;
import lombok.Getter;
import org.springframework.stereotype.Component;

@Component
public class UserSelfEditDialogController {

    private final UserService userService;

    public UserSelfEditDialogController(UserService userService) {
        this.userService = userService;
    }

    // --- Alapadat mezők ---
    @FXML private TextField nameField;
    @FXML private TextField usernameField;
    @FXML private TextField emailField;
    @FXML private TextField phoneField;
    @FXML private Label errorLabel;

    private User user;

    @Getter
    private boolean edited = false;

    public void setUser(User user) {
        this.user = user;

        if (user != null) {
            nameField.setText(user.getName());
            usernameField.setText(user.getUsername());
            emailField.setText(user.getEmail());
            phoneField.setText(user.getPhone());
        } else {
            if (errorLabel != null) {
                errorLabel.setText("Nincs betöltött felhasználó.");
            }
        }
    }

    // === ALAPADATOK MENTÉSE (név, email, telefon) ===
    @FXML
    private void onSave(ActionEvent event) {
        if (user == null) {
            errorLabel.setText("Nincs felhasználó.");
            return;
        }

        String name = nameField.getText().trim();
        String email = emailField.getText().trim();
        String phone = phoneField.getText().trim();

        if (name.isEmpty()) {
            errorLabel.setText("A név megadása kötelező.");
            return;
        }

        user.setName(name);
        // username-et normál esetben nem engedném itt módosítani,
        // de ha neked így kell, maradhat:
        user.setUsername(usernameField.getText().trim());
        user.setEmail(email);
        user.setPhone(phone);

        try {
            // Itt csak az alapadatokat mentjük, jelszó NEM változik → rawPasswordOrNull = null
            userService.saveFromAdmin(user, null);
            edited = true;
            closeWindow();
        } catch (Exception ex) {
            ex.printStackTrace();
            errorLabel.setText("Mentési hiba: " + ex.getMessage());
        }
    }

    @FXML
    private void onCancel(ActionEvent event) {
        edited = false;
        closeWindow();
    }

    private void closeWindow() {
        Stage stage = (Stage) nameField.getScene().getWindow();
        stage.close();
    }

    // === JELSZÓ MÓDOSÍTÁSA POPUP DIALÓGUSSAL ===
    @FXML
    private void onChangePassword(ActionEvent event) {
        if (user == null) {
            if (errorLabel != null) {
                errorLabel.setText("Nincs betöltött felhasználó a jelszó módosításához.");
            }
            return;
        }

        try {
            FXMLLoader loader = new FXMLLoader(
                    getClass().getResource("/fxml/ChangePasswordDialog.fxml"));
            loader.setControllerFactory(com.FourWings.atcSystem.config.SpringContext::getBean);
            Parent root = loader.load();

            ChangePasswordDialogController ctrl = loader.getController();
            ctrl.setUser(user);

            Stage dialogStage = new Stage();
            dialogStage.initOwner(nameField.getScene().getWindow());
            dialogStage.initModality(Modality.WINDOW_MODAL);
            dialogStage.setTitle("Jelszó módosítása");
            dialogStage.setScene(new Scene(root));
            dialogStage.showAndWait();

        } catch (Exception ex) {
            ex.printStackTrace();
            if (errorLabel != null) {
                errorLabel.setText("Nem sikerült megnyitni a jelszó-módosítót: " + ex.getMessage());
            }
        }
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/MainPageController.java
================================
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.frontend.controller.ControllerHomePageController;
import com.FourWings.atcSystem.model.user.User;
import com.FourWings.atcSystem.service.AuthService;
import javafx.concurrent.Task;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.scene.Node;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.control.PasswordField;
import javafx.scene.control.TextField;
import javafx.stage.Stage;
import org.springframework.stereotype.Component;

@Component
public class MainPageController {

    private final AuthService authService;
    public static final int WIDTH = 1200; //Window szélesség
    public static final int HEIGHT = 600; //Window magasság

    public MainPageController(AuthService authService) {
        this.authService = authService;
    }

    @FXML private Label statusLabel;
    @FXML private TextField usernameField;
    @FXML private PasswordField passwordField;
    @FXML private Button loginButton;
    @FXML private Button registerButton;

    // ---------------------- NAVIGÁCIÓK ----------------------

    /** Sima USER főoldal */
    private void openUserHomePage(Stage stage, User user) throws Exception {
        HomePageController ctrl = SceneManager.switchTo(
                "HomePage.fxml",
                "ATC – Dashboard",
                WIDTH, HEIGHT
        );
        ctrl.initWithUser(user);
    }

    /** ADMIN dashboard */
    private void openAdminPage(Stage stage, User user) throws Exception {
        AdminPageController ctrl = SceneManager.switchTo(
                "AdminPage.fxml",
                "ATC – Admin Dashboard",
                600, 400
        );
        ctrl.initWithUser(user);
    }

    /** CONTROLLER főoldal (irányító munkaállomás) */
    private void openControllerHomePage(Stage stage, User user) throws Exception {
        ControllerHomePageController ctrl = SceneManager.switchTo(
                "ControllerHomePage.fxml",          // <- FXML neve
                "ATC – Irányító munkaállomás",      // ablak címe
                1100, 700                           // nagyobb, „dashboard” méret
        );
        ctrl.initWithUser(user);
    }

    // ---------------------- LOGIN ----------------------

    @FXML
    private void onLogin(ActionEvent event) {

        String username = usernameField.getText().trim();
        String password = passwordField.getText();

        if (username.isEmpty() || password.isEmpty()) {
            statusLabel.setText("Add meg a felhasználónevet és jelszót.");
            return;
        }

        // opcionális: gombok tiltása amíg fut a login
        loginButton.setDisable(true);
        registerButton.setDisable(true);
        statusLabel.setText("Bejelentkezés folyamatban...");

        Task<User> task = new Task<>() {
            @Override
            protected User call() {
                return authService.loginAndGetUser(username, password);
            }
        };

        task.setOnSucceeded(e -> {
            loginButton.setDisable(false);
            registerButton.setDisable(false);

            User user = task.getValue();

            if (user == null) {
                statusLabel.setText("Hibás felhasználónév vagy jelszó");
                return;
            }

            statusLabel.setText("Sikeres bejelentkezés!");

            Stage stage = (Stage) ((Node) event.getSource()).getScene().getWindow();

            try {
                // --- SZEREPKÖR SZERINTI ÁGAK ---
                if (user.isAdmin()) {
                    // Teljes jogú admin
                    openAdminPage(stage, user);

                } else if (user.isController()) {
                    // Irányító – saját controller dashboard
                    openControllerHomePage(stage, user);

                } else {
                    // Alap USER
                    openUserHomePage(stage, user);
                }

            } catch (Exception ex) {
                ex.printStackTrace();
                statusLabel.setText("Navigációs hiba: " + ex.getMessage());
            }
        });

        task.setOnFailed(e -> {
            loginButton.setDisable(false);
            registerButton.setDisable(false);

            Throwable ex = task.getException();
            ex.printStackTrace();
            statusLabel.setText("Hiba: " + ex.getMessage());
        });

        new Thread(task).start();
    }

    @FXML
    private void goToRegister(ActionEvent event) throws Exception {
        SceneManager.switchTo("RegistrationPage.fxml", "ATC – Regisztráció", 600, 400);
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/UserDataPageController.java
================================
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.config.SpringContext;
import com.FourWings.atcSystem.model.aircraft.Aircraft;
import com.FourWings.atcSystem.model.airline.Airline;
import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.flight.Flight;
import com.FourWings.atcSystem.model.gate.Gate;
import com.FourWings.atcSystem.model.terminal.Terminal;
import com.FourWings.atcSystem.model.user.User;
import com.FourWings.atcSystem.model.user.UserService;
import jakarta.persistence.FetchType;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.ManyToOne;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.control.Alert;
import javafx.scene.control.Label;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.stage.Modality;
import javafx.stage.Stage;
import lombok.ToString;
import org.springframework.stereotype.Component;

import java.io.IOException;
import java.io.InputStream;

@Component
public class UserDataPageController {

    private final UserService userService;
    public static final int WIDTH = 1200; //Window szélesség
    public static final int HEIGHT = 600; //Window magasság

    public UserDataPageController(UserService userService) {
        this.userService = userService;
    }

    @FXML
    private Label emailLabel;

    @FXML
    private Label nameLabel;

    @FXML
    private Label phoneLabel;

    @FXML
    private ImageView profileImageView;

    private User loggedUser;
    private Airports airports;
    private Aircraft aircraft;
    private Airline airline;

    @ToString.Exclude
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "terminal_id", referencedColumnName = "terminal_id")
    private Terminal terminal;

    private Gate gate;
    private Flight flight;

    public void initWithUser(User user) {
        this.loggedUser = user;

        if (user != null) {
            nameLabel.setText(user.getName());
            phoneLabel.setText(user.getPhone());
            emailLabel.setText(user.getEmail());
            refreshProfileImage();
        } else {
            System.out.println("initWithUser() null user-rel hívva");
        }
    }

    /**
     * A felhasználó profilképének frissítése.
     * A User.profileImagePath mezőben most már csak egy relatív resource útvonal van,
     * pl: "/images/avatars/avatar3.png"
     */
    private void refreshProfileImage() {
        if (profileImageView == null) return;
        if (loggedUser == null) return;

        String path = loggedUser.getProfileImagePath();   // <-- elérési út a User-ből
        if (path != null && !path.isBlank()) {
            try (InputStream is = getClass().getResourceAsStream(path)) {
                if (is != null) {
                    Image img = new Image(is);
                    profileImageView.setImage(img);
                } else {
                    System.out.println("Nem található profilkép resource: " + path);
                    profileImageView.setImage(null);
                }
            } catch (IOException e) {
                e.printStackTrace();
                profileImageView.setImage(null);
            }
        } else {
            profileImageView.setImage(null); // vagy később default kép
        }
    }

    public void setLastAirport(Airports airports) {
        this.airports = airports;
        System.out.println(airports.toString());
    }

    public void setLastAircraft(Aircraft aircraft) {
        this.aircraft = aircraft;
        System.out.println(aircraft.toString());
    }

    public void setLastAirline(Airline airline) {
        this.airline = airline;
        System.out.println(airline.toString());
    }

    public void setLastFlight(Flight flight) {
        this.flight = flight;
        System.out.println("Flight id=" + flight.getId());
    }

    public void setLastGate(Gate gate) {
        this.gate = gate;
        System.out.println("Gate id=" + gate.getId() + ", code=" + gate.getCode());
    }

    public void setLastTerminal(Terminal terminal) {
        this.terminal = terminal;
        System.out.println("Terminal id=" + terminal.getId());
    }

    // ======= PROFILKÉP MÓDOSÍTÁSA – UGYANAZ A POPUP, MINT REGISZTRÁCIÓ =======
    @FXML
    private void onChangeProfilePicture(ActionEvent event) {
        if (loggedUser == null) {
            Alert a = new Alert(Alert.AlertType.ERROR);
            a.setTitle("Hiba");
            a.setHeaderText("Nincs bejelentkezett felhasználó");
            a.setContentText("Profilkép módosításához be kell jelentkezni.");
            a.showAndWait();
            return;
        }

        try {
            FXMLLoader loader = new FXMLLoader(
                    getClass().getResource("/fxml/LogIn/AvatarPickerDialog.fxml"));
            loader.setControllerFactory(SpringContext::getBean);
            Parent root = loader.load();

            AvatarPickerDialogController ctrl = loader.getController();

            Stage dialogStage = new Stage();
            dialogStage.initOwner(nameLabel.getScene().getWindow());
            dialogStage.initModality(Modality.WINDOW_MODAL);
            dialogStage.setTitle("Profilkép módosítása");
            dialogStage.setScene(new Scene(root));
            dialogStage.showAndWait();

            // az AvatarPickerDialogController most már String elérési utat ad vissza
            String chosenPath = ctrl.getSelectedImagePath();
            if (chosenPath != null && !chosenPath.isBlank()) {
                // új kép elérési útjának beállítása, mentés DB-be
                loggedUser.setProfileImagePath(chosenPath);
                userService.saveFromAdmin(loggedUser, null); // jelszó változatlan

                // előnézet frissítése
                refreshProfileImage();

                Alert ok = new Alert(Alert.AlertType.INFORMATION);
                ok.setTitle("Profilkép frissítve");
                ok.setHeaderText(null);
                ok.setContentText("A profilképed sikeresen frissült.");
                ok.showAndWait();
            }

        } catch (Exception ex) {
            ex.printStackTrace();
            Alert err = new Alert(Alert.AlertType.ERROR);
            err.setTitle("Hiba");
            err.setHeaderText("Nem sikerült megnyitni az avatar választót.");
            err.setContentText(ex.getMessage());
            err.showAndWait();
        }
    }

    @FXML
    public void openProfileEditor(ActionEvent event) {
        if (loggedUser == null) {
            Alert alert = new Alert(Alert.AlertType.ERROR);
            alert.setTitle("Hiba");
            alert.setHeaderText("Nincs betöltve felhasználó");
            alert.setContentText("A profil szerkesztéséhez előbb be kell jelentkezni.");
            alert.showAndWait();
            return;
        }

        try {
            FXMLLoader loader = new FXMLLoader(
                    getClass().getResource("/fxml/UserSelfEditDialog.fxml"));
            loader.setControllerFactory(SpringContext::getBean);
            Parent root = loader.load();

            UserSelfEditDialogController ctrl = loader.getController();
            ctrl.setUser(loggedUser);

            Stage dialogStage = new Stage();
            dialogStage.initOwner(nameLabel.getScene().getWindow());
            dialogStage.setTitle("Profil szerkesztése");
            dialogStage.setScene(new Scene(root));
            dialogStage.showAndWait();

            // visszatérés után frissítjük a label-eket
            if (loggedUser != null) {
                nameLabel.setText(loggedUser.getName());
                phoneLabel.setText(loggedUser.getPhone());
                emailLabel.setText(loggedUser.getEmail());
                refreshProfileImage();
            }

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    @FXML
    public void toHome(ActionEvent event) {
        SceneManager.switchTo("HomePage.fxml", "ATC – Dashboard", WIDTH, HEIGHT);
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/UserAdminPageController.java
================================
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.config.SpringContext;
import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.user.User;
import com.FourWings.atcSystem.model.user.UserRole;
import com.FourWings.atcSystem.model.user.UserService;
import javafx.beans.property.SimpleStringProperty;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.collections.transformation.FilteredList;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.control.*;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.input.MouseButton;
import javafx.stage.Modality;
import javafx.stage.Stage;
import org.springframework.stereotype.Component;

@Component
public class UserAdminPageController {

    private final UserService userService;

    public UserAdminPageController(UserService userService) {
        this.userService = userService;
    }

    // --- FXML elemek ----
    @FXML
    private TableView<User> usersTable;

    @FXML
    private TableColumn<User, Long> idColumn;

    @FXML
    private TableColumn<User, String> nameColumn;

    @FXML
    private TableColumn<User, String> usernameColumn;

    @FXML
    private TableColumn<User, String> emailColumn;

    @FXML
    private TableColumn<User, String> phoneColumn;

    @FXML
    private TableColumn<User, UserRole> roleColumn;

    @FXML
    private TableColumn<User, String> airportColumn;

    @FXML
    private TextField searchField;

    @FXML
    private Label statusLabel;

    private final ObservableList<User> users = FXCollections.observableArrayList();
    private FilteredList<User> filteredUsers;

    @FXML
    public void initialize() {
        // oszlopok bindelése
        idColumn.setCellValueFactory(new PropertyValueFactory<>("id"));
        nameColumn.setCellValueFactory(new PropertyValueFactory<>("name"));
        usernameColumn.setCellValueFactory(new PropertyValueFactory<>("username"));
        emailColumn.setCellValueFactory(new PropertyValueFactory<>("email"));
        phoneColumn.setCellValueFactory(new PropertyValueFactory<>("phone"));
        roleColumn.setCellValueFactory(new PropertyValueFactory<>("role"));

        // Szerepkör szép szöveggel
        roleColumn.setCellFactory(col -> new TableCell<>() {
            @Override
            protected void updateItem(UserRole role, boolean empty) {
                super.updateItem(role, empty);
                if (empty || role == null) {
                    setText(null);
                } else {
                    switch (role) {
                        case ADMIN -> setText("Admin");
                        case CONTROLLER -> setText("Irányító");
                        case USER -> setText("Felhasználó");
                    }
                }
            }
        });

        // Hozzárendelt repülőtér oszlop (ICAO – Név)
        airportColumn.setCellValueFactory(cellData -> {
            User u = cellData.getValue();
            Airports ap = u.getAssignedAirport();
            if (ap == null) {
                return new SimpleStringProperty("");
            }
            String icao = ap.getIcaoCode() != null ? ap.getIcaoCode() : "";
            String name = ap.getName() != null ? ap.getName() : "";
            String text;
            if (!icao.isBlank() && !name.isBlank()) {
                text = icao + " – " + name;
            } else if (!icao.isBlank()) {
                text = icao;
            } else {
                text = name;
            }
            return new SimpleStringProperty(text);
        });

        users.setAll(userService.getAllUsers());
        filteredUsers = new FilteredList<>(users, u -> true);
        usersTable.setItems(filteredUsers);

        if (statusLabel != null) {
            statusLabel.setText("Felhasználók betöltve: " + users.size());
        }

        if (searchField != null) {
            searchField.textProperty().addListener((obs, oldVal, newVal) -> {
                String filter = (newVal == null) ? "" : newVal.trim().toLowerCase();

                filteredUsers.setPredicate(user -> {
                    if (filter.isEmpty()) return true;

                    String name = user.getName() != null ? user.getName().toLowerCase() : "";
                    String username = user.getUsername() != null ? user.getUsername().toLowerCase() : "";
                    String email = user.getEmail() != null ? user.getEmail().toLowerCase() : "";
                    String phone = user.getPhone() != null ? user.getPhone().toLowerCase() : "";
                    String roleText = (user.getRole() != null ? user.getRole().name() : "").toLowerCase();
                    String apText = "";
                    if (user.getAssignedAirport() != null) {
                        Airports ap = user.getAssignedAirport();
                        String icao = ap.getIcaoCode() != null ? ap.getIcaoCode().toLowerCase() : "";
                        String aName = ap.getName() != null ? ap.getName().toLowerCase() : "";
                        apText = icao + " " + aName;
                    }

                    return name.contains(filter)
                            || username.contains(filter)
                            || email.contains(filter)
                            || phone.contains(filter)
                            || roleText.contains(filter)
                            || apText.contains(filter);
                });

                if (statusLabel != null) {
                    statusLabel.setText("Találatok: " + filteredUsers.size() + " / Összes: " + users.size());
                }
            });
        }

        usersTable.setRowFactory(tv -> {
            TableRow<User> row = new TableRow<>();
            row.setOnMouseClicked(event -> {
                if (!row.isEmpty()
                        && event.getButton() == MouseButton.PRIMARY
                        && event.getClickCount() == 2) {

                    User selected = row.getItem();
                    openUserEditDialog(selected);
                }
            });
            return row;
        });

        usersTable.setOnKeyPressed(event -> {
            switch (event.getCode()) {
                case ENTER -> {
                    User selected = usersTable.getSelectionModel().getSelectedItem();
                    if (selected != null) {
                        openUserEditDialog(selected);
                    }
                    event.consume();
                }
            }
        });

        usersTable.getSelectionModel().selectedItemProperty().addListener((obs, oldSel, newSel) -> {
            if (newSel != null && statusLabel != null) {
                statusLabel.setText("Kiválasztott felhasználó: " + newSel.getUsername());
            }
        });
    }

    private void reloadUsers() {
        users.setAll(userService.getAllUsers());

        if (filteredUsers == null) {
            filteredUsers = new FilteredList<>(users, u -> true);
            usersTable.setItems(filteredUsers);
        } else {
            String currentFilter = (searchField != null && searchField.getText() != null)
                    ? searchField.getText().trim().toLowerCase()
                    : "";

            filteredUsers.setPredicate(user -> {
                if (currentFilter.isEmpty()) return true;
                String name = user.getName() != null ? user.getName().toLowerCase() : "";
                String username = user.getUsername() != null ? user.getUsername().toLowerCase() : "";
                String email = user.getEmail() != null ? user.getEmail().toLowerCase() : "";
                String roleText = (user.getRole() != null ? user.getRole().name() : "").toLowerCase();
                String apText = "";
                if (user.getAssignedAirport() != null) {
                    Airports ap = user.getAssignedAirport();
                    String icao = ap.getIcaoCode() != null ? ap.getIcaoCode().toLowerCase() : "";
                    String aName = ap.getName() != null ? ap.getName().toLowerCase() : "";
                    apText = icao + " " + aName;
                }

                return name.contains(currentFilter)
                        || username.contains(currentFilter)
                        || email.contains(currentFilter)
                        || roleText.contains(currentFilter)
                        || apText.contains(currentFilter);
            });
        }

        if (statusLabel != null) {
            statusLabel.setText("Lista frissítve. Találatok: "
                    + filteredUsers.size() + " / Összes: " + users.size());
        }
    }

    // ------- GOMBOK -------

    @FXML
    private void onEditSelectedUser() {
        User selected = usersTable.getSelectionModel().getSelectedItem();
        if (selected == null) {
            if (statusLabel != null) {
                statusLabel.setText("Nincs kijelölt felhasználó.");
            }
            return;
        }
        openUserEditDialog(selected);
    }

    @FXML
    private void onAddNewUser() {
        User newUser = new User();
        newUser.setRole(UserRole.USER);
        openUserEditDialog(newUser);
    }

    @FXML
    private void onDeleteUser() {
        User selected = usersTable.getSelectionModel().getSelectedItem();
        if (selected == null) {
            if (statusLabel != null) {
                statusLabel.setText("Nincs kijelölt felhasználó törléshez.");
            }
            return;
        }

        Alert confirm = new Alert(Alert.AlertType.CONFIRMATION);
        confirm.setTitle("Törlés megerősítése");
        confirm.setHeaderText("Biztosan törlöd a felhasználót?");
        confirm.setContentText("Felhasználó: " + selected.getUsername());

        confirm.showAndWait().ifPresent(buttonType -> {
            if (buttonType == ButtonType.OK) {
                userService.deleteUserById(selected.getId());
                reloadUsers();
                if (statusLabel != null) {
                    statusLabel.setText("Felhasználó törölve: " + selected.getUsername());
                }
            }
        });
    }

    @FXML
    private void onRefresh() {
        reloadUsers();
    }

    private void openUserEditDialog(User user) {
        try {
            FXMLLoader loader = new FXMLLoader(getClass().getResource("/fxml/UserEditDialog.fxml"));
            loader.setControllerFactory(SpringContext::getBean);
            Parent root = loader.load();

            UserEditDialogController ctrl = loader.getController();
            ctrl.setUser(user);

            Stage dialogStage = new Stage();
            dialogStage.initOwner(usersTable.getScene().getWindow());
            dialogStage.initModality(Modality.WINDOW_MODAL);
            dialogStage.setTitle("Felhasználó szerkesztése");
            dialogStage.setScene(new Scene(root));
            dialogStage.centerOnScreen();
            dialogStage.showAndWait();

            if (ctrl.isEdited()) {
                reloadUsers();
                if (statusLabel != null) {
                    statusLabel.setText("Felhasználó frissítve: " + user.getUsername());
                }
            }

        } catch (Exception ex) {
            ex.printStackTrace();
            if (statusLabel != null) {
                statusLabel.setText("Hiba a szerkesztő megnyitásakor: " + ex.getMessage());
            }
        }
    }

    @FXML
    private void onBackToAdmin(ActionEvent event) {
        SceneManager.switchTo("AdminPage.fxml", "ATC – Admin Dashboard", 600, 400);
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/ChangePasswordDialogController.java
================================
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.model.user.User;
import com.FourWings.atcSystem.model.user.UserService;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.scene.control.*;
import javafx.stage.Stage;
import org.springframework.stereotype.Component;

@Component
public class ChangePasswordDialogController {

    private final UserService userService;

    public ChangePasswordDialogController(UserService userService) {
        this.userService = userService;
    }

    @FXML private PasswordField oldPasswordField;
    @FXML private PasswordField newPasswordField;
    @FXML private PasswordField newPasswordAgainField;
    @FXML private Label errorLabel;

    private User user;

    public void setUser(User user) {
        this.user = user;
    }

    @FXML
    private void onSave(ActionEvent event) {
        if (user == null) {
            errorLabel.setText("Nincs felhasználó.");
            return;
        }

        String oldPw = oldPasswordField.getText();
        String newPw = newPasswordField.getText();
        String newPw2 = newPasswordAgainField.getText();

        if (oldPw == null || oldPw.isBlank()
                || newPw == null || newPw.isBlank()
                || newPw2 == null || newPw2.isBlank()) {
            errorLabel.setText("Minden mező kitöltése kötelező.");
            return;
        }

        if (!newPw.equals(newPw2)) {
            errorLabel.setText("Az új jelszó kétszer nem egyezik.");
            return;
        }

        try {
            userService.changePassword(user.getId(), oldPw, newPw);

            Alert ok = new Alert(Alert.AlertType.INFORMATION);
            ok.setTitle("Jelszó módosítva");
            ok.setHeaderText("A jelszó sikeresen módosítva.");
            ok.setContentText("Mostantól az új jelszóval tudsz bejelentkezni.");
            ok.showAndWait();

            closeWindow();
        } catch (IllegalArgumentException ex) {
            // pl. régi jelszó nem jó, vagy új túl rövid
            errorLabel.setText(ex.getMessage());
        } catch (Exception ex) {
            errorLabel.setText("Ismeretlen hiba történt.");
            ex.printStackTrace();
        }
    }

    @FXML
    private void onCancel(ActionEvent event) {
        closeWindow();
    }

    private void closeWindow() {
        Stage stage = (Stage) oldPasswordField.getScene().getWindow();
        stage.close();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/JavaFXApplication.java
================================
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.AtcSystemApplication;
import com.FourWings.atcSystem.config.SceneManager;
import javafx.application.Application;
import javafx.application.Platform;
import javafx.scene.image.Image;
import javafx.stage.Stage;
import org.springframework.boot.SpringApplication;
import org.springframework.context.ConfigurableApplicationContext;

public class JavaFXApplication extends Application {

    private ConfigurableApplicationContext ctx;

    @Override
    public void start(Stage stage) {
        try {
            // 1) Spring Boot indítása
            ctx = SpringApplication.run(AtcSystemApplication.class);

            // 2) SceneManager inicializálása *A KAPOTT* stage-dzsel
            SceneManager.init(stage);

            // 3) Első oldal betöltése
            SceneManager.switchTo("MainPage.fxml", "ATC System", 800, 400);

            // 4) Ikon beállítása (ha kell)
            stage.getIcons().add(
                    new Image(getClass()
                            .getResource("/images/1.png")
                            .toExternalForm())
            );

        } catch (Exception e) {
            e.printStackTrace();
            Platform.exit();
        }
    }

    @Override
    public void stop() {
        if (ctx != null) {
            ctx.close();
        }
        Platform.exit();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/RegistrationPageController.java
================================
package com.FourWings.atcSystem.frontend;

import com.FourWings.atcSystem.config.SceneManager;
import com.FourWings.atcSystem.config.SpringContext;
import com.FourWings.atcSystem.model.user.User;
import com.FourWings.atcSystem.model.user.UserRole;
import com.FourWings.atcSystem.model.user.UserService;
import javafx.concurrent.Task;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.control.PasswordField;
import javafx.scene.control.TextField;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.stage.Modality;
import javafx.stage.Stage;
import org.springframework.stereotype.Component;

import java.io.InputStream;
import java.util.regex.Pattern;

@Component
public class RegistrationPageController {

    private final UserService userService;

    public RegistrationPageController(UserService userService) {
        this.userService = userService;
    }

    @FXML private TextField emailInput;
    @FXML private TextField nevInput;
    @FXML private PasswordField passInput;
    @FXML private TextField phoneInput;
    @FXML private Button registerButton;
    @FXML private TextField userInput;
    @FXML private Label registerLabel;
    @FXML private Button backToMainPageButton;

    private static final Pattern USERNAME_PATTERN =
            Pattern.compile("^[A-Za-z0-9._-]{3,20}$");

    @FXML private ImageView profileImageView;
    @FXML private Label imageErrorLabel;

    // itt tároljuk a kiválasztott avatar elérési útját
    // pl.: "/images/avatars/avatar3.png"
    private String selectedProfileImagePath;

    @FXML
    private void onSelectProfileImage(ActionEvent event) {
        try {
            FXMLLoader loader = new FXMLLoader(
                    getClass().getResource("/fxml/AvatarPickerDialog.fxml"));
            loader.setControllerFactory(SpringContext::getBean);
            Parent root = loader.load();

            AvatarPickerDialogController ctrl = loader.getController();

            Stage dialogStage = new Stage();
            dialogStage.initOwner(profileImageView.getScene().getWindow());
            dialogStage.initModality(Modality.WINDOW_MODAL);
            dialogStage.setTitle("Profilkép választása");
            dialogStage.setScene(new Scene(root));
            dialogStage.showAndWait();

            String chosenPath = ctrl.getSelectedImagePath();
            if (chosenPath != null) {
                selectedProfileImagePath = chosenPath;

                // előnézet beállítása
                try (InputStream is = getClass().getResourceAsStream(chosenPath)) {
                    if (is != null) {
                        Image img = new Image(is);
                        profileImageView.setImage(img);
                    } else {
                        profileImageView.setImage(null);
                        if (imageErrorLabel != null) {
                            imageErrorLabel.setText("Nem található a kiválasztott avatar képe.");
                        }
                    }
                }

                if (imageErrorLabel != null) {
                    imageErrorLabel.setText("");
                }
            }

        } catch (Exception ex) {
            ex.printStackTrace();
            if (imageErrorLabel != null) {
                imageErrorLabel.setText("Nem sikerült megnyitni az avatar választót: " + ex.getMessage());
            }
        }
    }

    private void clearForm() {
        nevInput.clear();
        userInput.clear();
        emailInput.clear();
        passInput.clear();
        phoneInput.clear();
        selectedProfileImagePath = null;
        if (profileImageView != null) {
            profileImageView.setImage(null);
        }
    }

    @FXML
    private void backToMainPage(ActionEvent event) throws Exception {
        SceneManager.switchTo("MainPage.fxml", "ATC – Bejelentkezés", 800, 400);
    }

    @FXML
    public void register(ActionEvent event) {
        String username = userInput.getText().trim();
        String password = passInput.getText();

        if (username.isEmpty() || password.isEmpty()) {
            registerLabel.setText("Kitöltés kötelező: felhasználónév és jelszó.");
            return;
        }
        if (!USERNAME_PATTERN.matcher(username).matches()) {
            registerLabel.setText("Felhasználónév: 3–20 karakter, csak betűk, számok, ._- engedélyezett.");
            return;
        }
        if (password.length() < 8) {
            registerLabel.setText("Jelszó túl rövid (min. 8 karakter).");
            return;
        }

        // Profilkép kötelező
        if (selectedProfileImagePath == null) {
            if (imageErrorLabel != null) {
                imageErrorLabel.setText("Profilkép megadása kötelező.");
            }
            return;
        }

        Task<Void> task = new Task<>() {
            @Override
            protected Void call() throws Exception {
                boolean available = userService.isUsernameAvailable(username);
                if (!available) {
                    throw new IllegalStateException("A felhasználónév már foglalt.");
                }

                User u = User.builder()
                        .name(nevInput.getText().trim())
                        .username(username)
                        .email(emailInput.getText().trim())
                        .password(password)
                        .phone(phoneInput.getText().trim())
                        .role(UserRole.USER)              // 🔹 alapértelmezett
                        .assignedAirport(null)            // sima usernek nincs
                        .profileImagePath("/images/avatars/avatar1.png") // ha akarsz defaultot
                        .build();

                userService.registerSelf(u);
                return null;
            }
        };

        task.setOnSucceeded(e -> {
            registerLabel.setText("Sikeres regisztráció.");
            clearForm();
        });

        task.setOnFailed(e -> {
            Throwable ex = task.getException();
            registerLabel.setText("Hiba: " + (ex != null ? ex.getMessage() : "ismeretlen"));
        });

        new Thread(task, "check-and-save-user").start();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/frontend/AvatarPickerDialogController.java
================================
package com.FourWings.atcSystem.frontend;

import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.scene.Node;
import javafx.scene.control.Label;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.StackPane;
import javafx.stage.Stage;
import org.springframework.stereotype.Component;

import java.io.IOException;
import java.io.InputStream;

@Component
public class AvatarPickerDialogController {

    // Avatár csempék (StackPane) + bennük az ImageView-ok
    @FXML private StackPane avatar1Pane;
    @FXML private StackPane avatar2Pane;
    @FXML private StackPane avatar3Pane;
    @FXML private StackPane avatar4Pane;
    @FXML private StackPane avatar5Pane;
    @FXML private StackPane avatar6Pane;
    @FXML private StackPane avatar7Pane;
    @FXML private StackPane avatar8Pane;
    @FXML private StackPane avatar9Pane;
    @FXML private StackPane avatar10Pane;

    @FXML private ImageView avatar1View;
    @FXML private ImageView avatar2View;
    @FXML private ImageView avatar3View;
    @FXML private ImageView avatar4View;
    @FXML private ImageView avatar5View;
    @FXML private ImageView avatar6View;
    @FXML private ImageView avatar7View;
    @FXML private ImageView avatar8View;
    @FXML private ImageView avatar9View;
    @FXML private ImageView avatar10View;

    @FXML private Label errorLabel;
    @FXML private Label selectedNameLabel;

    private StackPane selectedPane;      // melyik avatar csempe van kijelölve
    private String selectedImagePath;    // pl. "/images/avatars/avatar3.png"

    private static final String TILE_BASE_STYLE =
            "-fx-background-radius: 10; -fx-padding: 4;";

    private static final String SELECTED_BORDER_STYLE =
            "-fx-border-color: #0078ff; -fx-border-width: 2; -fx-border-radius: 10;";

    public String getSelectedImagePath() {
        return selectedImagePath;
    }

    @FXML
    public void initialize() {
        // Avatárok betöltése – ide tedd a képeket:
        // src/main/resources/images/avatars/avatar1.png ... avatar10.png
        loadAvatar(avatar1View, "/images/avatars/avatar1.png");
        loadAvatar(avatar2View, "/images/avatars/avatar2.png");
        loadAvatar(avatar3View, "/images/avatars/avatar3.png");
        loadAvatar(avatar4View, "/images/avatars/avatar4.png");
        loadAvatar(avatar5View, "/images/avatars/avatar5.png");
        loadAvatar(avatar6View, "/images/avatars/avatar6.png");
        loadAvatar(avatar7View, "/images/avatars/avatar7.png");
        loadAvatar(avatar8View, "/images/avatars/avatar8.png");
        loadAvatar(avatar9View, "/images/avatars/avatar9.png");
        loadAvatar(avatar10View, "/images/avatars/avatar10.png");

        // alap stílus a csempékre
        avatar1Pane.setStyle(TILE_BASE_STYLE);
        avatar2Pane.setStyle(TILE_BASE_STYLE);
        avatar3Pane.setStyle(TILE_BASE_STYLE);
        avatar4Pane.setStyle(TILE_BASE_STYLE);
        avatar5Pane.setStyle(TILE_BASE_STYLE);
        avatar6Pane.setStyle(TILE_BASE_STYLE);
        avatar7Pane.setStyle(TILE_BASE_STYLE);
        avatar8Pane.setStyle(TILE_BASE_STYLE);
        avatar9Pane.setStyle(TILE_BASE_STYLE);
        avatar10Pane.setStyle(TILE_BASE_STYLE);

        if (selectedNameLabel != null) {
            selectedNameLabel.setText("Nincs kiválasztva kép");
        }
    }

    private void loadAvatar(ImageView view, String resourcePath) {
        try (InputStream is = getClass().getResourceAsStream(resourcePath)) {
            if (is != null) {
                Image img = new Image(is);
                view.setImage(img);
            } else {
                System.out.println("Nem találom: " + resourcePath);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    // ===================== KIJELÖLÉS STÍLUS =======================

    private void clearSelectionStyle() {
        StackPane[] panes = {
                avatar1Pane, avatar2Pane, avatar3Pane, avatar4Pane, avatar5Pane,
                avatar6Pane, avatar7Pane, avatar8Pane, avatar9Pane, avatar10Pane
        };
        for (StackPane p : panes) {
            if (p != null) {
                p.setStyle(TILE_BASE_STYLE);
            }
        }
    }

    private void highlightPane(StackPane pane) {
        if (pane == null) return;
        pane.setStyle(TILE_BASE_STYLE + " " + SELECTED_BORDER_STYLE);
    }

    // ===================== AVATÁR KIJELÖLÉS =======================

    private void selectPredefinedAvatar(StackPane pane, String resourcePath) {
        clearSelectionStyle();
        selectedPane = pane;
        highlightPane(pane);

        selectedImagePath = resourcePath;

        if (selectedNameLabel != null) {
            String fileName = resourcePath.substring(resourcePath.lastIndexOf('/') + 1);
            selectedNameLabel.setText("Kiválasztott: " + fileName);
        }
        if (errorLabel != null) {
            errorLabel.setText("");
        }
    }

    @FXML private void onAvatar1Click(MouseEvent e) { selectPredefinedAvatar(avatar1Pane,  "/images/avatars/avatar1.png"); }
    @FXML private void onAvatar2Click(MouseEvent e) { selectPredefinedAvatar(avatar2Pane,  "/images/avatars/avatar2.png"); }
    @FXML private void onAvatar3Click(MouseEvent e) { selectPredefinedAvatar(avatar3Pane,  "/images/avatars/avatar3.png"); }
    @FXML private void onAvatar4Click(MouseEvent e) { selectPredefinedAvatar(avatar4Pane,  "/images/avatars/avatar4.png"); }
    @FXML private void onAvatar5Click(MouseEvent e) { selectPredefinedAvatar(avatar5Pane,  "/images/avatars/avatar5.png"); }
    @FXML private void onAvatar6Click(MouseEvent e) { selectPredefinedAvatar(avatar6Pane,  "/images/avatars/avatar6.png"); }
    @FXML private void onAvatar7Click(MouseEvent e) { selectPredefinedAvatar(avatar7Pane,  "/images/avatars/avatar7.png"); }
    @FXML private void onAvatar8Click(MouseEvent e) { selectPredefinedAvatar(avatar8Pane,  "/images/avatars/avatar8.png"); }
    @FXML private void onAvatar9Click(MouseEvent e) { selectPredefinedAvatar(avatar9Pane,  "/images/avatars/avatar9.png"); }
    @FXML private void onAvatar10Click(MouseEvent e){ selectPredefinedAvatar(avatar10Pane, "/images/avatars/avatar10.png"); }

    // ===================== OK / MÉGSE =============================

    @FXML
    private void onOk(ActionEvent event) {
        if (selectedImagePath == null) {
            if (errorLabel != null) {
                errorLabel.setText("Először válassz képet.");
            }
            return;
        }
        closeWindow(event);
    }

    @FXML
    private void onCancel(ActionEvent event) {
        selectedImagePath = null; // semmit nem választ
        closeWindow(event);
    }

    private void closeWindow(ActionEvent event) {
        Node src = (Node) event.getSource();
        Stage stage = (Stage) src.getScene().getWindow();
        stage.close();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/test/UI_Threa_Stress_Test.java
================================
package com.FourWings.atcSystem.test;

import javafx.application.Application;
import javafx.application.Platform;
import javafx.scene.Scene;
import javafx.scene.control.Label;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;


public class UI_Threa_Stress_Test extends Application {

    private long lastUpdate = System.nanoTime();

    @Override
    public void start(Stage primaryStage) {
        Label statusLabel = new Label("Teszt indul...");
        VBox root = new VBox(statusLabel);
        Scene scene = new Scene(root, 400, 200);

        primaryStage.setScene(scene);
        primaryStage.setTitle("JavaFX UI Thread Teszt");
        primaryStage.show();

        // UI frissítés 60 FPS körül
        new Thread(() -> {
            while (true) {
                try {
                    Thread.sleep(16); // kb. 60 FPS
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                Platform.runLater(() -> {
                    long now = System.nanoTime();
                    long diffMs = (now - lastUpdate) / 1_000_000;
                    statusLabel.setText("UI frissítés késése: " + diffMs + " ms");
                    lastUpdate = now;
                });
            }
        }).start();

        // Szimuláljunk egy nagy számítást az UI thread-en (NE CSINÁLD ÉLESBEN!)
        // Ha ezt bekapcsolod, látni fogod, hogy az UI megakad.

        Platform.runLater(() -> {
            for (int i = 0; i < 1_000_000_000; i++) {
                Math.sqrt(i);
            }
        });

    }

    public static void main(String[] args) {
        launch(args);
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/config/SecurityConfig.java
================================
package com.FourWings.atcSystem.config;


import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;

@Configuration
public class SecurityConfig {

    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/config/SceneManager.java
================================
package com.FourWings.atcSystem.config;

import com.FourWings.atcSystem.config.SpringContext;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.stage.Stage;

public class SceneManager {
    public static Stage primaryStage;

    public static void init(Stage stage) {
        primaryStage = stage;
    }

    public static <T> T switchTo(String fxml, String title, int width, int height) {
        try {
            FXMLLoader loader = new FXMLLoader(SceneManager.class.getResource("/fxml/" + fxml));
            loader.setControllerFactory(SpringContext::getBean);
            Parent root = loader.load();

            Scene scene = new Scene(root, width, height);
            primaryStage.setScene(scene);
            primaryStage.setTitle(title);
            primaryStage.centerOnScreen();
            primaryStage.show();

            return loader.getController();

        } catch (Exception ex) {
            throw new RuntimeException("Nem sikerült betölteni: " + fxml + "    " + "/fxml/" + fxml, ex);
        }
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/config/SpringContext.java
================================
package com.FourWings.atcSystem.config;

import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;
import org.springframework.stereotype.Component;

@Component
public class SpringContext implements ApplicationContextAware {
    private static ApplicationContext context;

    @Override
    public void setApplicationContext(ApplicationContext applicationContext) {
        context = applicationContext;
    }

    public static <T> T getBean(Class<T> type) {
        return context.getBean(type);
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/AtcSystemApplication.java
================================
package com.FourWings.atcSystem;

import com.FourWings.atcSystem.model.user.UserRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class AtcSystemApplication{

    @Autowired
    UserRepository userRepository;


    public static void main(String[] args) {
        SpringApplication.run(AtcSystemApplication.class, args);
    }

}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/aircraft/AircraftService.java
================================
package com.FourWings.atcSystem.model.aircraft;

import com.FourWings.atcSystem.model.airport.Airports;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
@RequiredArgsConstructor
public class AircraftService {
    private final AircraftRepository repo;

    public Aircraft getLastAdded() {
        return repo.findTopByOrderByIdDesc();
    }

    public List<Aircraft> getAllAircraft() {
        return repo.findAll();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/aircraft/AircraftStatusConverter.java
================================
package com.FourWings.atcSystem.model.aircraft;

import jakarta.persistence.AttributeConverter;
import jakarta.persistence.Converter;

@Converter(autoApply = true)
public class AircraftStatusConverter implements AttributeConverter<AircraftStatus, String> {
    @Override
    public String convertToDatabaseColumn(AircraftStatus status) {
        return status == null ? null : status.name().toLowerCase();
    }

    @Override
    public AircraftStatus convertToEntityAttribute(String dbValue) {
        return dbValue == null ? null : AircraftStatus.valueOf(dbValue.toUpperCase());
    }
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/aircraft/Aircraft.java
================================
package com.FourWings.atcSystem.model.aircraft;

import jakarta.persistence.*;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.UpdateTimestamp;

import java.time.LocalDateTime;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@Entity
@Table(name = "aircraft")
public class Aircraft {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "aircraft_id")
    private Long id;

    @Column(name = "registration", length = 20, nullable = false)
    private String registration;

    @Column(name = "type_icao", length = 10)
    private String typeIcao;

    @Column(name = "airline_id")
    private Long airlineId;

    @Convert(converter = AircraftStatusConverter.class)
    @Column(name = "status")
    private AircraftStatus status;

    @Column(name = "msn")
    private String msn;

    @Column(name = "max_seat_capacity")
    private Short maxSeatCapacity;

    @Column(name = "cargo_capacity_base")
    private Integer cargoCapacityBase;

    @Column(name = "base_airport_id")
    private Long baseAirportId;

    @Column(name = "manufacture_year")
    private Short manufactureYear;

    @Column(name = "note", columnDefinition = "TEXT")
    private String note;

    @CreationTimestamp
    @Column(name = "created_at", updatable = false)
    private LocalDateTime createdAt;

    @UpdateTimestamp
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    @Override
    public String toString() {
        return "Aircraft{" +
                "id=" + id +
                ", registration='" + registration + '\'' +
                ", typeIcao='" + typeIcao + '\'' +
                ", airlineId=" + airlineId +
                ", status=" + status +
                ", maxSeatCapacity=" + maxSeatCapacity +
                ", cargoCapacityBase=" + cargoCapacityBase +
                ", baseAirportId=" + baseAirportId +
                ", manufactureYear=" + manufactureYear +
                ", note='" + note + '\'' +
                ", createdAt=" + createdAt +
                ", updatedAt=" + updatedAt +
                '}';
    }

}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/aircraft/AircraftStatus.java
================================
package com.FourWings.atcSystem.model.aircraft;



public enum AircraftStatus {
    ACTIVE,
    MAINTENANCE,
    WITHDRAWN,
    GROUNDED
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/aircraft/AircraftRepository.java
================================
package com.FourWings.atcSystem.model.aircraft;

import org.springframework.data.jpa.repository.JpaRepository;

public interface AircraftRepository extends JpaRepository<Aircraft, Long> {
    Aircraft findTopByOrderByIdDesc();
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/flight/FlightStatusConverter.java
================================
package com.FourWings.atcSystem.model.flight;

import jakarta.persistence.AttributeConverter;
import jakarta.persistence.Converter;

@Converter(autoApply = true)
public class FlightStatusConverter implements AttributeConverter<FlightStatus, String> {

    @Override
    public String convertToDatabaseColumn(FlightStatus attribute) {
        return attribute == null ? null : attribute.name().toLowerCase();
    }

    @Override
    public FlightStatus convertToEntityAttribute(String dbData) {
        return dbData == null ? null : FlightStatus.valueOf(dbData.toUpperCase());
    }
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/flight/FlightService.java
================================
package com.FourWings.atcSystem.model.flight;

import com.FourWings.atcSystem.model.airport.Airports;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.time.format.DateTimeFormatter;
import java.util.List;

@Service
@RequiredArgsConstructor
public class FlightService {

    private final FlightRepository repo;

    private static final DateTimeFormatter FORMATTER =
            DateTimeFormatter.ofPattern("yyyy.MM.dd HH:mm");

    @Transactional(readOnly = true)
    public Flight getLastAdded() {
        Flight f = repo.findTopByOrderByIdDesc();
        if (f != null) {
            prepareFlightForView(f);
        }
        return f;
    }

    // ---------------------------------------------
    // CONTROLLER HOME PAGE FUNKCIÓK (OPTIMALIZÁLVA)
    // ---------------------------------------------

    /**
     * Induló járatok lekérése egy adott repülőtérről.
     * MÓDOSÍTÁS: Az optimalizált 'findDeparturesByAirportWithDetails' metódust hívja,
     * így egyetlen lekérdezéssel tölti be a légitársaságot, kaput és repülőt.
     */
    @Transactional(readOnly = true)
    public List<Flight> getDeparturesForAirport(Airports airport) {
        if (airport == null) return List.of();

        // Itt hívjuk az új repository metódust a régi findByDepartureAirport helyett
        List<Flight> flights = repo.findDeparturesByAirportWithDetails(airport);

        flights.forEach(this::prepareFlightForView);
        return flights;
    }

    /**
     * Érkező járatok lekérése egy adott repülőtérre.
     * MÓDOSÍTÁS: Az optimalizált 'findArrivalsByAirportWithDetails' metódust hívja.
     */
    @Transactional(readOnly = true)
    public List<Flight> getArrivalsForAirport(Airports airport) {
        if (airport == null) return List.of();

        // Itt hívjuk az új repository metódust a régi findByArrivalAirport helyett
        List<Flight> flights = repo.findArrivalsByAirportWithDetails(airport);

        flights.forEach(this::prepareFlightForView);
        return flights;
    }

    // ---------------------------------------------
    // ADMIN / USER FUNKCIÓK
    // ---------------------------------------------

    @Transactional(readOnly = true)
    public List<Flight> getAll() {
        List<Flight> flights = repo.findAll();
        flights.forEach(this::prepareFlightForView);
        return flights;
    }

    @Transactional
    public Flight save(Flight flight) {
        Flight saved = repo.save(flight);
        prepareFlightForView(saved);
        return saved;
    }

    @Transactional
    public void deleteById(Long id) {
        repo.deleteById(id);
    }

    // ---------------------------------------------
    // Segédfüggvény: lazy kapcsolatok (már betöltött) inicializálása
    // és UI-hoz szükséges mezők beállítása
    // ---------------------------------------------

    private void prepareFlightForView(Flight f) {
        // --- Airline neve ---
        if (f.getAirline() != null) {
            f.setAirlineName(
                    f.getAirline().getName() != null ? f.getAirline().getName() : ""
            );
        } else {
            f.setAirlineName("");
        }

        // --- Induló / érkező reptér nevek ---
        if (f.getDepartureAirport() != null) {
            f.setOriginName(
                    f.getDepartureAirport().getName() != null ? f.getDepartureAirport().getName() : ""
            );
        } else {
            f.setOriginName("");
        }

        if (f.getArrivalAirport() != null) {
            f.setDestinationName(
                    f.getArrivalAirport().getName() != null ? f.getArrivalAirport().getName() : ""
            );
        } else {
            f.setDestinationName("");
        }

        // --- Időpontok formázása ---
        f.setScheduledDepartureText(
                f.getScheduledDeparture() != null ? f.getScheduledDeparture().format(FORMATTER) : ""
        );
        f.setEstimatedDepartureText(
                f.getEstimatedDeparture() != null ? f.getEstimatedDeparture().format(FORMATTER) : ""
        );
        f.setScheduledArrivalText(
                f.getScheduledArrival() != null ? f.getScheduledArrival().format(FORMATTER) : ""
        );
        f.setEstimatedArrivalText(
                f.getEstimatedArrival() != null ? f.getEstimatedArrival().format(FORMATTER) : ""
        );

        // --- Kapukód ---
        if (f.getGate() != null && f.getGate().getCode() != null) {
            f.setGateCode(f.getGate().getCode());
        } else {
            f.setGateCode("");
        }

        // --- Státusz szöveg ---
        if (f.getStatus() != null) {
            f.setStatusText(f.getStatus().name());
        } else {
            f.setStatusText("");
        }

        // --- Repülőgép adatok ---
        if (f.getAircraft() != null) {
            f.setAircraftRegistration(
                    f.getAircraft().getRegistration() != null ? f.getAircraft().getRegistration() : ""
            );
            f.setAircraftTypeIcao(
                    f.getAircraft().getTypeIcao() != null ? f.getAircraft().getTypeIcao() : ""
            );
            f.setAircraftMaxSeatCapacity(f.getAircraft().getMaxSeatCapacity());
            f.setAircraftManufactureYear(f.getAircraft().getManufactureYear());

            if (f.getAircraft().getStatus() != null) {
                f.setAircraftStatusText(f.getAircraft().getStatus().name());
            } else {
                f.setAircraftStatusText("");
            }
        } else {
            f.setAircraftRegistration("");
            f.setAircraftTypeIcao("");
            f.setAircraftMaxSeatCapacity(null);
            f.setAircraftManufactureYear(null);
            f.setAircraftStatusText("");
        }
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/flight/FlightStatus.java
================================
package com.FourWings.atcSystem.model.flight;

public enum FlightStatus {
    SCHEDULED,
    DELAYED,
    BOARDING,
    TAXI,
    AIRBORNE,
    LANDED,
    CANCELLED
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/flight/FlightRepository.java
================================
package com.FourWings.atcSystem.model.flight;

import com.FourWings.atcSystem.model.airport.Airports;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query; // ÚJ IMPORT
import org.springframework.data.repository.query.Param; // ÚJ IMPORT
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
public interface FlightRepository extends JpaRepository<Flight, Long> {

    // --- EREDETI METÓDUSAID (Változatlanul) ---
    Flight findTopByOrderByIdDesc();

    // Induló járatok (ahol a repülőtér az indulási repteret jelenti)
    List<Flight> findByDepartureAirport(Airports airport);

    // Érkező járatok (ahol a repülőtér az érkezési repteret jelenti)
    List<Flight> findByArrivalAirport(Airports airport);

    @Query("SELECT f FROM Flight f " +
            "LEFT JOIN FETCH f.airline " +
            "LEFT JOIN FETCH f.arrivalAirport " +
            "LEFT JOIN FETCH f.gate " +
            "LEFT JOIN FETCH f.aircraft " +
            "WHERE f.departureAirport = :airport")
    List<Flight> findDeparturesByAirportWithDetails(@Param("airport") Airports airport);

    @Query("SELECT f FROM Flight f " +
            "LEFT JOIN FETCH f.airline " +
            "LEFT JOIN FETCH f.departureAirport " +
            "LEFT JOIN FETCH f.gate " +
            "LEFT JOIN FETCH f.aircraft " +
            "WHERE f.arrivalAirport = :airport")
    List<Flight> findArrivalsByAirportWithDetails(@Param("airport") Airports airport);
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/flight/Flight.java
================================
package com.FourWings.atcSystem.model.flight;

import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.model.airline.Airline;
import com.FourWings.atcSystem.model.aircraft.Aircraft;
import com.FourWings.atcSystem.model.gate.Gate;
import jakarta.persistence.*;
import lombok.*;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.UpdateTimestamp;

import java.time.LocalDateTime;

@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
@Builder
@Entity
@Table(name = "flights")
public class Flight {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "flight_id")
    private Long id;

    // --- Kapcsolatok ---
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "departure_airport_id", referencedColumnName = "airport_id")
    private Airports departureAirport;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "arrival_airport_id", referencedColumnName = "airport_id")
    private Airports arrivalAirport;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "airline_id", referencedColumnName = "airline_id")
    private Airline airline;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "aircraft_id", referencedColumnName = "aircraft_id")
    private Aircraft aircraft;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "gate_id", referencedColumnName = "gate_id")
    private Gate gate;

    // --- Adatok ---
    @Column(name = "flight_number", length = 10, nullable = false)
    private String flightNumber;

    @Convert(converter = FlightStatusConverter.class)
    @Column(name = "status")
    private FlightStatus status;

    // --- Időpontok ---
    @Column(name = "scheduled_departure")
    private LocalDateTime scheduledDeparture;

    @Column(name = "scheduled_arrival")
    private LocalDateTime scheduledArrival;

    @Column(name = "estimated_departure")
    private LocalDateTime estimatedDeparture;

    @Column(name = "actual_departure")
    private LocalDateTime actualDeparture;

    @Column(name = "estimated_arrival")
    private LocalDateTime estimatedArrival;

    @Column(name = "actual_arrival")
    private LocalDateTime actualArrival;

    // --- Egyéb mezők ---
    @Column(name = "note", columnDefinition = "TEXT")
    private String note;

    // --- Létrehozás és módosítás ---
    @CreationTimestamp
    @Column(name = "created_at", updatable = false)
    private LocalDateTime createdAt;

    @UpdateTimestamp
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    // --- UI-hoz használt, nem perzisztált mezők (transient) ---

    @Transient
    private String airlineName;             // légitársaság neve

    @Transient
    private String originName;              // induló reptér neve

    @Transient
    private String destinationName;         // érkező reptér neve

    @Transient
    private String scheduledDepartureText;  // menetrend szerinti indulás (formázott)

    @Transient
    private String estimatedDepartureText;  // várható indulás (formázott)

    @Transient
    private String scheduledArrivalText;    // menetrend szerinti érkezés (formázott)

    @Transient
    private String estimatedArrivalText;    // várható érkezés (formázott)

    @Transient
    private String gateCode;                // kapukód

    @Transient
    private String statusText;              // státusz szöveg (UI-hoz)

    // --- Aircraft (repülőgép) adatok a UI számára ---

    @Transient
    private String aircraftRegistration;

    @Transient
    private String aircraftTypeIcao;

    @Transient
    private Short aircraftMaxSeatCapacity;

    @Transient
    private Short aircraftManufactureYear;

    @Transient
    private String aircraftStatusText;

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        Flight flight = (Flight) o;
        // ha az id még nincs elmentve (null), akkor objektum azonosság szerint hasonlítunk
        if (id == null || flight.id == null) return false;
        return id.equals(flight.id);
    }

    @Override
    public int hashCode() {
        return 31;
    }

    @Override
    public String toString() {
        return "Flight{" +
                "id=" + id +
                ", flightNumber='" + flightNumber + '\'' +
                ", status=" + status +
                ", scheduledDeparture=" + scheduledDeparture +
                ", scheduledArrival=" + scheduledArrival +
                ", estimatedDeparture=" + estimatedDeparture +
                ", estimatedArrival=" + estimatedArrival +
                '}';
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/terminal/TerminalStatus.java
================================
package com.FourWings.atcSystem.model.terminal;

public enum TerminalStatus {
    ACTIVE, MAINTENANCE, CLOSED
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/terminal/Terminal.java
================================
package com.FourWings.atcSystem.model.terminal;

import com.FourWings.atcSystem.model.airport.Airports;
import jakarta.persistence.*;
import lombok.*;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.UpdateTimestamp;

import java.time.LocalDateTime;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@Entity
@Table(name = "terminals")
@ToString(exclude = "airport")
public class Terminal {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "terminal_id")
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "airport_id", referencedColumnName = "airport_id")
    private Airports airport;

    @Column(name = "code", length = 20, nullable = false)
    private String code;

    @Convert(converter = TerminalStatusConverter.class) // DB-ben kisbetűs
    @Column(name = "status")
    private TerminalStatus status;

    @Column(name = "gates_count")
    private Short gatesCount;

    @Column(name = "has_departures_hall")
    private Boolean hasDeparturesHall;

    @Column(name = "has_arrivals_hall")
    private Boolean hasArrivalsHall;

    @Column(name = "has_cargo_facility")
    private Boolean hasCargoFacility;

    @Column(name = "note", columnDefinition = "TEXT")
    private String note;

    @CreationTimestamp
    @Column(name = "created_at", updatable = false)
    private LocalDateTime createdAt;

    @UpdateTimestamp
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    @Override
    public String toString() {
        return "Terminal{" +
                "id=" + id +
                ", airport=" + airport +
                ", code='" + code + '\'' +
                ", status=" + status +
                ", gatesCount=" + gatesCount +
                ", hasDeparturesHall=" + hasDeparturesHall +
                ", hasArrivalsHall=" + hasArrivalsHall +
                ", hasCargoFacility=" + hasCargoFacility +
                ", note='" + note + '\'' +
                ", createdAt=" + createdAt +
                ", updatedAt=" + updatedAt +
                '}';
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/terminal/TerminalStatusConverter.java
================================
package com.FourWings.atcSystem.model.terminal;


import jakarta.persistence.AttributeConverter;
import jakarta.persistence.Converter;

@Converter(autoApply = true)
public class TerminalStatusConverter implements AttributeConverter<TerminalStatus, String> {
    @Override public String convertToDatabaseColumn(TerminalStatus s) {
        return s == null ? null : s.name().toLowerCase();
    }
    @Override public TerminalStatus convertToEntityAttribute(String db) {
        return db == null ? null : TerminalStatus.valueOf(db.toUpperCase());
    }
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/terminal/TerminalService.java
================================
package com.FourWings.atcSystem.model.terminal;

import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

@Service
@RequiredArgsConstructor
public class TerminalService {
    private final TerminalRepository repo;

    @Transactional(readOnly = true)
    public Terminal getLastAdded() {
        return repo.findTopByOrderByIdDesc();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/terminal/TerminalRepository.java
================================
package com.FourWings.atcSystem.model.terminal;

import org.springframework.data.jpa.repository.EntityGraph;
import org.springframework.data.jpa.repository.JpaRepository;

import java.util.Optional;

public interface TerminalRepository extends JpaRepository<Terminal, Long> {

    @EntityGraph(attributePaths = "airport")
    Terminal findTopByOrderByIdDesc();

    Optional<Terminal> findByAirport_IdAndCode(Long airportId, String code);
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/user/UserRole.java
================================
package com.FourWings.atcSystem.model.user;

public enum UserRole {
    USER,        // sima felhasználó – csak nézelődik
    CONTROLLER,  // irányító – egy repülőtérhez kötve, járat, időjárás, stb.
    ADMIN        // teljes jog, minden táblát / usert kezel
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/user/UserService.java
================================
package com.FourWings.atcSystem.model.user;

import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.security.SecureRandom;
import java.util.List;

@Service
public class UserService {
    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;

    public UserService(UserRepository userRepository,
                       PasswordEncoder passwordEncoder) {
        this.userRepository = userRepository;
        this.passwordEncoder = passwordEncoder;
    }

    public boolean isUsernameAvailable(String username) {
        return !userRepository.existsByUsername(username);
    }

    // 1) sima, önregisztráció (amit a RegistrationPage használ)
    @Transactional
    public User registerSelf(User u) {
        // ha nem adtunk meg szerepkört, legyen USER
        if (u.getRole() == null) {
            u.setRole(UserRole.USER);
        }
        u.setPassword(passwordEncoder.encode(u.getPassword()));
        return userRepository.save(u);
    }

    /**
     * Admin által létrehozott / módosított felhasználó.
     *
     * rawPasswordOrNull:
     *  - ha NEM null/üres: új jelszó -> encode + mentés
     *  - ha null/üres: jelszó VÁLTOZATLAN marad a DB-ben
     */
    @Transactional
    public User saveFromAdmin(User u, String rawPasswordOrNull) {

        if (u.getId() == 0) {
            // --- ÚJ USER ---

            // felhasználónév ütközés ellenőrzés
            if (userRepository.existsByUsername(u.getUsername())) {
                throw new IllegalStateException("A felhasználónév már foglalt: " + u.getUsername());
            }

            // default szerepkör, ha nincs
            if (u.getRole() == null) {
                u.setRole(UserRole.USER);
            }

            // jelszó beállítása
            if (rawPasswordOrNull != null && !rawPasswordOrNull.isBlank()) {
                u.setPassword(passwordEncoder.encode(rawPasswordOrNull));
            }

            return userRepository.save(u);
        }

        // --- MEGLÉVŐ USER ---

        // username ütközés ellenőrzés (másik usernél van-e ugyanaz)
        boolean usernameTaken =
                userRepository.existsByUsernameAndIdNot(u.getUsername(), u.getId());
        if (usernameTaken) {
            throw new IllegalStateException("A felhasználónév már foglalt: " + u.getUsername());
        }

        // DB-ből frissen betöltött entitás (MANAGED)
        User dbUser = userRepository.findById(u.getId())
                .orElseThrow(() ->
                        new IllegalArgumentException("Felhasználó nem található id=" + u.getId()));

        // Alap adatok frissítése
        dbUser.setName(u.getName());
        dbUser.setUsername(u.getUsername());
        dbUser.setEmail(u.getEmail());
        dbUser.setPhone(u.getPhone());

        // Szerepkör frissítése (ha nullt kapunk, hagyjuk a régit)
        if (u.getRole() != null) {
            dbUser.setRole(u.getRole());
        }

        // Assigned airport, profilkép elérési út – ha használod ezeket:
        dbUser.setAssignedAirport(u.getAssignedAirport());
        dbUser.setProfileImagePath(u.getProfileImagePath());

        // A jelszó CSAK AKKOR változik, ha kaptunk nyers jelszót:
        if (rawPasswordOrNull != null && !rawPasswordOrNull.isBlank()) {
            dbUser.setPassword(passwordEncoder.encode(rawPasswordOrNull));
        }

        return userRepository.save(dbUser);
    }

    public List<User> getAllUsers() {
        return userRepository.findAll();
    }

    public String generateTempPassword() {
        String chars = "ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789!@#$%^&*";
        SecureRandom rnd = new SecureRandom();
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < 10; i++) {
            sb.append(chars.charAt(rnd.nextInt(chars.length())));
        }
        return sb.toString();
    }

    @Transactional
    public void deleteUserById(long id) {
        userRepository.deleteById(id);
    }

    @Transactional
    public void changePassword(long userId, String oldRawPassword, String newRawPassword) {
        User user = userRepository.findById(userId)
                .orElseThrow(() -> new IllegalArgumentException("Felhasználó nem található."));

        if (!passwordEncoder.matches(oldRawPassword, user.getPassword())) {
            throw new IllegalArgumentException("A régi jelszó nem helyes.");
        }

        if (newRawPassword == null || newRawPassword.length() < 8) {
            throw new IllegalArgumentException("Az új jelszó túl rövid (min. 8 karakter).");
        }

        String encoded = passwordEncoder.encode(newRawPassword);
        user.setPassword(encoded);
        userRepository.save(user);
    }

    @Transactional
    public boolean changeOwnPassword(long userId, String oldRawPassword, String newRawPassword) {
        User dbUser = userRepository.findById(userId)
                .orElseThrow(() -> new IllegalArgumentException("Felhasználó nem található id=" + userId));

        if (!passwordEncoder.matches(oldRawPassword, dbUser.getPassword())) {
            return false;
        }

        dbUser.setPassword(passwordEncoder.encode(newRawPassword));
        userRepository.save(dbUser);
        return true;
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/user/User.java
================================
package com.FourWings.atcSystem.model.user;

import com.FourWings.atcSystem.model.airport.Airports;
import jakarta.persistence.*;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@Entity
@Table(name = "user")
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private long id;

    private String name;

    @Column(unique = true, nullable = false)
    private String username;

    private String password;
    private String email;
    private String phone;

    /**
     * Szerepkör:
     *  - USER       = sima felhasználó
     *  - CONTROLLER = adott repülőtérhez rendelt irányító
     *  - ADMIN      = teljes jogú admin
     */
    @Enumerated(EnumType.STRING)
    @Column(nullable = false)
    private UserRole role;

    /**
     * Ha a user CONTROLLER, ide kötjük az "otthoni" repteret.
     * USER / ADMIN esetén lehet null.
     *
     * EAGER-re állítjuk, hogy JavaFX oldalon (comboBox, táblázat)
     * gond nélkül tudjuk használni, még akkor is, ha a Hibernate session már lezárult.
     */
    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "assigned_airport_id")
    private Airports assignedAirport;

    /**
     * Profilkép elérési útja (pl. "/images/avatars/avatar3.png"),
     * vagy null, ha nincs.
     */
    @Column(name = "profile_image_path")
    private String profileImagePath;

    // KÉNYELMI METÓDUSOK

    public boolean isAdmin() {
        return role == UserRole.ADMIN;
    }

    public boolean isController() {
        return role == UserRole.CONTROLLER;
    }

    public boolean isUserOnly() {
        return role == UserRole.USER;
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/user/UserRepository.java
================================
package com.FourWings.atcSystem.model.user;

import org.springframework.data.jpa.repository.JpaRepository;

import java.util.Optional;

public interface UserRepository extends JpaRepository<User,Long> {
    boolean existsByUsername(String username);
    Optional<User> findByUsername(String username);
    boolean existsByUsernameAndIdNot(String username, Long id);
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/airport/Airports.java
================================
package com.FourWings.atcSystem.model.airport;

import jakarta.persistence.*;
import lombok.*;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.UpdateTimestamp;

import java.math.BigDecimal;
import java.time.LocalDateTime;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@Entity
@Table(name = "airports")
public class Airports {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "airport_id")
    private Long Id;

    @Column(name = "icao_code", length = 4, nullable = false)
    private String icaoCode;

    @Column(name = "iata_code", length = 3)
    private String iataCode;

    @Column(name = "name")
    private String name;

    @Column(name = "city")
    private String city;

    @Column(name = "country")
    private String country;

    @Column(name = "timezone")
    private String timezone;

    @Column(name = "latitude", precision = 9, scale = 6)
    private BigDecimal latitude;

    @Column(name = "longitude", precision = 9, scale = 6)
    private BigDecimal longitude;

    @Column(name = "elevation")
    private Integer elevation;

    @Column(name = "address")
    private String address;

    @Column(name = "postal_code")
    private String postalCode;

    @Column(name = "website_url")
    private String websiteUrl;

    @Column(name = "phone_main")
    private String phoneMain;

    @Column(name = "email_main")
    private String emailMain;

    @Column(name = "note", columnDefinition = "TEXT")
    private String note;

    @CreationTimestamp
    @Column(name = "created_at", updatable = false)
    private LocalDateTime createdAt;

    @UpdateTimestamp
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    @Override
    public String toString() {
        return "Airports{" +
                "airportId=" + Id +
                ", icaoCode='" + icaoCode + '\'' +
                ", iataCode='" + iataCode + '\'' +
                ", name='" + name + '\'' +
                ", city='" + city + '\'' +
                ", country='" + country + '\'' +
                ", timezone='" + timezone + '\'' +
                ", latitude=" + latitude +
                ", longitude=" + longitude +
                ", elevation=" + elevation +
                ", address='" + address + '\'' +
                ", postalCode='" + postalCode + '\'' +
                ", websiteUrl='" + websiteUrl + '\'' +
                ", phoneMain='" + phoneMain + '\'' +
                ", emailMain='" + emailMain + '\'' +
                ", note='" + note + '\'' +
                ", createdAt=" + createdAt +
                ", updatedAt=" + updatedAt +
                '}';
    }

    @Transient
    public String getCode() {
        if (iataCode != null && !iataCode.isBlank()) {
            return iataCode;
        }
        if (icaoCode != null && !icaoCode.isBlank()) {
            return icaoCode;
        }
        return name != null ? name : "N/A";
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/airport/AirportsService.java
================================
package com.FourWings.atcSystem.model.airport;

import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
@RequiredArgsConstructor
public class AirportsService {

    private final AirportsRepository repo;

    public Airports getLastAdded() {
        return repo.findTopByOrderByIdDesc();
    }

    public List<Airports> getAllAirports() {
        return repo.findAll();
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/airport/AirportsRepository.java
================================
package com.FourWings.atcSystem.model.airport;

import org.springframework.data.jpa.repository.JpaRepository;

public interface AirportsRepository extends JpaRepository<Airports, Long> {
    Airports findTopByOrderByIdDesc();
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/gate/GateStatusConverter.java
================================
package com.FourWings.atcSystem.model.gate;


import jakarta.persistence.AttributeConverter;
import jakarta.persistence.Converter;

@Converter(autoApply = true)
public class GateStatusConverter implements AttributeConverter<GateStatus, String> {
    @Override public String convertToDatabaseColumn(GateStatus s) {
        return s == null ? null : s.name().toLowerCase();
    }
    @Override public GateStatus convertToEntityAttribute(String v) {
        return v == null ? null : GateStatus.valueOf(v.toUpperCase());
    }
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/gate/GateStatus.java
================================
package com.FourWings.atcSystem.model.gate;

public enum GateStatus {
    ACTIVE, MAINTENANCE, CLOSED
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/gate/GateRepository.java
================================
package com.FourWings.atcSystem.model.gate;

import com.FourWings.atcSystem.model.airport.Airports;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;

import java.util.List;
import java.util.Optional;

public interface GateRepository extends JpaRepository<Gate,Long> {
    Optional<Gate> findByCode(String code);
    Gate findTopByOrderByIdDesc();
    @Query("""
      select g from Gate g
      join fetch g.terminal t
      where g.id = :id
    """)
    Gate findByIdFetchTerminal(@Param("id") Long id);

    @Query("SELECT g FROM Gate g " +
            "JOIN g.terminal t " +
            "WHERE t.airport = :airport")
    List<Gate> findByAirport(@Param("airport") Airports airport);
}


=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/gate/Gate.java
================================
package com.FourWings.atcSystem.model.gate;

import com.FourWings.atcSystem.model.terminal.Terminal;
import jakarta.persistence.*;
import lombok.*;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.UpdateTimestamp;

import java.time.LocalDateTime;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@Entity
@Table(name = "gates")
public class Gate {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "gate_id")
    private Long id;

    @ToString.Exclude
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "terminal_id", referencedColumnName = "terminal_id")
    private Terminal terminal;

    @Column(name = "code", length = 20, nullable = false)
    private String code;

    @Convert(converter = GateStatusConverter.class)
    @Column(name = "status")
    private GateStatus status;

    @Column(name = "note", columnDefinition = "TEXT")
    private String note;

    @CreationTimestamp
    @Column(name = "created_at", updatable = false)
    private LocalDateTime createdAt;

    @UpdateTimestamp
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    @Override
    public String toString() {
        return "Gate{" +
                "id=" + id +
                ", terminal=" + terminal +
                ", code='" + code + '\'' +
                ", status=" + status +
                ", note='" + note + '\'' +
                ", createdAt=" + createdAt +
                ", updatedAt=" + updatedAt +
                '}';
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/gate/GateService.java
================================
package com.FourWings.atcSystem.model.gate;

import com.FourWings.atcSystem.model.airport.Airports;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Service
@RequiredArgsConstructor
public class GateService {
    private final GateRepository repo;

    @Transactional(readOnly = true)
    public Gate getGateWithTerminal(Long id) {
        return repo.findByIdFetchTerminal(id);
    }

    @Transactional(readOnly = true)
    public Gate getLastAdded() {
        Gate last = repo.findTopByOrderByIdDesc();
        if (last != null) {
            return repo.findByIdFetchTerminal(last.getId());
        }
        return null;
    }
    @Transactional(readOnly = true)
    public List<Gate> getGatesForAirport(Airports airport) {
        return repo.findByAirport(airport);
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/airline/AirlineService.java
================================
package com.FourWings.atcSystem.model.airline;

import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.Optional;

@Service
@RequiredArgsConstructor
public class AirlineService {
    private final AirlineRepository repo;

    @Transactional(readOnly = true)
    public Airline getLastAddedWithAirport() {
        return repo.findTopByOrderByIdDesc();
    }

    public Optional<Airline> findByIcao(String icao) { return repo.findByIcaoCode(icao); }

    public Optional<Airline> findByIata(String iata) { return repo.findByIataCode(iata); }
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/airline/BusinessModeConverter.java
================================
package com.FourWings.atcSystem.model.airline;


import jakarta.persistence.AttributeConverter;
import jakarta.persistence.Converter;

@Converter
public class BusinessModeConverter implements AttributeConverter<BusinessMode, String> {
    @Override
    public String convertToDatabaseColumn(BusinessMode attribute) {
        return attribute == null ? null : attribute.name().toLowerCase();
    }
    @Override
    public BusinessMode convertToEntityAttribute(String dbData) {
        return dbData == null ? null : BusinessMode.valueOf(dbData.toUpperCase());
    }
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/airline/Airline.java
================================
package com.FourWings.atcSystem.model.airline;

import com.FourWings.atcSystem.model.airport.Airports;
import jakarta.persistence.*;
import lombok.*;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.UpdateTimestamp;

import java.time.LocalDateTime;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@Entity
@Table(name = "airlines")

public class Airline {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "airline_id")
    private Long id;

    @Column(name = "name", length = 100, nullable = false)
    private String name;

    @Column(name = "icao_code", length = 3)
    private String icaoCode;

    @Column(name = "iata_code", length = 2)
    private String iataCode;

    @Column(name = "country", length = 100)
    private String country;

    @Column(name = "founded_year")
    private Short foundedYear;

    @Column(name = "is_active")
    private Boolean active;

    @Convert(converter = BusinessModeConverter.class)   // DB-ben kisbetűs enum értékek
    @Column(name = "business_mode")
    private BusinessMode businessMode;

    // Ha szeretnéd tényleges FK-ként kezelni:
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "base_airport_id", referencedColumnName = "airport_id")
    private Airports baseAirport;

    // Ha inkább csak az ID kéne, a fenti helyett:
    // @Column(name = "base_airport_id")
    // private Long baseAirportId;

    @Column(name = "website_url", length = 255)
    private String websiteUrl;

    @Column(name = "phone_main", length = 50)
    private String phoneMain;

    @Column(name = "email_main", length = 100)
    private String emailMain;

    @Column(name = "headquarters_address", length = 255)
    private String headquartersAddress;

    @Column(name = "note", columnDefinition = "TEXT")
    private String note;

    @CreationTimestamp
    @Column(name = "created_at", updatable = false)
    private LocalDateTime createdAt;

    @UpdateTimestamp
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    @Override
    public String toString() {
        return "Airline{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", icaoCode='" + icaoCode + '\'' +
                ", iataCode='" + iataCode + '\'' +
                ", country='" + country + '\'' +
                ", foundedYear=" + foundedYear +
                ", active=" + active +
                ", businessMode=" + businessMode +
                ", baseAirport=" + baseAirport +
                ", websiteUrl='" + websiteUrl + '\'' +
                ", phoneMain='" + phoneMain + '\'' +
                ", emailMain='" + emailMain + '\'' +
                ", headquartersAddress='" + headquartersAddress + '\'' +
                ", note='" + note + '\'' +
                ", createdAt=" + createdAt +
                ", updatedAt=" + updatedAt +
                '}';
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/airline/AirlineRepository.java
================================
package com.FourWings.atcSystem.model.airline;

import org.springframework.data.jpa.repository.EntityGraph;
import org.springframework.data.jpa.repository.JpaRepository;

import java.util.Optional;

public interface AirlineRepository extends JpaRepository<Airline, Long> {
    Optional<Airline> findByIcaoCode(String icaoCode);
    Optional<Airline> findByIataCode(String iataCode);
    @EntityGraph(attributePaths = "baseAirport")
    Airline findTopByOrderByIdDesc();
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/model/airline/BusinessMode.java
================================
package com.FourWings.atcSystem.model.airline;

public enum BusinessMode {
    LOW_COST, FULL_SERVICE, REGIONAL, CARGO, CHARTER, OTHER
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/service/dto/AirportWeatherInfo.java
================================
package com.FourWings.atcSystem.service.dto;

public record AirportWeatherInfo(
        String emoji,
        double temperatureC,
        String conditionText,
        String windText,
        String visibilityText,
        String pressureText,
        String feelsLikeText,
        String updatedAtText,
        String metarRaw
) {}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/service/AuthService.java
================================
package com.FourWings.atcSystem.service;

import com.FourWings.atcSystem.model.user.User;
import com.FourWings.atcSystem.model.user.UserRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;

@Service
@RequiredArgsConstructor
public class AuthService {

    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;

    public User loginAndGetUser(String username, String rawPassword) {
        var userOpt = userRepository.findByUsername(username);
        if (userOpt.isEmpty()) return null;

        User u = userOpt.get();
        if (passwordEncoder.matches(rawPassword, u.getPassword())) {
            return u;
        }
        return null;
    }
}

=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/service/weather/OpenWeatherService.java
================================
package com.FourWings.atcSystem.service.weather;

import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.service.WeatherService;
import com.FourWings.atcSystem.service.dto.AirportWeatherInfo;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.List;
import java.util.Map;

@Service
public class OpenWeatherService implements WeatherService {

    @Value("${openweather.api.key}")
    private String apiKey;

    @Value("${openweather.api.baseurl:https://api.openweathermap.org/data/2.5}")
    private String baseUrl;

    private final RestTemplate restTemplate = new RestTemplate();

    /**
     * Ezt használja a Controller UI – formázott, szép szöveges adatokkal.
     */
    @Override
    public AirportWeatherInfo getCurrentWeatherForAirport(Airports airport) {
        WeatherSnapshot snapshot = getSnapshotForAirport(airport);

        // Emoji
        String emoji = "🌤️";
        if (snapshot.thunderstorm()) emoji = "⛈️";
        else if (snapshot.heavyRainOrSnow()) emoji = "🌧️";
        else if (snapshot.cloudCoverage() > 80) emoji = "☁️";
        else if (snapshot.cloudCoverage() > 40) emoji = "⛅";

        String conditionText;
        if (snapshot.thunderstorm()) {
            conditionText = "Zivatar, intenzív csapadék lehetséges";
        } else if (snapshot.heavyRainOrSnow()) {
            conditionText = "Erős eső vagy havazás";
        } else if (snapshot.cloudCoverage() > 80) {
            conditionText = "Borult égbolt";
        } else if (snapshot.cloudCoverage() > 40) {
            conditionText = "Változóan felhős";
        } else {
            conditionText = "Többnyire derült";
        }

        // Szél km/h-ba nagyjából, irány fok + iránybetű
        String windDir;
        int deg = snapshot.windDeg();
        if (deg >= 337 || deg < 23) windDir = "É";
        else if (deg < 68) windDir = "ÉK";
        else if (deg < 113) windDir = "K";
        else if (deg < 158) windDir = "DK";
        else if (deg < 203) windDir = "D";
        else if (deg < 248) windDir = "DNY";
        else if (deg < 293) windDir = "NY";
        else windDir = "ÉNY";

        double windKmH = snapshot.windSpeed() * 3.6;
        double gustKmH = snapshot.windGust() * 3.6;
        String windText = String.format("%d° (%s), %.0f km/h (lökés: %.0f km/h)",
                snapshot.windDeg(), windDir, windKmH, gustKmH);

        String visibilityText = String.format("%.1f km", snapshot.visibilityKm());
        String pressureText = String.format("%.0f hPa", snapshot.pressure());
        String feelsLikeText = String.format("Hőmérséklet: %.1f °C, páratartalom: %.0f%%",
                snapshot.temperature(), snapshot.humidity());

        String updatedAt = LocalDateTime.now()
                .format(DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm"));

        // METAR egyelőre nincs – később bővíthető
        String metarRaw = "METAR adatok nincsenek integrálva.";

        return new AirportWeatherInfo(
                emoji,
                snapshot.temperature(),
                conditionText,
                windText,
                visibilityText,
                pressureText,
                feelsLikeText,
                updatedAt,
                metarRaw
        );
    }

    /**
     * Ezt használja a FlightWeatherAdvisorService – nyers adatok, számolgatáshoz.
     */
    public WeatherSnapshot getSnapshotForAirport(Airports airport) {
        String city = airport.getCity();
        if (city == null || city.isBlank()) {
            throw new IllegalArgumentException("A repülőtérhez nincs város megadva.");
        }

        String url = baseUrl + "/weather?q=" + city + "&appid=" + apiKey + "&units=metric";

        Map<String, Object> json = restTemplate.getForObject(url, Map.class);
        if (json == null) {
            throw new IllegalStateException("Nem sikerült időjárási adatot lekérni: " + city);
        }

        Map<String, Object> wind   = (Map<String, Object>) json.get("wind");
        Map<String, Object> main   = (Map<String, Object>) json.get("main");
        Map<String, Object> clouds = (Map<String, Object>) json.get("clouds");
        List<Map<String, Object>> weather = (List<Map<String, Object>>) json.get("weather");

        double windSpeed = wind != null && wind.get("speed") != null ? ((Number) wind.get("speed")).doubleValue() : 0;
        double windGust  = wind != null && wind.get("gust")  != null ? ((Number) wind.get("gust")).doubleValue()  : 0;
        int windDeg      = wind != null && wind.get("deg")   != null ? ((Number) wind.get("deg")).intValue()      : 0;

        int visibility = json.get("visibility") != null ? ((Number) json.get("visibility")).intValue() : 0;
        int cloudCoverage = clouds != null && clouds.get("all") != null ? ((Number) clouds.get("all")).intValue() : 0;

        boolean thunderstorm = false;
        boolean heavyRainOrSnow = false;
        if (weather != null) {
            thunderstorm = weather.stream()
                    .anyMatch(w -> String.valueOf(w.get("main")).equalsIgnoreCase("Thunderstorm"));
            heavyRainOrSnow = weather.stream()
                    .anyMatch(w -> {
                        String mainW = String.valueOf(w.get("main")).toLowerCase();
                        String desc  = String.valueOf(w.get("description")).toLowerCase();
                        return desc.contains("heavy") || mainW.contains("snow");
                    });
        }

        double temp     = main != null && main.get("temp")     != null ? ((Number) main.get("temp")).doubleValue()     : 0;
        double pressure = main != null && main.get("pressure") != null ? ((Number) main.get("pressure")).doubleValue() : 0;
        double humidity = main != null && main.get("humidity") != null ? ((Number) main.get("humidity")).doubleValue() : 0;

        return new WeatherSnapshot(
                windSpeed,
                windGust,
                windDeg,
                visibility / 1000.0,
                cloudCoverage,
                thunderstorm,
                heavyRainOrSnow,
                temp,
                pressure,
                humidity
        );
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/service/weather/FlightWeatherAdvice.java
================================
// src/main/java/com/FourWings/atcSystem/service/weather/FlightWeatherAdvice.java
package com.FourWings.atcSystem.service.weather;

public record FlightWeatherAdvice(
        String status,      // "GO", "CAUTION", "DELAY"
        String explanation  // szöveges magyarázat
) {}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/service/weather/WeatherService.java
================================
//// src/main/java/com/FourWings/atcSystem/service/weather/WeatherService.java
//package com.FourWings.atcSystem.service.weather;
//
//import com.FourWings.atcSystem.model.airport.Airports;
//import org.springframework.beans.factory.annotation.Value;
//import org.springframework.stereotype.Service;
//import org.springframework.web.client.RestTemplate;
//
//import java.util.List;
//import java.util.Map;
//
//@Service
//public class WeatherService {
//
//    @Value("${openweather.api.key}")
//    private String apiKey;
//
//    @Value("${openweather.api.baseurl:https://api.openweathermap.org/data/2.5}")
//    private String baseUrl;
//
//    private final RestTemplate restTemplate = new RestTemplate();
//
//    public WeatherSnapshot getCurrentWeatherForAirport(Airports airport) {
//        // Várost az adatbázisból vesszük (pl. "Budapest")
//        String city = airport.getCity(); // ha más a getter neve, írd át
//
//        String url = baseUrl + "/weather?q=" + city + "&appid=" + apiKey + "&units=metric";
//
//        Map<String, Object> json = restTemplate.getForObject(url, Map.class);
//        if (json == null) {
//            throw new IllegalStateException("Nem sikerült időjárási adatot lekérni: " + city);
//        }
//
//        Map<String, Object> wind   = (Map<String, Object>) json.get("wind");
//        Map<String, Object> main   = (Map<String, Object>) json.get("main");
//        Map<String, Object> clouds = (Map<String, Object>) json.get("clouds");
//        List<Map<String, Object>> weather = (List<Map<String, Object>>) json.get("weather");
//
//        double windSpeed = wind != null && wind.get("speed") != null ? ((Number) wind.get("speed")).doubleValue() : 0;
//        double windGust  = wind != null && wind.get("gust")  != null ? ((Number) wind.get("gust")).doubleValue()  : 0;
//        int windDeg      = wind != null && wind.get("deg")   != null ? ((Number) wind.get("deg")).intValue()      : 0;
//
//        int visibility = json.get("visibility") != null ? ((Number) json.get("visibility")).intValue() : 0;
//        int cloudCoverage = clouds != null && clouds.get("all") != null ? ((Number) clouds.get("all")).intValue() : 0;
//
//        boolean thunderstorm = false;
//        boolean heavyRainOrSnow = false;
//        if (weather != null) {
//            thunderstorm = weather.stream()
//                    .anyMatch(w -> String.valueOf(w.get("main")).equalsIgnoreCase("Thunderstorm"));
//            heavyRainOrSnow = weather.stream()
//                    .anyMatch(w -> {
//                        String mainW = String.valueOf(w.get("main")).toLowerCase();
//                        String desc  = String.valueOf(w.get("description")).toLowerCase();
//                        return desc.contains("heavy") || mainW.contains("snow");
//                    });
//        }
//
//        double temp     = main != null && main.get("temp")     != null ? ((Number) main.get("temp")).doubleValue()     : 0;
//        double pressure = main != null && main.get("pressure") != null ? ((Number) main.get("pressure")).doubleValue() : 0;
//        double humidity = main != null && main.get("humidity") != null ? ((Number) main.get("humidity")).doubleValue() : 0;
//
//        return new WeatherSnapshot(
//                windSpeed,
//                windGust,
//                windDeg,
//                visibility / 1000.0,
//                cloudCoverage,
//                thunderstorm,
//                heavyRainOrSnow,
//                temp,
//                pressure,
//                humidity
//        );
//    }
//}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/service/weather/FlightWeatherAdvisorService.java
================================
package com.FourWings.atcSystem.service.weather;

import com.FourWings.atcSystem.model.airport.Airports;
import org.springframework.stereotype.Service;

@Service
public class FlightWeatherAdvisorService {

    private final OpenWeatherService weatherService;

    public FlightWeatherAdvisorService(OpenWeatherService weatherService) {
        this.weatherService = weatherService;
    }

    public FlightWeatherAdvice analyzeForAirport(Airports airport) {
        WeatherSnapshot w = weatherService.getSnapshotForAirport(airport);

        String status;
        String explanation;

        if (w.thunderstorm() || w.heavyRainOrSnow() || w.visibilityKm() < 1.0) {
            status = "DELAY";
            explanation = "Erős csapadék vagy zivatar, illetve nagyon rossz látási viszonyok várhatók. " +
                    "A felszállás halasztása erősen javasolt.";
        } else if (w.windSpeed() > 12.0 || w.windGust() > 18.0 || w.cloudCoverage() > 80) {
            status = "CAUTION";
            explanation = "Élénk vagy erős szél, illetve jelentős felhőzet várható. " +
                    "A felszállás lehetséges, de fokozott körültekintés és részletesebb döntéstámogatás szükséges.";
        } else {
            status = "GO";
            explanation = "Az időjárási feltételek általánosságban kedvezőek, " +
                    "nincs extrém szél vagy jelentős csapadék a következő órákban.";
        }

        explanation += String.format(
                "%nSzél: %.1f m/s (lökés: %.1f m/s), látótáv: %.1f km, felhőzet: %d%%, hőmérséklet: %.1f °C.",
                w.windSpeed(), w.windGust(), w.visibilityKm(), w.cloudCoverage(), w.temperature()
        );

        return new FlightWeatherAdvice(status, explanation);
    }
}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/service/weather/WeatherSnapshot.java
================================
package com.FourWings.atcSystem.service.weather;

public record WeatherSnapshot(
        double windSpeed,
        double windGust,
        int windDeg,
        double visibilityKm,
        int cloudCoverage,
        boolean thunderstorm,
        boolean heavyRainOrSnow,
        double temperature,
        double pressure,
        double humidity
) {}
=========== FILE END ===========

========== FILE START ==========
PATH: /Users/tothleventelaszlo/Desktop/SFM projekt/AronCommitjeiUtan/src/main/java/com/FourWings/atcSystem/service/WeatherService.java
================================
package com.FourWings.atcSystem.service;

import com.FourWings.atcSystem.model.airport.Airports;
import com.FourWings.atcSystem.service.dto.AirportWeatherInfo;

public interface WeatherService {
    AirportWeatherInfo getCurrentWeatherForAirport(Airports airport);
}
=========== FILE END ===========

